{"componentChunkName":"component---src-templates-blog-template-js","path":"/tech-talk-2022/2022-01-24-what-is-HMR/","result":{"data":{"cur":{"id":"cb8020a6-fec7-5ebc-8a3d-81b7ce019227","html":"<h2 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h2>\n<p>보통 javascript 프로젝트 개발시에, 일반적으로 next.js와 같은 통합 개발 환경을 사용하거나, 직접 개발 환경을 구축 하더라도, webpack-dev-server의 hot 옵션정도를 사용하여서 개발을 하게 된다.</p>\n<p>따라서 이렇게 개발하는 경우 기본적으로 개발 환경이 HMR을 지원하고 있어서, 별도의 HMR에 대한 요구 사항을 느끼거나 하지는 않게 된다.</p>\n<p>하지만 HMR의 동작 원리나 internal구조를 알고 싶거나, 특이한 형태의 HMR을 구축해야 하는경우, 혹은 직접 개발환경을 구축해서 만드는 경우, HMR에 대하여 좀더 명확하게 알고 사용 하는것이 좋다. 이러한 경우를 위해서 본 문서를 작성하였다. 목표는 다음과 같다.</p>\n<ul>\n<li>Hot Module Replacement라고 불리는 HMR의 기본적인 개념을 이해한다.</li>\n<li>Webpack의 Incremental 빌드를 이해한다.</li>\n<li>전체적인 HMR의 동작 구조를 이해한다.</li>\n</ul>\n<h2 id=\"hot-reloading\" style=\"position:relative;\"><a href=\"#hot-reloading\" aria-label=\"hot reloading permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hot-Reloading</h2>\n<p>일단. HMR을 들어가기 앞서서, 이 개념이 어디서부터 나왔는지 살펴본다. 과거 javascript의 개발 및 javascript의 환경이 지금과 같지 않았던 시절에는 당연히 HMR이라는 개념은 존재하지 않았다. 다만 이러한 시기에도 Hot Reloading 혹은 Live Reloading이라는 개념이 존재하였다. Hot-Reloading, Live Reloading의 아이디어는 다음과 같은 개발 과정속에서 발현되게 되었다.</p>\n<p>일반적으로(현재도 마찬가지이다), javascript의 개발흐름은 다음과 같다.</p>\n<ol>\n<li>javascript 코드를 작성한다.</li>\n<li>javascript 코드가 구동되는 html 환경을 구축하고, 해당 javascript을 <code class=\"language-text\">&lt;script></code>태그로 불러온다.</li>\n<li>javascript runtime 환경에서 해당 코드를 구동한다. (보통 browser, 혹은 node - node일때는 2번 없어도됨)</li>\n</ol>\n<p>위 과정에서 javascript코드를 수정하게되면</p>\n<ol>\n<li>수정된 코드를 다시 구동해야한다.! 즉 browser라면 F5(reload),  node라면 node 재시작</li>\n</ol>\n<p>위와 같은 개발 과정에서</p>\n<ul>\n<li>코드 수정 → reload(browser F5 or node restart) 과정! 을 자동으로 해주자!!</li>\n</ul>\n<p>가 기본적인 Hot-Reloading(Live-Reloading)의 기본 아이디어 이다.</p>\n<h2 id=\"how-to-hot-reloading\" style=\"position:relative;\"><a href=\"#how-to-hot-reloading\" aria-label=\"how to hot reloading permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to Hot-Reloading</h2>\n<p>기본 아이디어를 실제 구현한다고 가정하자. 어떻게 해야 할까? 기본적으로 아래와 같이 구성해 볼 수 있다.</p>\n<ul>\n<li>누군가 <strong>“코드 수정” 을 감지</strong>한다.</li>\n<li>“코드 수정” 이감지되면 수정되었음을 <strong>runtime(browser or node)에 알린다(notify!!)</strong>.</li>\n<li>runtime은  <strong>notify!! 가 오면</strong> 자신을 <strong>재기동(window.location.reload)</strong> 한다.</li>\n</ul>\n<p>실제 구현을 한다면 어떻게 될까?</p>\n<ul>\n<li><strong>“코드 수정” 감지</strong>\n<ul>\n<li>특정 폴더를 주고, 특정 폴더의 변경을 주기적으로 polling해서 파일 변화를 알 수 있다.</li>\n<li>“코드 수정” 감지용 프로그램은, 한번 실행되고 종료되는게 아니라. 계속 떠서 감지해야 한다.</li>\n<li>보통은 bundler 에서 이러한 코드 수정 감지가 가능하다.</li>\n</ul>\n</li>\n<li><strong>Runtime에 알리기</strong>\n<ul>\n<li>여러가지 방법이 있을 수 있다.\n<ul>\n<li>기본적으로 “코드 수정 감지” 프로그램이 → “Runtime” 에 수정되었음을 알리면 된다.</li>\n<li>거꾸로 “코드 수정 감지” 프로그램이 API를 제공(서버)하고 ← “Runtime” 에서 polling 형태로 해당 API를 호출 할 수도 있다.</li>\n</ul>\n</li>\n<li>Runtime은 사실 “코드 수정 감지” 프로그램이 무었인지 모른다. 그럼 어떻게 해서 “코드 수정 감지” 프로그램과 ← → Runtime이 통신 하는걸까?\n<ul>\n<li>Runtime은 사실 javascript을 구동한다.</li>\n<li>즉 “현재 수정되는 코드” 가 최초 한번 Runtime에서 구동될때, “코드 수정” 와 통신 할 수 있는 코드(프로그램)이 이미 들어있는 상태로 구동되게 할 수 있다.</li>\n</ul>\n</li>\n<li>위에서는 기본적인 개념을 설명하였는데 javascript에는, websocket이라는 기능이 존재한다. 이를 사용하면 좀더 편리하게, <strong>“코드 수정 감지” 프로그램과 ↔ ”Runtime(상에서 구동된 나의 javascript프로그램)” 간의 통신이 가능</strong>하다.</li>\n</ul>\n</li>\n<li><strong>재기동 하기</strong>\n<ul>\n<li>최종적으로 “변경” 이 감지되면, runtime을 재기동 한다. (window.location.reload)</li>\n</ul>\n</li>\n</ul>\n<p>정리하면 다음과 같다.</p>\n<ul>\n<li>“코드(파일) 수정 감지” → Runtime에 알림 → Runtime(나의 javascript code program) 알림 받음 → 재시작</li>\n</ul>\n<p>해당 형태를 사용하면 개발자가 코드 수정을 하고, 브라우저에서 직접 손으로 페이지 reload(F5)로 코드 갱신을 하지 않아도, 자동으로 코드가 갱신(자동 F5)가 잘 구동된다. 하지만 이 방법에도 몇가지 단점이 있다.</p>\n<ul>\n<li>단점\n<ul>\n<li>매번 F5가 발생함으로, javascript코드상 최초 code부터 매번 다시 실행된다.</li>\n<li>이는 즉 번쩍 거리는 현상이나, full page load가 항상 다시 발생한다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"hmr-기본적인-아이디어\" style=\"position:relative;\"><a href=\"#hmr-%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9D%B8-%EC%95%84%EC%9D%B4%EB%94%94%EC%96%B4\" aria-label=\"hmr 기본적인 아이디어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HMR 기본적인 아이디어</h2>\n<p>javascript 언어가 점차 확장 및 발전함에 따라서, javascript에도 module이라는 개념이 들어오게 되었다. 이러한 발전에 발맞추어, Hot-Reload(Live-Reload)기능 역시 발전을 하게 되었다.</p>\n<p>새롭게 발전된 Reload의 개념이 HRM(Hot Module Replacement)이다.</p>\n<p>Hot-Reload(Live-Reload)와 차이점이 되는 아이디어는 다음과 같다.</p>\n<ul>\n<li>F5형태로 browser을 Full Reload 하지 않았으면 좋겠다.</li>\n<li>module이라는 개념이 있으니, 수정된 파일(module)만 교체(replace)되면 좋겠다.</li>\n<li>수정된 파일(module)이 교체(replace)되고 나서, 즉각적으로 반영되면 좋겠다.</li>\n</ul>\n<p>현재의 HMR은 위의 아이디어 내용을 실제 구현하여 제공하고 있다. 실제 본인이 직접 구현한다면? 어떻게 해야할지, 생각해보자.</p>\n<p>실제 구현을 한다면 어떻게 될까?</p>\n<ul>\n<li><strong>“코드 수정” 감지</strong>\n<ul>\n<li>단순 파일 변경 감지 이외, 모듈 변경 형태로 감지해야한다.</li>\n<li>특정 모듈을 사용한 dep을 감지해야 한다. (단순 파일 변경이외, 해당 파일(module)을 사용하는 dep파일도 다 알아야 한다.)</li>\n<li>다시 말하면, 이제 단순 single js형태 혹은 그냥 file로 감지하는게 아니라. project의 전체적인 hierarchy 구조(module)을 알고 있어야 한고, 이를 어딘가에서 계속 (meta)가지고 있어야 한다.</li>\n</ul>\n</li>\n<li>“<strong>Runtime”에 알리기</strong>\n<ul>\n<li>기본적인 아이디어는 동일한다. 즉 runtime에서 구동되는 js내부에, “코드수정 감지” 프로그래쪽과 통신하는 프로그램이 필요하다. (즉 나의 js(내 프로그램 source)에 inject 되어있는 통신 프로그램이 있어야함)</li>\n</ul>\n</li>\n<li><strong>“재기동”</strong> 하기\n<ul>\n<li>재기동 부분은 좀더 복잡해진다.</li>\n<li>기존에 단순 page reload였다면, 이제 페이지가 유지되어야한다.</li>\n<li>현재구동중인 js의 전체적인 module 구조를 알고 있어야 한다.</li>\n<li>“코드수정”감지 가 알려준 정보(변경된 module, 변경된 module에 따라서 dep가 생긴 모듈)을 알아야 한다.</li>\n<li>“코드수정”감지 가 알려준 정보 부분만 replace 해야 한다.</li>\n<li>즉 나의 js(내 프로그램 source)에 통신 프로그램 뿐만 아니라, “module”구조(hierarchy)를 알고, 특정 부분만 교체 (replace) 하는, 프로그램도 하나 더 있어야 한다.</li>\n<li>마지막으로, module을 교체 한 이후, 실행(running)하여서, 실제 변경이 즉각적으로(real-time) runtime(browser) 에 반영되게 해야 한다.</li>\n</ul>\n</li>\n</ul>\n<p>정리하면 다음과 같다.</p>\n<ul>\n<li>“코드(파일) 수정 감지” → Runtime에 자세한 정보(module, dep 등등)알림 → Runtime(나의 javascript code program) 알림 받음 → Runtime(module 교체 프로그램에 정보 전달) → Runtime(module 교체 프로그램이 module 교체) → Runtime(module 교체후 최종 실행 프로그램이 변경된 module로 실행)</li>\n</ul>\n<p>정말 다행이도, 현재의 HMR 이 위와 같은 내용을 실제 구현하여서 제공하고있다. 현재 실제 구현되어서 제공되고 있는 HMR의 프로그램 와 기능을 보면서 좀더 HMR을 이해하여 보자</p>\n<h2 id=\"hmr-실제-구현체로-좀더-이해하기\" style=\"position:relative;\"><a href=\"#hmr-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84%EC%B2%B4%EB%A1%9C-%EC%A2%80%EB%8D%94-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\" aria-label=\"hmr 실제 구현체로 좀더 이해하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HMR 실제 구현체로 좀더 이해하기</h2>\n<h3 id=\"webpack-incremental-build-and-watch\" style=\"position:relative;\"><a href=\"#webpack-incremental-build-and-watch\" aria-label=\"webpack incremental build and watch permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Webpack Incremental Build and watch</h3>\n<p>webpack은 모두 알다 싶이 bundler 프로그램이다. 기본적으로 webpack을 수행하면, 즉시 실행되고 종료되는 프로그램이다. 이 프로그램은 config 설정을 기반으로, entry point로 부터 module hierarchy 구조를 분석(parsing)하고 각 파일(module)에 맞는 compile을 수행한다. 이후 모든 compile이 종료되는 최종 out(bundle.js)을 생성한다.</p>\n<p>webpack은 <strong>incremental build도 지원</strong>한다. 매번 full build을 하는경우, build → parsing → compile → bundle 생성까지 오랜 시간이 걸리기 때문에, <strong>“변경된 파일(module)”</strong> 만 감지해서, 해당 부분만 build하고 반영하는 기능이다.</p>\n<p>해당 기능을 사용하는것은 매우 간단한다. 아래와 같이 webpack.config 파일에 watch 옵션을 켜거나</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//...</span>\n  watch<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>아래와 같이 webpack 구동시에 watch 옵션을 추가하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">$ webpack watch <span class=\"token operator\">--</span>config webpack<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>js</code></pre></div>\n<p>HMR 관점에서 다음 기능이 됨을 알 수 있다.</p>\n<ul>\n<li>특정 코드 수정(module)감지가 됨 (incremental build)</li>\n<li>module 형태의 hierarchy 을 관리 하고 있음.</li>\n<li>특정 코드 수정(module)감지시 특정 코드만 빌드(bundle)해서, 특정 영역(module)만 새로운 코드로 빌드 결과물을 만들어 낼 수 있음.</li>\n<li>webpack 자체가 daemon처럼 계속 떠서 watch(파일 변경)을 polling 할 수 있음.</li>\n</ul>\n<p>생각해보면 <strong>“코드 수정” 감지</strong> 의 기능을 충분히 하고 있음을 알 수 있다.</p>\n<ul>\n<li>아직 안되고 있는거 → “변경 사항 알리기”</li>\n<li>runtime 쪽에 “코드수정” 감지 프로그램과 통신할 수 있는 코드 넣기</li>\n<li>runtime 쪽에 “코드수정” 감지 알림을 받아서 “재기동” 하는 코드 넣기</li>\n</ul>\n<h2 id=\"webpack-dev-server\" style=\"position:relative;\"><a href=\"#webpack-dev-server\" aria-label=\"webpack dev server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>webpack-dev-server</h2>\n<p>webpack-dev-server는, 간략하게 webpack 기능 + dev(express.js(node.js)) server 가 있는 기능으로 생각하면 된다. 원래 webpack의 side 형태의 project였는데 현재는 webpack의 공식 기능으로 편입되었다.</p>\n<p>정리하면 내부적으로 2가지 기능을 한다.</p>\n<ul>\n<li>webpack</li>\n<li>server</li>\n</ul>\n<p>서버 기능이 있기 때문에 server관련 설정이 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// webpack.config.js</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//...</span>\n  devServer<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      directory<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    compress<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    port<span class=\"token operator\">:</span> <span class=\"token number\">9000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>구동시에는 다음과 같이 webpack 대신에 webpack-dev-server 명령어를 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">$ webpack<span class=\"token operator\">-</span>dev<span class=\"token operator\">-</span>server <span class=\"token operator\">--</span>config webpack<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>js</code></pre></div>\n<ul>\n<li>webpack-dev-server 명령어를 사용하면 <strong>webpack-dev-server가 내부에서 webpack을 구동</strong>한다.</li>\n<li>추가로, dev-server (express.js)을 구동한다.</li>\n</ul>\n<p><strong><a href=\"https://github.com/webpack/webpack-dev-server\">webpack-dev-server</a>가 내부에서 webpack을 어떻게 구동할까?</strong></p>\n<p><a href=\"https://github.com/webpack/webpack\">webpack</a>도 javascript로 되어 있기 때문에, 아래와 같이 javascript 코드 형태로 구동 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> webpack <span class=\"token keyword\">from</span> <span class=\"token string\">'webpack'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">'./webpack.config.js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> compiler <span class=\"token operator\">=</span> <span class=\"token function\">webpack</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// webpackCompilerCb 부분은 callback fn 부분이다, 개발자가 개발하여 넘겨주면 된다.</span>\n<span class=\"token comment\">// build 실행</span>\ncompiler<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token function\">webpackCompilerCb</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">,</span> progress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// build 실행 watch mode로!!</span>\ncompiler<span class=\"token punctuation\">.</span><span class=\"token function\">watch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> aggregateTimeout<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> poll<span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token function\">webpackCompilerCb</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">,</span> progress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>즉 사실은 webpack-dev-server와 무관하게, 개발자는 언제든 자신의 javascript코드에서 webpack을 구동 할 수 있다.</p>\n<p>참고: <a href=\"https://webpack.js.org/api/node/\">https://webpack.js.org/api/node/</a></p>\n<p>webpack-dev-server는 webpack 기능 + server기능을 한다고 하였다. server는 express.js(node)로 되어 있는데, express.js(node)는 middleware기능을 제공하고 있다.</p>\n<p>webpack-dev-server는 webpack build의 기능을, 이러한 middleware를 사용하고 있다. 정확하게는,  <a href=\"https://github.com/webpack/webpack-dev-middleware\">webpack-dev-middleware</a> 라는 middleware을 사용하여서, webpack build기능을 제공하고 있다.</p>\n<p>다시 말하면, 개발자는 node.js 계열의 server을 구축시, <a href=\"https://github.com/webpack/webpack-dev-middleware\">webpack-dev-middleware</a> 를 사용하여서, webpack build 기능을, 아주 손쉽게 직접 제공 할 수 있다.</p>\n<p>참고: <a href=\"https://github.com/webpack/webpack-dev-server/blob/master/lib/Server.js#L1937\">https://github.com/webpack/webpack-dev-server/blob/master/lib/Server.js#L1937</a></p>\n<p>HMR을 보다가 잠깐 webpack-dev-server을 알아보았다. 갑자기 webpack-dev-server가 나왔는데, webpack 의 기능 + “Server” 의 기능도 됨을 알아 두고 이어서 설명하겠다.</p>\n<h2 id=\"webpack-dev-server-hot\" style=\"position:relative;\"><a href=\"#webpack-dev-server-hot\" aria-label=\"webpack dev server hot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>webpack-dev-server HOT</h2>\n<p>webpack 공식 문서의 <a href=\"https://webpack.js.org/configuration/dev-server/#devserverhot\">https://webpack.js.org/configuration/dev-server/#devserverhot</a> 을 살펴보면 webpack-dev-server에 hot 기능을 켜면 아주 간략하게, HMR 설정이 완료 됨을 알 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// webpack.config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//...</span>\n  devServer<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    hot<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>위쪽에서 webapck watch형태일때 HMR 관점에서 부족</p>\n<p>HMR 관점에서 다음을 생각해 볼 수 있다.</p>\n<ul>\n<li><strong>A. webpack-dev-server가 hot 형태로 구동시, 내부 구동하는 webpack은 “watch” 모드이다.</strong>\n<ul>\n<li>\n<p>code</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// webpack-dev-server/lib/Server.js</span>\n<span class=\"token function\">setupDevMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> webpackDevMiddleware <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"webpack-dev-middleware\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// middleware for serving webpack bundle</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>middleware <span class=\"token operator\">=</span> <span class=\"token function\">webpackDevMiddleware</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>compiler<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>devMiddleware\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><a href=\"https://github.com/webpack/webpack-dev-middleware/blob/master/src/index.js#L230\">https://github.com/webpack/webpack-dev-middleware/blob/master/src/index.js#L230</a></p>\n<ul>\n<li>정확하게는,  <strong>webpack-dev-middleware</strong>의 내부에서 compiler.watch사용을 한다.</li>\n<li>또한 webpack-dev-middleware사용시 option형태로 watch을 줄 수 있다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>B. webpack-dev-server가 hot 형태로 구동시, 내부 구동하는 webpack 빌드 과정에서, runtime에서 구동될 최종 <code class=\"language-text\">bundle.js</code> 코드에 “통신 &#x26; 재기동” 용 코드를 넣는다.\n<ul>\n<li>\n<p>code</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">async</span> <span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>webSocketServer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> compilers <span class=\"token operator\">=</span>\n        <span class=\"token comment\">/** @type {MultiCompiler} */</span>\n        <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>compiler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compilers <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>compiler<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n      compilers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>compiler<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">addAdditionalEntries</span><span class=\"token punctuation\">(</span>compiler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">const</span> webpack <span class=\"token operator\">=</span> compiler<span class=\"token punctuation\">.</span>webpack <span class=\"token operator\">||</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"webpack\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t\t<span class=\"token comment\">// !!!! Client.js 가 최종 빌드 결과에 같이 들어가게 된다.</span>\n        <span class=\"token comment\">// 통신 및 재기동을 담당</span>\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack</span><span class=\"token punctuation\">.</span><span class=\"token function\">ProvidePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          __webpack_dev_server_client__<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClientTransport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>compiler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// TODO remove after drop webpack v4 support</span>\n        compiler<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>plugins <span class=\"token operator\">=</span> compiler<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>plugins <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>hot<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token comment\">// 재기동</span>\n          <span class=\"token keyword\">const</span> HMRPluginExists <span class=\"token operator\">=</span> compiler<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> p<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">===</span> webpack<span class=\"token punctuation\">.</span>HotModuleReplacementPlugin\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>HMRPluginExists<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>logger<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span>\n              <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\"hot: true\" automatically applies HMR plugin, you don't have to add it manually to your webpack configuration.</span><span class=\"token template-punctuation string\">`</span></span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// Apply the HMR plugin</span>\n            <span class=\"token keyword\">const</span> plugin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack</span><span class=\"token punctuation\">.</span><span class=\"token function\">HotModuleReplacementPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">plugin</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>compiler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>client <span class=\"token operator\">&amp;&amp;</span>\n        <span class=\"token comment\">/** @type {ClientConfiguration} */</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>progress\n      <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setupProgressPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><strong>webpack.ProvidePlugin - <strong>webpack_dev_server_client</strong>: this.getClientTransport()</strong></p>\n<ul>\n<li>webpack.ProvidePlugin으로 Client쪽의 websocket쪽 코드를 추가한다.</li>\n<li>실제 client.js가 최종 bundle.js 내부에 같이 포함되어 들어간다.</li>\n<li>참고: <a href=\"https://github.com/webpack/webpack-dev-server/tree/master/client-src\">https://github.com/webpack/webpack-dev-server/tree/master/client-src</a>\n<ul>\n<li>위 소스가 빌드되서 같이 포함되어 들어간다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>HotModuleReplacementPlugin()</strong> 을 넣어준다. (사용자의 webpack.config.js에 없어도 넣어줌)</p>\n<ul>\n<li>해당 Plugin은 webpack의 plugin이고, webpack 빌드 과정중 HMR용 코드를 최종 빌드 결과물에 넣어주는 역할을 한다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>C. webpack-dev-server가 hot 형태로 구동시, 내부 구동하는 webpack 빌드의 watch모드에서 빌드 결과을 감지하고 → 빌드가 완료되면, “통신” (수정 알림) 을 한다.\n<ul>\n<li>\n<p>code</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// webpack-dev-server/lib/Server.js</span>\n<span class=\"token function\">setupHooks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>compiler<span class=\"token punctuation\">.</span>hooks<span class=\"token punctuation\">.</span>invalid<span class=\"token punctuation\">.</span><span class=\"token function\">tap</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"webpack-dev-server\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>webSocketServer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendMessage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>webSocketServer<span class=\"token punctuation\">.</span>clients<span class=\"token punctuation\">,</span> <span class=\"token string\">\"invalid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>compiler<span class=\"token punctuation\">.</span>hooks<span class=\"token punctuation\">.</span>done<span class=\"token punctuation\">.</span><span class=\"token function\">tap</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"webpack-dev-server\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">/**\n       * @param {Stats | MultiStats} stats\n       */</span>\n      <span class=\"token punctuation\">(</span>stats<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>webSocketServer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// !!!!!!!!!!! websocket으로 통신!!!!</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sendStats</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>webSocketServer<span class=\"token punctuation\">.</span>clients<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getStats</span><span class=\"token punctuation\">(</span>stats<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">/**\n         * @private\n         * @type {Stats | MultiStats}\n         */</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stats <span class=\"token operator\">=</span> stats<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>위 B 과정에서 들어간 client코드가 결국 runtime(bundle.js)에서 구동되고 있을것이다.</p>\n</li>\n<li>\n<p>따라서 본 C. 과정에서 socket을 사용하여 sendMessage을 하면 B과정에서 들어간 코드로 통신하게 된다.</p>\n</li>\n</ul>\n</li>\n<li>D. client(runtime) 쪽에서는, “통신” (수정 알림) 을 받으면, 브라우저를 재기동 하거나, moule replacement을 수행한다.\n<ul>\n<li>참고: <a href=\"https://github.com/webpack/webpack-dev-server/blob/master/client-src/utils/reloadApp.js#L41\">https://github.com/webpack/webpack-dev-server/blob/master/client-src/utils/reloadApp.js#L41</a></li>\n</ul>\n</li>\n</ul>\n<p>실제 구현 소스를 확인하면서, 예상한 기능요소(HMR)을 확인해본 결과 거의 예측한 형태로 구현되어 있음을 알 수 있다. 재미있는점은 webpack-dev-server는 hot-replacement 형태와 hot-reload(live-reload)형태를 모두 지원하고 있다. (<a href=\"https://github.com/webpack/webpack-dev-server/blob/master/client-src/utils/reloadApp.js#L41\">https://github.com/webpack/webpack-dev-server/blob/master/client-src/utils/reloadApp.js#L41</a>)</p>\n<p>live-reload 형태로 구동시에는 예전과 같이 browser을 재기동한다. 그외 replacement형태로 구동시에는 <code class=\"language-text\">hotEmitter.emit(\"webpackHotUpdate\", status.currentHash);</code>와 같이 hotEmitter로 emit을 하는데 이때 hotEmitter는 <code class=\"language-text\">import hotEmitter from \"webpack/hot/emitter.js\";</code> 형태로 되어있다. 즉 webpack의 코드가 다시 구동되는 형태이다.</p>\n<p>webpack코드에서는</p>\n<ul>\n<li>webpack/hot/dev-server.js</li>\n<li>webpack/hot/log-apply-result.js</li>\n</ul>\n<p>위와 같은 코드를 구동하여 <strong>**webpack_hash</strong>**  을 업데이트 한다. 만약 실패시에는 다시 live-reload을 적용한다.</p>\n<h2 id=\"webpack-dev-server-사용하지-않고-hmr-해보기\" style=\"position:relative;\"><a href=\"#webpack-dev-server-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EA%B3%A0-hmr-%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"webpack dev server 사용하지 않고 hmr 해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Webpack Dev Server 사용하지 않고 HMR 해보기</h2>\n<p>webpack-dev-server는 항상 server(express)을 띄움으로, 내가 node 서버 개발을 할때 서버를 2개씩 띄우기 싫거나, live-reload보다는 replacement위주로 더 동작하게 하거나, 혹은 내가 개발하는 node서버를 재기동 하지 않고도 hot-replacement가 되게 하거나 하는 요구사항이 있을 수 있다.</p>\n<p>이와 같은 경우, 기본적인 webpack-dev-server형태로는 한계가 있기 때문에, 위에서 설명한 webpack-dev-server의 개념(hmr사용)을 응용하여 나만의 hmr 서버를 구축 해야 한다.</p>\n<p>내 서버가 기본적으로 아래 역할을 하면 된다.</p>\n<ul>\n<li>내 서버에서 webpack 구동(watch)</li>\n<li>내 서버에서 webpack 변경 감지(compiler.hooks.done)</li>\n<li>클라이언트 코드에 “통신 / 재기동” 코드 넣어주기</li>\n<li>클라이언트 코드에서 “통신 / 재기동” 코드가 구동되어서 동작되게 하기</li>\n</ul>\n<p>사실 이미 위의 각각의 부분이 이미 express(node) 서버용 middleware 구현 및 webpack config시점에 code inject 형태로 구현되어 있다. 간략하게 해당 방법을 설명한다.</p>\n<h3 id=\"내-서버에서-webpack-구동-내-서버에서-webpack-변경-감지compilerhooksdone\" style=\"position:relative;\"><a href=\"#%EB%82%B4-%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-webpack-%EA%B5%AC%EB%8F%99-%EB%82%B4-%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-webpack-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80compilerhooksdone\" aria-label=\"내 서버에서 webpack 구동 내 서버에서 webpack 변경 감지compilerhooksdone permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>내 서버에서 webpack 구동, 내 서버에서 webpack 변경 감지(compiler.hooks.done)</h3>\n<p>서버 코드내에 아래와 같은 코드가 있으면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> conf <span class=\"token keyword\">from</span> <span class=\"token string\">'./webpack.client.conf.js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> webpack <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> webpackConfig <span class=\"token operator\">=</span> <span class=\"token function\">getClientConfig</span><span class=\"token punctuation\">(</span>conf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> compiler <span class=\"token operator\">=</span> <span class=\"token function\">webpack</span><span class=\"token punctuation\">(</span>webpackConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 필자는 koa2 서버여서 express-to-koa로 미들웨어를 koa용으로 변경하였다.</span>\n<span class=\"token comment\">// express 서버라면 그대로 사용 하면된다.</span>\n<span class=\"token keyword\">const</span> e2k <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express-to-koa'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> webpackDevMiddleware <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack-dev-middleware'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> webpackHotMiddleware <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack-hot-middleware'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>\n  <span class=\"token function\">e2k</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">webpackDevMiddleware</span><span class=\"token punctuation\">(</span>compiler<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      publicPath<span class=\"token operator\">:</span> webpackConfig<span class=\"token punctuation\">.</span>output<span class=\"token punctuation\">.</span>publicPath<span class=\"token punctuation\">,</span>\n      writeToDisk<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">e2k</span><span class=\"token punctuation\">(</span><span class=\"token function\">webpackHotMiddleware</span><span class=\"token punctuation\">(</span>compiler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>‘webpack-dev-middleware’\n<ul>\n<li>서버에서 webpack 구동(빌드) 및 watch 하는 미들웨어</li>\n</ul>\n</li>\n<li>‘webpack-hot-middleware’\n<ul>\n<li>서버에서 webpack 컴파일 완료가 되면, “compiler.hooks.done” 을 직접 잡아서 해야 하는데 해당 역할을 해주는 미들웨어</li>\n<li>동시에 서버쪽의 websocket 역할도 하고 있다.</li>\n<li>참고: <a href=\"https://github.com/webpack-contrib/webpack-hot-middleware/blob/master/middleware.js\">https://github.com/webpack-contrib/webpack-hot-middleware/blob/master/middleware.js</a></li>\n<li>당연히 build시 클라이언트 쪽에 ‘<a href=\"https://github.com/webpack-contrib/webpack-hot-middleware/blob/master/client.js\">https://github.com/webpack-contrib/webpack-hot-middleware/blob/master/client.js</a>’ 코드가 들어가야 한다. (runtime)\n<ul>\n<li>넣을때, webpack-dev-server처럼 webpack-dev-middleware사용시 동적으로 넣어도 되고</li>\n<li>클라이언트 빌드용 webpack.config 파일에서 명시해서 넣어주어도 된다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"클라이언트-코드에-통신--재기동-코드-넣어주기\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EC%BD%94%EB%93%9C%EC%97%90-%ED%86%B5%EC%8B%A0--%EC%9E%AC%EA%B8%B0%EB%8F%99-%EC%BD%94%EB%93%9C-%EB%84%A3%EC%96%B4%EC%A3%BC%EA%B8%B0\" aria-label=\"클라이언트 코드에 통신  재기동 코드 넣어주기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라이언트 코드에 “통신 / 재기동” 코드 넣어주기</h3>\n<ul>\n<li><a href=\"https://github.com/webpack-contrib/webpack-hot-middleware/blob/master/client.js\">https://github.com/webpack-contrib/webpack-hot-middleware/blob/master/client.js</a></li>\n<li>위 코드가 들어가야한다.</li>\n<li>webpack.client.config.js</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">module<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> entryName <span class=\"token operator\">=</span> <span class=\"token string\">'yourEntryName'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> hotMiddlewareScript <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">webpack-hot-middleware/client?name=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>entryName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;path=/__webpack_hmr&amp;timeout=20000&amp;reload=true</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    target<span class=\"token operator\">:</span> <span class=\"token string\">'web'</span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> entryName<span class=\"token punctuation\">,</span>\n    context<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">projects/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    entry<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">[</span>entryName<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'./src/index.js'</span><span class=\"token punctuation\">,</span> hotMiddlewareScript<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// webpack-hot-middleware/client 가 포함되게 한다.</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>\n    plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token comment\">// HotModuleReplaceMentPlugin이 들어와야 한다.</span>\n      <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack</span><span class=\"token punctuation\">.</span><span class=\"token function\">HotModuleReplacementPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">webpack-hot-middleware/client</code> 가 entry에 같이 들어와야 한다. (최종 빌드결과에 포하되게!!)</li>\n<li><code class=\"language-text\">new webpack.HotModuleReplacementPlugin()</code> 플러그인이 추가되어야 한다.\n<ul>\n<li>webpack-hot-middleware/client는 process-update.js을 사용한다.</li>\n<li>webpack-hot-middleware/process-update.js 에서는 module.hot을 검사한다.</li>\n<li>module.hot은 <code class=\"language-text\">new webpack.HotModuleReplacementPlugin()</code> 이 있어야만 한다.</li>\n</ul>\n</li>\n</ul>\n<p>위의 설정(서버쪽 middleware, 클라이언트 webpack.client.conf) 을 완료하고, 서버를 수행하여 클라인트 동적 빌드 이후, 클라이언트 코드를 수정하면 정상적으로 코드가 HMR 되는것을 확인 할 수 있다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></p>\n</li>\n<li>\n<p><a href=\"#hot-reloading\">Hot-Reloading</a></p>\n</li>\n<li>\n<p><a href=\"#how-to-hot-reloading\">How to Hot-Reloading</a></p>\n</li>\n<li>\n<p><a href=\"#hmr-%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9D%B8-%EC%95%84%EC%9D%B4%EB%94%94%EC%96%B4\">HMR 기본적인 아이디어</a></p>\n</li>\n<li>\n<p><a href=\"#hmr-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84%EC%B2%B4%EB%A1%9C-%EC%A2%80%EB%8D%94-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\">HMR 실제 구현체로 좀더 이해하기</a></p>\n<ul>\n<li><a href=\"#webpack-incremental-build-and-watch\">Webpack Incremental Build and watch</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#webpack-dev-server\">webpack-dev-server</a></p>\n</li>\n<li>\n<p><a href=\"#webpack-dev-server-hot\">webpack-dev-server HOT</a></p>\n</li>\n<li>\n<p><a href=\"#webpack-dev-server-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EC%95%8A%EA%B3%A0-hmr-%ED%95%B4%EB%B3%B4%EA%B8%B0\">Webpack Dev Server 사용하지 않고 HMR 해보기</a></p>\n<ul>\n<li><a href=\"#%EB%82%B4-%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-webpack-%EA%B5%AC%EB%8F%99-%EB%82%B4-%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-webpack-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80compilerhooksdone\">내 서버에서 webpack 구동, 내 서버에서 webpack 변경 감지(compiler.hooks.done)</a></li>\n<li><a href=\"#%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EC%BD%94%EB%93%9C%EC%97%90-%ED%86%B5%EC%8B%A0--%EC%9E%AC%EA%B8%B0%EB%8F%99-%EC%BD%94%EB%93%9C-%EB%84%A3%EC%96%B4%EC%A3%BC%EA%B8%B0\">클라이언트 코드에 “통신 / 재기동” 코드 넣어주기</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"소개 보통 javascript 프로젝트 개발시에, 일반적으로 next.js와 같은 통합 개발 환경을 사용하거나, 직접 개발 환경을 구축 하더라도, webpack-dev-server의 hot 옵션정도를 사용하여서 개발을 하게 된다. 따라서 이렇게 개발하는 경우 기본적으로 개발 환경이 HMR을 지원하고 있어서, 별도의 HMR에 대한 요구 사항을 느끼거나 하지는 않게 된다. 하지만 HMR의 동작 원리나 internal구조를 알고 싶거나, 특이한 형태의 HMR을 구축해야 하는경우, 혹은 직접 개발환경을 구축해서 만드는 경우, HMR에 대하여 좀더 명확하게 알고 사용 하는것이 좋다. 이러한 경우를 위해서 본 문서를 작성하였다. 목표는 다음과 같다. Hot Module Replacement라고 불리는 HMR의 기본적인 개념을 이해한다. Webpack의 Incremental 빌드를 이해한다. 전체적인 HMR의 동작 구조를 이해한다. Hot-Reloading 일단. HMR을 들어가기 앞서서, 이…","frontmatter":{"date":"January 24, 2022","title":"HMR 이해하기","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2022/2022-01-24-what-is-HMR/"}},"next":{"id":"b9d24642-294a-5a34-970f-417aea12d85a","html":"<aside>\n💡 <bold>\"If it looks like a duck, swims like a duck, and quacks like a duck, then it probably *is* a duck.\"\n\"무엇이든, 오리처럼 생겼고, 오리 처럼 걷고, 오리처럼 꽥꽥 거린다면 그건 오리다\"</bold>\n</aside>\n<br/>\n<h3 id=\"덕-타이핑duck-typing--이란\" style=\"position:relative;\"><a href=\"#%EB%8D%95-%ED%83%80%EC%9D%B4%ED%95%91duck-typing--%EC%9D%B4%EB%9E%80\" aria-label=\"덕 타이핑duck typing  이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>덕 타이핑(Duck Typing)  이란?</h3>\n<ul>\n<li>\n<p>사실상 위의 정의가 Duck Typing의 알파이지 오메가 이다.  (핵심 내용을 담고 있다)</p>\n</li>\n<li>\n<p>Duck Typing의 개념은 <a href=\"https://en.wikipedia.org/wiki/Duck_test\">Duck Test</a>에서 유래하였다.</p>\n</li>\n<li>\n<p><strong>Duck Typing</strong>은, **컴퓨터 프로그래밍 개념(패턴, 방법)**이다.</p>\n<ul>\n<li>컴퓨터 프로그래밍 언어에서 Type을 추론, (혹은 유추, 정의) 할때 사용된다.</li>\n<li>예제</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Typescript - Duck Typing</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Duck</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">talk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">swim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> duck <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">talk</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"꽥꽥\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">swim</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"오리 수영\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> human <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">talk</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"안녕하세요\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">swim</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"사람 수영\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">duckSwimAndTalk</span><span class=\"token punctuation\">(</span>duckType<span class=\"token operator\">:</span> Duck<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">swim ></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duckType<span class=\"token punctuation\">.</span><span class=\"token function\">swim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, talk > </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duckType<span class=\"token punctuation\">.</span><span class=\"token function\">talk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">duckSwimAndTalk</span><span class=\"token punctuation\">(</span>duck<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">duckSwimAndTalk</span><span class=\"token punctuation\">(</span>human<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// human이지만 Duck(interface) type 형태로 인식</span></code></pre></div>\n<ul>\n<li>위 코드를 보면 ”<strong>어떤 타입에 걸맞은 변수와 메소드를 지니면 객체를 해당 타입에 속하는 것으로 간주”</strong> 하고 있다.</li>\n<li>이처럼 <strong>구조</strong>가 같으면 같은 타입으로 간주하는 방식을 <em>Structural Typing</em>, Java/C# 등과 같이 <strong>이름</strong>을 기준으로 타입을 나누는 방식을 <em>Nominal Typing</em>이라 한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h3>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Duck_test\">https://en.wikipedia.org/wiki/Duck_test</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Duck_typing\">https://en.wikipedia.org/wiki/Duck_typing</a></li>\n<li><a href=\"https://ko.wikipedia.org/wiki/%EB%8D%95_%ED%83%80%EC%9D%B4%ED%95%91\">https://ko.wikipedia.org/wiki/덕_타이핑</a></li>\n<li><em>추천</em> - <a href=\"https://theburningmonk.com/2015/05/why-i-like-golang-interfaces/\">https://theburningmonk.com/2015/05/why-i-like-golang-interfaces/</a>\n<ul>\n<li>Duck Type - 편리함과 안정성의 균형…</li>\n</ul>\n</li>\n<li><em>추천</em> - <a href=\"https://soopdop.github.io/2020/12/09/duck-typing/\">https://soopdop.github.io/2020/12/09/duck-typing/</a>\n<ul>\n<li><em>Structural Typing</em>, <em>Nominal Typing</em> 관련 내용이 잘 설명</li>\n</ul>\n</li>\n<li><em>추천</em> - <a href=\"https://velog.io/@thms200/Typescript-Duck-Typing-%EB%8D%95%ED%83%80%EC%9D%B4%ED%95%91\">https://velog.io/@thms200/Typescript-Duck-Typing-덕타이핑</a>\n<ul>\n<li>오버로딩, 오버라이딩 관점의 내용이 있음, 딱 들어 맞지는 않지만 좋은 내용</li>\n</ul>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%8D%95-%ED%83%80%EC%9D%B4%ED%95%91duck-typing--%EC%9D%B4%EB%9E%80\">덕 타이핑(Duck Typing)  이란?</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</div>","frontmatter":{"date":"January 20, 2022","title":"Duck Typing 덕 타이핑 이란?","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2022/2022-01-20-Duck-Typing/"}},"prev":{"id":"89cea671-4656-585f-8682-bc58a70c4103","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>python을 html에서 구동하게 해주는, PyScript에 대하여 간략하게 알아봅니다.</p>\n<h3 id=\"pyscript-란\" style=\"position:relative;\"><a href=\"#pyscript-%EB%9E%80\" aria-label=\"pyscript 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PyScript 란?</h3>\n<ul>\n<li>python을 html에서 그대로 구동하게 하는것, 즉 javascript처럼 구동 가능하다.</li>\n<li><a href=\"https://realpython.com/python-news-april-2022/#pycon-us-2022\">PyCon US (2022-04-27 ~ 2022-05-03) 에서, 발표</a>(alpha 버전)되었다.\n<ul>\n<li>\n<p>현재(2022-06) 발표된 버전(alpha)이고, 공식 페이지에서도 상업용 사이트에서의 사용은 주의하라고 되어 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVQY0z3Q2U7CQACF4T6OdJnpOiwttNOVmekMRRQKSIwNSAxhC4rxggfA6DsbJJp8V+e/OxLQEdSRrBg3sl5TDA06AKIrDdgAOlCvy+qlatD5r1BHADqSj0lG+qv18fB2Wm/fi8GMiZKJES+mbT/z2klKiuXL/nA8FbcPvf40740pH/Fi4mMqJVlPFKPZ43Kx3FTzVTmpGB8SdpeLsunFjRaOEj6ZPVfz9X35NBxXuShTMmCiDEImGVYzjGkHU9e/aGPmh9yPeBDzOKFplqepCCOKQxKnLIpZnORdIgLcBRBJuoFEMXyd8+9997wl5y393NGvHflYEBxmAc5w+AdnAU6vS7MVqJol/b6C3DrqNCwXmV7ddB3DQ2YL2QDasmIoqikrRk3WFdUC0FZU80oD9g9DjGCxsG1xzAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pyscript f0\"\n        title=\"pyscript f0\"\n        src=\"/static/d3c5add79a347994c0bb0256e3bace00/37523/pyscript-f0.png\"\n        srcset=\"/static/d3c5add79a347994c0bb0256e3bace00/e9ff0/pyscript-f0.png 180w,\n/static/d3c5add79a347994c0bb0256e3bace00/f21e7/pyscript-f0.png 360w,\n/static/d3c5add79a347994c0bb0256e3bace00/37523/pyscript-f0.png 720w,\n/static/d3c5add79a347994c0bb0256e3bace00/302a4/pyscript-f0.png 1080w,\n/static/d3c5add79a347994c0bb0256e3bace00/07a9c/pyscript-f0.png 1440w,\n/static/d3c5add79a347994c0bb0256e3bace00/b88bf/pyscript-f0.png 1702w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"hello-world\" style=\"position:relative;\"><a href=\"#hello-world\" aria-label=\"hello world permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>hello world</h3>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width,initial-scale=1<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>PyScript Hello World<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>image/png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>favicon.png<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://pyscript.net/alpha/pyscript.css<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">defer</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://pyscript.net/alpha/pyscript.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    Hello world! <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\n    This is the current date and time, as computed by Python:\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>py-script</span><span class=\"token punctuation\">></span></span>\n        from datetime import datetime\n        now = datetime.now()\n        now.strftime(\"%m/%d/%Y, %H:%M:%S\")\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>py-script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>ref: <a href=\"https://github.com/pyscript/pyscript/blob/main/examples/hello_world.html\">https://github.com/pyscript/pyscript/blob/main/examples/hello_world.html</a></li>\n<li>위 코드를 생성하여 실제 구동해보면, javascripg처럼 실제 구동되어서 화면에 날자가 프린트 되는걸 확인 할 수 있다.</li>\n<li>코드를 분석해보면, <code class=\"language-text\">pyscript.js 파일을</code> 로드하고 있음을 알 수 있다. 해당 파일이 <code class=\"language-text\">py-script</code>을 구동하게 해준다.</li>\n</ul>\n<details open>\n  <summary>code and result 보기</summary>\n  <iframe width=\"100%\" height=\"200\" src=\"//jsfiddle.net/gseok/b76yove8/3/embedded/html,result/\" allowfullscreen=\"allowfullscreen\" allowpaymentrequest frameborder=\"0\"></iframe>\n</details>\n<h3 id=\"pyscript-simple-architecture\" style=\"position:relative;\"><a href=\"#pyscript-simple-architecture\" aria-label=\"pyscript simple architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PyScript simple architecture</h3>\n<p><strong>pyscript가 나오게된 배경</strong></p>\n<ul>\n<li>javascript는 client언어로 시작하여, server언어(node.js)로 확장되었다.</li>\n<li>그렇다면 server언어인 pyhton은 반대로 client언어(PyScript)로 확장 할 수 있지 않을까?\n<ul>\n<li>이러한 요구(잠재적 고객들 === python을 사용하는 개발자)가 있었다.</li>\n<li><strong>기술의 발전(사실상 webassemble 발전)으로 가능하게 됨. === PyScript</strong></li>\n</ul>\n</li>\n</ul>\n<p><strong>pyscript의 의미</strong></p>\n<ul>\n<li>python의 생태계(수많은 library, component 등등) 이 → web 생태계로, web생태계의 확장</li>\n<li>anaconda 팀에서 말하길\n<ul>\n<li>PyScript(Pyhton)을 활용하여 FE개발자가 web application을 만들수 있게 될꺼다.</li>\n<li>데이터 과학자 입장에서 html file을 이용하여, dashboard와 models을 공유하고, browser을 통해서 구동 할 수 있게 한다.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABsUlEQVQY05VRzWsTURz8CYJR8KQg+HEoeO3Bmwf1zxB68GIVtC30EBAMVfDkBwieRCk1MaLQYlqaWrG1raZVo1YsbeLSJI3byK5mE5uP3Wz27Xv73kha9O4cZi4zh5khbEMp+JwrKPwPyPMY5+J3raHl9abTBiClBGCa5vjERDI5lUiMlzb1HTfjcrlYd5jgqRQvrpOmW8u5qm3bP6u2xwQAITociQwRUSgUIqK+gcHtrDS22tfH8p918/Ho1a3sNQqkSueqPXeXPmY1z2cbv2yvbQO4dSN8qot6Tu/tPkKR3pMQBkSLMTc6/71iOTOZFw33HS28SUVis/eiQ8aniwW9MJXetPKvUB8L958jomMHdxPt6j1D0K6g9Lxe/nI+upqezaQvXyisjdDcwmLZ2lDmJbTmmy1uWrVAMAAjj2KHD+zp7tp39ND+22cJRlwC0nMX4y+N3A9MPmFvkwSAS6xWnG/1IPg3turUbmfulJ8eL8VOPAvfrGQ+dEqvZf37D92ZaX8uYccf7IRVscl125fq71mqI8ot+evDnjZcXnntOzUAges2l96j0RDaV55d+QP6q4DmAuzRkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pyscript f1\"\n        title=\"pyscript f1\"\n        src=\"/static/b52777e011511e4bc79fc06a795e6c88/37523/pyscript-f1.png\"\n        srcset=\"/static/b52777e011511e4bc79fc06a795e6c88/e9ff0/pyscript-f1.png 180w,\n/static/b52777e011511e4bc79fc06a795e6c88/f21e7/pyscript-f1.png 360w,\n/static/b52777e011511e4bc79fc06a795e6c88/37523/pyscript-f1.png 720w,\n/static/b52777e011511e4bc79fc06a795e6c88/302a4/pyscript-f1.png 1080w,\n/static/b52777e011511e4bc79fc06a795e6c88/07a9c/pyscript-f1.png 1440w,\n/static/b52777e011511e4bc79fc06a795e6c88/29007/pyscript-f1.png 1600w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Figuare 1. PyScript overview (ref: <a href=\"https://anaconda.cloud/api/files/de4b3735-17cf-4165-9dff-75102dbbd240\">https://anaconda.cloud/api/files/de4b3735-17cf-4165-9dff-75102dbbd240</a>)</p>\n<p><strong>pyscript는 어떻게 구동되는가?</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 453px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACjklEQVQoz1WR209SARzHzx9RL02b6yFtvtSaa5rZg7pytdKtkZdSZprT1HJrE9sUSEQFL+jUDbQWmIJCIfOGRzjc1IKBhyNM81KiqRgKgnJgHDjnNGwr++73+tn39/1+gbHv43RjYxvM48Kd3MXOdpjXAXc1W7jtcJdsQ95i4fKsPQeBQ5yIhPFIKBIizwjogLsfTD4q11aVQhXPoYpybXWlrqZYXZYPFrUt8qiq0jJNpSvgIkkSJ/BgOOjHUD/mRzEUwzFA8WOiwchqMDYOLAt7bXymic02cximptF1ed8S/62J3WzmdiO9fTb+MXaC4aE91Ll1vL3pc3hDPqDVwn08k1cIFtV/rX+prykAC19oq3KVT1osnAKQSlWVFKtLnoJUijLPiTpxAidI4t/b2/7Dhf01o2vd6t75drRrc2/aPQ67x+E4OXQHD1a92zaPY9mztXK0E4xgkVMYJ6JHEATwbN4QK5VcH1fESsXp4FTRnD4bUufrtTkaFUmSLARJB6cpOigTnF71eaPM2cL611YKDVC1cb50Qce0WtrsCNNqbrHBLGSRJMmRzQ06bObarY2I5VcwEMZxZwDdOPYtedzeUAh4ZfpyTjJ46ZMkTia+KBMnTchvTI4lTyqSpxTnRwYvjA7FycQx0qEE+eguimI4joax/UDgp9/vD2MAZxlJm524p53J0ijvQkqKQU3Rq3MN6vw56KEOzNIoszQzd6DpHJ3KGXUm/tuZ9XnuWt27NOZgKkOUyhDdZAjvc0ay26UZTUMpdGEqQ3SLIUqhCzObhl0+9HTtqE7DE8BriTqmpifxTX8CTRBPEyTWDdxmf8xoHU6if4iv5SfQBFdogsu1/Kv17/eOTv7Af51/AxLO2mw3ZorIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pyscript f2\"\n        title=\"pyscript f2\"\n        src=\"/static/0afe064f9a03353a2d1a67623310dbef/2108e/pyscript-f2.png\"\n        srcset=\"/static/0afe064f9a03353a2d1a67623310dbef/e9ff0/pyscript-f2.png 180w,\n/static/0afe064f9a03353a2d1a67623310dbef/f21e7/pyscript-f2.png 360w,\n/static/0afe064f9a03353a2d1a67623310dbef/2108e/pyscript-f2.png 453w\"\n        sizes=\"(max-width: 453px) 100vw, 453px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Figure 2. PyScript Tech Stack. (ref: <a href=\"https://anaconda.cloud/api/files/31ea07ba-dadc-4d18-b79e-d309328762d0\">https://anaconda.cloud/api/files/31ea07ba-dadc-4d18-b79e-d309328762d0</a>)</p>\n<ul>\n<li><a href=\"https://pyodide.org/en/stable/index.html\">Pyodide</a> 라고 불리는 <strong>webassembly</strong> 로 구성된 pyton용 wasm을 통해서 구동된다.</li>\n<li>즉 webassembly을 이용하여 구동된다. 따라서 각 browser vendor가 javascript engine와 같은 어떤 별도의 python engine을 browser에 가지고 있지 않아도 구동된다! (일단 현재는…)\n<ul>\n<li>개인적으로는 만약 python 개발자의 유입이 많아지면 사실상 native(browser) 에서 직접 제공도 할 수 있다고 생각한다. (그럼 javascript + python 투트랙?!? ← 먼훗날 확인하기로)</li>\n</ul>\n</li>\n<li>webassembly가 1.0을 발표(2019.12)하고, 약 2년만에 이렇게, python이 구동가능할 정도로 발전하다니 정말 놀랍다.\n<ul>\n<li>이런식이라면, 정말로, webassermbly는 다른 언어들, 특히나 script형 function형 언어들의 porting을 기대해볼만 할듯 하다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"pyscript-example\" style=\"position:relative;\"><a href=\"#pyscript-example\" aria-label=\"pyscript example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PyScript Example</h3>\n<p><strong>pyscript의 주요 구성 요소</strong></p>\n<ul>\n<li>\n<p>py-env: Python 코드를 실행하는데 필요한 Python 패키지를 정의한다.</p>\n<ul>\n<li><a href=\"https://github.com/pyscript/pyscript/blob/main/examples/panel_stream.html#L38-L43\">https://github.com/pyscript/pyscript/blob/main/examples/panel_stream.html#L38-L43</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>py-env</span><span class=\"token punctuation\">></span></span>\n    - bokeh\n    - numpy\n    - pandas\n    - panel==0.13.1\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>py-env</span><span class=\"token punctuation\">></span></span></code></pre></div>\n</li>\n<li>\n<p>py-script: Python 코드를 작성할수 있는 영역 태그. 혹은 Pyton 코드 file을 src로 로드하는 태그.</p>\n<ul>\n<li><code class=\"language-text\">&lt;script></code> 태그와 유사하다.</li>\n<li><a href=\"https://github.com/pyscript/pyscript/blob/main/examples/panel_stream.html#L69-L115\">https://github.com/pyscript/pyscript/blob/main/examples/panel_stream.html#L69-L115</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- 아래와 같이 python 파일을 로드 하던가 --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>py-script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/python_file.py<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>py-script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token comment\">&lt;!-- 또는 아래와 같이 python코드를 작성 할 수 있다.--></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>py-script</span><span class=\"token punctuation\">></span></span>\n\tfrom datetime import datetime\n\tnow = datetime.now()\n\tnow.strftime(\"%m/%d/%Y, %H:%M:%S\")\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>py-script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n</li>\n<li>\n<p>py-repl(Read Eval Print Loop): REPL을 바로 할 수 있게 해준다.</p>\n<ul>\n<li><a href=\"https://github.com/pyscript/pyscript/blob/main/examples/panel_deckgl.html#L70\">https://github.com/pyscript/pyscript/blob/main/examples/panel_deckgl.html#L70</a></li>\n</ul>\n<p><img src=\"/e86741f306c050f901beb7a7893f3632/pyscript-f3.gif\" alt=\"\"></p>\n<details open>\n  <summary>code and result 보기</summary>\n  <iframe width=\"100%\" height=\"300\" src=\"//jsfiddle.net/gseok/dorpsbk7/4/embedded/html,result/\" allowfullscreen=\"allowfullscreen\" allowpaymentrequest frameborder=\"0\"></iframe>\n</details>\n</li>\n</ul>\n<p><strong>그외 핵심요소</strong></p>\n<ul>\n<li><strong>Python ecosystem:</strong> 유명하고, 유용한 아주 많은 Python 패키지를 사용할 수 있다. (such as numpy, pandas, scikit-learn, and more)</li>\n<li><strong>Python with JavaScript:</strong> Javascript와 Python양방향으로 객체(objects)와 namespaces에 접근하고 통신(사용) 할 수 있다.(이 부분의 deep한 기술 내용은 Pyodied의 js ↔ python간 사용 관련 문서를 참고)</li>\n<li><strong>Environment management:</strong> 사용자가 사용하고자하는 python패키지를 정의하고 관리할 수 있다.(py-env)</li>\n<li><strong>Visual application development:</strong> 버튼, 컨테이너, 텍스트박스 등 즉시 사용가능한 UI요소를 제공하고 있다.</li>\n</ul>\n<h3 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h3>\n<ul>\n<li>PyScript 는 python을 on browser에서 구동하게 해준다. (PyScript brings Python to the browser.)</li>\n<li>Browser에서 python엔진을 제공하는건 아니고 webassembly기술을 활용하여 제공되고 있다.</li>\n<li>이제 alpha version으로 시작이지만, python의 미래이자 web기술(생태계)의 확장이다. (아직 tensorflow등은 구동 안된다고 한다…)</li>\n<li>web(FE) 개발자라면 매우 관심있게 지켜볼 주제라고 본다.(python 도 공부해서 같이 쓰자~)</li>\n</ul>\n<h3 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h3>\n<ul>\n<li>공식홈페이지: <a href=\"https://pyscript.net/\">https://pyscript.net/</a></li>\n<li>아나콘다 문서: <a href=\"https://anaconda.cloud/pyscript-python-in-the-browser\">https://anaconda.cloud/pyscript-python-in-the-browser</a></li>\n<li>Getting Started: <a href=\"https://github.com/pyscript/pyscript/blob/main/docs/tutorials/getting-started.md\">https://github.com/pyscript/pyscript/blob/main/docs/tutorials/getting-started.md</a></li>\n<li>python 기사: <a href=\"https://realpython.com/python-news-april-2022/\">https://realpython.com/python-news-april-2022/</a></li>\n<li>git: <a href=\"https://github.com/pyscript?type=source\">https://github.com/pyscript?type=source</a></li>\n<li>examples: <a href=\"https://github.com/pyscript/pyscript/tree/main/examples\">https://github.com/pyscript/pyscript/tree/main/examples</a></li>\n<li>Pyodide: <a href=\"https://pyodide.org/en/stable/index.html\">https://pyodide.org/en/stable/index.html</a>\n<ul>\n<li>js가 python사용하기: <a href=\"https://pyodide.org/en/stable/usage/quickstart.html#accessing-python-scope-from-javascript\">https://pyodide.org/en/stable/usage/quickstart.html#accessing-python-scope-from-javascript</a></li>\n<li>python이 js사용하기: <a href=\"https://pyodide.org/en/stable/usage/quickstart.html#accessing-javascript-scope-from-python\">https://pyodide.org/en/stable/usage/quickstart.html#accessing-javascript-scope-from-python</a></li>\n</ul>\n</li>\n<li>webassembly: <a href=\"https://webassembly.org/\">https://webassembly.org/</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#pyscript-%EB%9E%80\">PyScript 란?</a></li>\n<li><a href=\"#hello-world\">hello world</a></li>\n<li><a href=\"#pyscript-simple-architecture\">PyScript simple architecture</a></li>\n<li><a href=\"#pyscript-example\">PyScript Example</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</div>","frontmatter":{"date":"June 03, 2022","title":"pyscript 소개","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2022/2022-06-06-pyscript/"}},"site":{"siteMetadata":{"siteUrl":"https://gseok.github.io","comments":{"utterances":{"repo":"gseok/gseok.github.com"}}}}},"pageContext":{"slug":"/tech-talk-2022/2022-01-24-what-is-HMR/","nextSlug":"/tech-talk-2022/2022-01-20-Duck-Typing/","prevSlug":"/tech-talk-2022/2022-06-06-pyscript/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}