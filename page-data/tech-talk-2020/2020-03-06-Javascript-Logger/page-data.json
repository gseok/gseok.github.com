{"componentChunkName":"component---src-templates-blog-template-js","path":"/tech-talk-2020/2020-03-06-Javascript-Logger/","result":{"data":{"cur":{"id":"dde3ea61-dd89-5d09-b814-ddeaf99bf8a7","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>javascript의 logger의 개념과 사용을 간략하게 소개합니다.</p>\n<p><strong>개념설명</strong></p>\n<p>javascript 개발 환경에서 특히 client개발을 하는경우 console.log을 보통 사용하기 때문에, 다른 언어나 framework에서 사용하는 별도의 logger을 도입하는 경우가 많지는 않습니다. 하지만 node와 같은 서버에서는 logger를 도입해서 사용하는것이 좀더 효율적으로 server log을 관리 할 수 있다고 생각됩니다.</p>\n<p>logger을 도입하면 아래와 같은 이점이 있습니다.</p>\n<ul>\n<li>Log을 Level별로 관리 할 수 있습니다.</li>\n<li>Log을 file or stdout형태로 관리 할 수 있습니다.</li>\n<li>Log format을 각 프로젝트에 맞게 custtomize할 수 있습니다.</li>\n<li>Log을 빌드 시점 or Runtime에 on/off 할 수 있습니다.</li>\n</ul>\n<p><strong>Log Level</strong></p>\n<p>로그 레벨이 javascipt에서는 표준처럼 정해진 부분은 없습니다. 다만 unix system의 syslog의 RFC5424형태나 android, apach(log4j)등을 참고해 볼 수 있습니다.</p>\n<p>syslog (<a href=\"https://tools.ietf.org/html/rfc5424\">RFC5424</a>)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABPElEQVQY022Ra4+qMBBA9///MxOjtDxKX9ZCQVoaC1ZUTKWbu3h3s8me7yczc+ZjnucYo/deStk0Tdu24zh2XaeUGoZhHEdjTF3X1tplWeJvPu73e4zROZckCUKIc16WJSEEAEAIEUJACDebDWMsz/Pj8SiE6Pv+Ld9utxjjMAwYY855VVVCCKVUmqaMMYwxpbT/Yp7nEMLr9fpe4S1ba/f7Pca4rmuEECFklQEAh8NBKRVCWIXli7c8TdM6OcuyJEmklFmWFUVRVRWlNM/zLMsghAghxth2u4UQNk3zfD5/bh7HEQBQliVjbLfbSSk555TSNE2LooAQns9nY8zpdNJa/wS7Xq8hhMfjYYxxznnvtdaXy8Va6713zvV9/2fqfzKl1Fo7TZPWWkrZdd3abP1Q27Za6zXv8p9v+RPqureN9czVYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"01\"\n        title=\"01\"\n        src=\"/static/a071cd96c2801b084506b869481d4ab2/37523/01.png\"\n        srcset=\"/static/a071cd96c2801b084506b869481d4ab2/e9ff0/01.png 180w,\n/static/a071cd96c2801b084506b869481d4ab2/f21e7/01.png 360w,\n/static/a071cd96c2801b084506b869481d4ab2/37523/01.png 720w,\n/static/a071cd96c2801b084506b869481d4ab2/47ff6/01.png 852w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>android</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQ0lEQVQ4y22TSWsVQRSF6z8niHtBd4mgqxfIToibgJv4K3QRFIeY4XV1zeOtqfu9Hp50v2BiJ/BxOVVUcW+dQ6GT88+r84vV+cX7j58e8+5sYrG5AL0+PXtzevbq5MPB8erwES/frl4crw6OVoczB0cP+t8ZdPnz6mqN10xUXD4g9BcCX6l3IdmQLMRJwEyI2sEepJ13IULKC5gBaQE8OA8A0TnvJ+0BQtf1fT/0/YCkdcp57eExBkItTc0VE4IJqYylXHCpuFRCqty0pd007Qb9uV0zpW2IBsIDIV3aDqdht9sN49gN4ziJPWPXD9uu32w7BLksb0JwELwSivOqprgmjIs1rmtCa0JxTSkXhDLnAVWUcW0MhP8mh/hdhBsNMUaIKaTswyT2hLmm0iDMuDD2ydjxRifqU8o5ppxyiWkW6X6ZcmmaFvmUl209GA+Sc0ZpVZMK15Txuwrj+QlVTQjjmFAHAV3fVU8MAxPTD9+Hzd6wXT8MU703bNePYz+Mk2H7nBaGWQhMaGuMUpoLpbXhYgpJSCWl0sZqbUvTIqa0tO5pzmtpfxNFhZ4POyGU0kZpI5WW2gipUi7opsLP5vzLd9/stnTjOAc7Dz/u6YbhfuxQmudzllxzinG9rmbD1lVVE4wn/whluCYQIrrFNVN6YbiCeCmzgNI0TSpNbtpcmlz2dSKVprQtIkJK6xadTYjXEpQLAGH6GCF6CH7WzgcPEULMpSAXp1+2wIVolOJcMMYp5VIpQhjjYoJyIRTjwnv4C6k0yDemIZaIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"02\"\n        title=\"02\"\n        src=\"/static/e96968d25680dec83cbe1a4bdc402422/37523/02.png\"\n        srcset=\"/static/e96968d25680dec83cbe1a4bdc402422/e9ff0/02.png 180w,\n/static/e96968d25680dec83cbe1a4bdc402422/f21e7/02.png 360w,\n/static/e96968d25680dec83cbe1a4bdc402422/37523/02.png 720w,\n/static/e96968d25680dec83cbe1a4bdc402422/302a4/02.png 1080w,\n/static/e96968d25680dec83cbe1a4bdc402422/3fca6/02.png 1112w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>log4j</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdUlEQVQoz1WS246oIAxF/f9vnCeNAnKRcimIIBPp0cxZD8QQWjbLToyxbds45/M864Fzzlp7HIcxxlrrvbfWAoAdSClp9d5PZgAAcZBSwpeUknOOcy6ECP8TYzzPc0opCSG01ohordVaG2MoAt28ruu2bdT3I4SQc54AoL/EGNd1lVIyxoQQnHMAuK4r55xSomgU6h48xa21+7577wDw8/NzHMd31L2EELz3zjk/uO+7tfbE7r231nrvIYR1Xfd9F0KQM5KklAIAUgMAJLXWOuWcqc3f4n3fQwgk7zzPUkqtldbrukopbTBprb+bEZH+hLWWbGmtvfe99/vlE/QUK6VqrbSLiIwxpZQxRkqpBvu+Syk551JK2pdSppQeYV/j3ru1dp5n5xyNBK3HCwWhptd1PcW11i92jFFrTWJDCIhII0EfdA3xz7bW+ntMCGFZFvYihGCM0YRxzpdlQcTv/Y9tSk+UUmKMNBIfeXCeJyKWUu4//AJva+aljCE8HgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"03\"\n        title=\"03\"\n        src=\"/static/72d7bf4bffe6561ed2992116c3249637/37523/03.png\"\n        srcset=\"/static/72d7bf4bffe6561ed2992116c3249637/e9ff0/03.png 180w,\n/static/72d7bf4bffe6561ed2992116c3249637/f21e7/03.png 360w,\n/static/72d7bf4bffe6561ed2992116c3249637/37523/03.png 720w,\n/static/72d7bf4bffe6561ed2992116c3249637/302a4/03.png 1080w,\n/static/72d7bf4bffe6561ed2992116c3249637/07a9c/03.png 1440w,\n/static/72d7bf4bffe6561ed2992116c3249637/e2d3b/03.png 1466w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>중요한 점은 Log을 Level로 구분하고, 의미를 부여하여서 관리 &#x26; 적용한다는 부분입니다. 보통 Error, Debug, Warning, Info는 거의 비슷하게(비슷한 의미로) 존재합니다.</p>\n<h3 id=\"winston\" style=\"position:relative;\"><a href=\"#winston\" aria-label=\"winston permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>winston</h3>\n<p>java(apach)의 경우 log4j라는 유명한 logger라이브러리가 있습니다. javascript의 경우 javascript을 대표하는 logger라이브러리는 없지만, javascript진영에서 가장 많이 사용하는 (Top10)라이브러리중 하나인 winston을 소개합니다.</p>\n<p>참고: <a href=\"https://github.com/winstonjs/winston\">https://github.com/winstonjs/winston</a></p>\n<p><strong>winston의 특징은 다음과 같습니다.</strong></p>\n<ul>\n<li>javascript logger.</li>\n<li>log level 컨트롤이 가능합니다.\n<ul>\n<li>custom log level정의가 가능합니다.</li>\n<li>log level에 따른 동적 처리가 가능합니다.</li>\n</ul>\n</li>\n<li>Transport기능을 제공합니다.\n<ul>\n<li>log을 file, db 등으로 출력하는게 가능합니다. 물론 stdout(console.log)도 가능합니다.</li>\n<li>log의 출력을 level별로 조정 하는게 가능합니다.</li>\n<li>참고: <a href=\"https://github.com/winstonjs/winston#transports\">https://github.com/winstonjs/winston#transports</a></li>\n</ul>\n</li>\n<li>Format 기능을 제공합니다.\n<ul>\n<li>Custom한 format을 생성할 수 있습니다.</li>\n<li>참고: <a href=\"https://github.com/winstonjs/logform\">https://github.com/winstonjs/logform</a></li>\n</ul>\n</li>\n<li>Profile 기능을 제공합니다.\n<ul>\n<li>간략한 수준 (수행시간 측정)에 활용 가능한 profile기능을 제공합니다.</li>\n<li>참고: <a href=\"https://github.com/winstonjs/winston#profiling\">https://github.com/winstonjs/winston#profiling</a></li>\n</ul>\n</li>\n<li>Querying Logs 기능을 제공합니다.</li>\n</ul>\n<p><strong>winston custom logger</strong></p>\n<p>아래 코드 예제처럼 사용자 입맛에 맞는 형태로 logger구성을 하여 사용하는것이 가능합니다.</p>\n<ul>\n<li>\n<p>Code</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Logger <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'winston'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> winston <span class=\"token keyword\">from</span> <span class=\"token string\">'winston'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> combine<span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">,</span> colorize<span class=\"token punctuation\">,</span> printf<span class=\"token punctuation\">,</span> json <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> winston<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">customFormat</span><span class=\"token operator\">:</span> any <span class=\"token operator\">=</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">info</span><span class=\"token operator\">:</span> any</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">[</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>info<span class=\"token punctuation\">.</span>timestamp<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">][</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>info<span class=\"token punctuation\">.</span>level<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">] </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>info<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// NOTE: Log only less than or equal to this level (log level)</span>\n<span class=\"token comment\">// LOG_LEVEL is setting when webpack build time</span>\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">customLogger</span><span class=\"token operator\">:</span> Logger <span class=\"token operator\">=</span> winston<span class=\"token punctuation\">.</span><span class=\"token function\">createLogger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">level</span><span class=\"token operator\">:</span> <span class=\"token string\">'LOG_LEVEL'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">levels</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">log</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// log always displayed</span>\n    <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">warn</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">info</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">debug</span><span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">format</span><span class=\"token operator\">:</span> <span class=\"token function\">combine</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">timestamp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">format</span><span class=\"token operator\">:</span> <span class=\"token string\">'YYYY-MM-DD HH:mm:ss.SSS'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">colorize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    customFormat<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">transports</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">winston<span class=\"token punctuation\">.</span>transports<span class=\"token punctuation\">.</span>Console</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">level</span><span class=\"token operator\">:</span> <span class=\"token string\">'LOG_LEVEL'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwinston<span class=\"token punctuation\">.</span><span class=\"token function\">addColors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">log</span><span class=\"token operator\">:</span> <span class=\"token string\">'grey'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">error</span><span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">warn</span><span class=\"token operator\">:</span> <span class=\"token string\">'yellow'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">info</span><span class=\"token operator\">:</span> <span class=\"token string\">'green'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">debug</span><span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token literal-property property\">formatObject</span><span class=\"token operator\">:</span> Function <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>param<span class=\"token operator\">:</span> any<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">string</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> any <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> param<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">||</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> Set<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>any</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> = new Set();\n      return JSON.stringify(\n        param,\n        (key, value) => </span><span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> value <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">&amp;&amp;</span> value <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cache<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token comment\">// Circular reference found</span>\n              <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// If this value does not reference a parent it can be deduped</span>\n                <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token comment\">// discard key if value cannot be deduped</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">// Store value in our set</span>\n            cache<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        2,\n      );\n    }\n  }\n  return param;\n};\n\nconst createLogContent: Function = (...args: any[]): string => </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    args<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">logData</span><span class=\"token operator\">:</span> any<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">index</span><span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        data <span class=\"token operator\">+=</span> <span class=\"token function\">formatObject</span><span class=\"token punctuation\">(</span>logData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      data <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatObject</span><span class=\"token punctuation\">(</span>logData<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">;\n\n// support multiple arguments e.g) logger.debug('arg1', 'arg2', 'arg3')\nconst logger: any = </span><span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">log</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> any<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    customLogger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'log'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">createLogContent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">error</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> any<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    customLogger<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token function\">createLogContent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// TODO: implements sen nelo log</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">warn</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> any<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    customLogger<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token function\">createLogContent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">info</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> any<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    customLogger<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token function\">createLogContent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">debug</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> any<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    customLogger<span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token function\">createLogContent</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">;\n\nif (process.env.NODE_ENV !== 'production') </span><span class=\"token punctuation\">{</span>\n  logger<span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Logging initialized at debug level'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\nexport default logger;</span></code></pre></div>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#winston\">winston</a></li>\n</ul>\n</div>","excerpt":"소개 javascript의 logger의 개념과 사용을 간략하게 소개합니다. 개념설명 javascript 개발 환경에서 특히 client개발을 하는경우 console.log을 보통 사용하기 때문에, 다른 언어나 framework에서 사용하는 별도의 logger을 도입하는 경우가 많지는 않습니다. 하지만 node와 같은 서버에서는 logger를 도입해서 사용하는것이 좀더 효율적으로 server log을 관리 할 수 있다고 생각됩니다. logger을 도입하면 아래와 같은 이점이 있습니다. Log을 Level별로 관리 할 수 있습니다. Log을 file or stdout형태로 관리 할 수 있습니다. Log format을 각 프로젝트에 맞게 custtomize할 수 있습니다. Log을 빌드 시점 or Runtime에 on/off 할 수 있습니다. Log Level 로그 레벨이 javascipt에서는 표준처럼 정해진 부분은 없습니다. 다만 unix system의 syslog의 RFC5424…","frontmatter":{"date":"March 06, 2020","title":"Javascript Logger","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-03-06-Javascript-Logger/"}},"next":{"id":"6aed024d-3150-59ce-b0cb-8eee82cd380d","html":"<p><strong>react + typescript에서 svg import로 사용하기</strong></p>\n<ul>\n<li>scss처럼 svg을 react module처럼 쓰기 위해서는 아래와 같은 처리 필요\n<ul>\n<li>a. 우리는 typescript이기 때문에 최초 typescript(tsc)가 알아먹도록 type정의 추가 필요</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// @types/index.d.ts 에 정의</span>\n<span class=\"token comment\">// @types/index.d.ts는 tsconfig.json 에 typeRoots로 인식하게 해둠.</span>\n<span class=\"token comment\">// tsconfig.js는 webpack의 ts-loader 에서 configFile을 통해서 설정.</span>\n<span class=\"token comment\">// 따라서 webpack build을 통해서, 아래 정의가 인식됨.</span>\ndeclare module <span class=\"token string\">'*.svg'</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">import</span> React <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token literal-property property\">ReactComponent</span><span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>FunctionComponent<span class=\"token operator\">&lt;</span>React<span class=\"token punctuation\">.</span>SVGProps<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SVGSVGElement</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">>;\n  const src: string;\n  export default src;\n}</span></code></pre></div>\n<ul>\n<li>b. type스크립트 이후 react가 component형태로 알아먹게 하기 위해서, <code class=\"language-text\">@svgr/webpack</code> 와, <code class=\"language-text\">url-loader</code> 필요</li>\n<li>c. 이제 각 webpack의 rule에 아래와 같이 svg 모듈 처리 추가 필요</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack.config.js 에 아래 rule이 추가되어야함.</span>\n<span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.svg$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'@svgr/webpack'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'url-loader'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n<li>d. 일반적인 프로젝트에서는 위 설정적용으로 완료인데, storybook은 그래도 에러 발생, 이유는 - storybook의 내장 webpack설정에 svg파일은 file-loader로 rule이 정의되어 있음. 해당 부분을 storybook webpack hook(config hook)으로 덮어 써야함</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 스토리북을 사용하는경우, .storybook/main.js 에 아래와 같이 storybook의 기본 loader</span>\n<span class=\"token comment\">// file-lodaer을 override하여 svg을 exclude하고, 위 a,b,c와 같이 svg용 loader을</span>\n<span class=\"token comment\">// 추가</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">webpackFinal</span><span class=\"token operator\">:</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">config</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.(ts|tsx)$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ts-loader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// Optional</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-docgen-typescript-loader'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.module\\.(scss|sass)$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'style-loader'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'css-loader'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">importLoaders</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">modules</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// to convert the resulting CSS to Javascript to be bundled (modules:true to rename CSS classes in output to cryptic identifiers, except if wrapped in a :global(...) pseudo class)</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'resolve-url-loader'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'sass-loader'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// to convert SASS to CSS</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.svg$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'@svgr/webpack'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'url-loader'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// NOTE: modify storybook's file-loader rule 에서 svg 룰 제거해야함 !!!!</span>\n    <span class=\"token keyword\">const</span> fileLoaderRule <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rule</span> <span class=\"token operator\">=></span> rule<span class=\"token punctuation\">.</span>test<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.svg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    fileLoaderRule<span class=\"token punctuation\">.</span>exclude <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.svg$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span>\n\n    config<span class=\"token punctuation\">.</span>resolve<span class=\"token punctuation\">.</span>extensions<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.ts'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.tsx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> config<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">stories</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'../**/*.stories.[tj]sx'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'./*.stories.[tj]s'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>e. 사용</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// storybook이나, 실제 개발환경에서 빌드에러없이 빌드 되면 아래와 같이 사용 가능.</span>\n\n<span class=\"token comment\">// 1. component로 사용, react components 형태로 사용가능</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ReactComponent <span class=\"token keyword\">as</span> TestIcon <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'test.svg'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Test</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TestIcon</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 2. text(string)으로 사용, 아래처럼 import하면 svg str이 넘어옴, 사용은 img태그등의 src로 사용.</span>\n<span class=\"token keyword\">import</span> testIconSvgStr <span class=\"token keyword\">from</span> <span class=\"token string\">'test.svg'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Test</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>testIconSvgSgr<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>참고: <a href=\"https://stackoverflow.com/questions/54121536/typescript-module-svg-has-no-exported-member-reactcomponent\">https://stackoverflow.com/questions/54121536/typescript-module-svg-has-no-exported-member-reactcomponent</a></p>\n<p>참고: <a href=\"https://github.com/boopathi/react-svg-loader/issues/197\">https://github.com/boopathi/react-svg-loader/issues/197</a></p>\n<p>참고: <a href=\"https://stackoverflow.com/questions/54292667/react-storybook-svg-failed-to-execute-createelement-on-document\">https://stackoverflow.com/questions/54292667/react-storybook-svg-failed-to-execute-createelement-on-document</a></p>\n<p>참고: <a href=\"https://www.npmjs.com/package/@svgr/webpack\">https://www.npmjs.com/package/@svgr/webpack</a></p>\n<p>참고: <a href=\"https://medium.com/@allalmohamedlamine/react-best-way-of-importing-svg-the-how-and-why-f7c968272dd9\">https://medium.com/@allalmohamedlamine/react-best-way-of-importing-svg-the-how-and-why-f7c968272dd9</a></p>","frontmatter":{"date":"March 01, 2020","title":"react + typescript에서 svg import로 사용하기","categories":"tech-talk react","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-03-01-React-Typescript-svg-import/"}},"prev":{"id":"353e7284-a207-5549-bde9-888c8bcff3b4","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>git hook 의 개념과 사용법에 대하여 소개합니다.</p>\n<h3 id=\"git-hook\" style=\"position:relative;\"><a href=\"#git-hook\" aria-label=\"git hook permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Git Hook</h3>\n<p>Git도 다른 버전 관리 시스템처럼 어떤 이벤트가 생겼을 때 자동으로 특정 스크립트를 실행하도록 할 수 있습니다. Git 에서는 이를 hook 으로 제공하고 있습니다. 내부적으로 client hook과 server hook으로 구분됩니다.</p>\n<p><strong>git hook 설치 및 사용</strong></p>\n<p>git hook의 설치 위치는 기본적으로<code class=\"language-text\">.git/hooks</code> 입니다. 이 디렉토리에 가보면 Git이 자동으로 넣어준 매우 유용한 스크립트 sample이 몇 개 있습니다. 그리고 스크립트가 입력받는 값이 어떤 값인지 파일 안에 자세히 설명되어 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># An example hook script to verify what is about to be committed.</span>\n<span class=\"token comment\"># Called by \"git commit\" with no arguments.  The hook should</span>\n<span class=\"token comment\"># exit with non-zero status after issuing an appropriate message if</span>\n<span class=\"token comment\"># it wants to stop the commit.</span>\n<span class=\"token comment\">#</span>\n<span class=\"token comment\"># To enable this hook, rename this file to \"pre-commit\".</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token function\">git</span> rev-parse --verify HEAD <span class=\"token operator\">></span>/dev/null <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span>\n<span class=\"token keyword\">then</span>\n        <span class=\"token assign-left variable\">against</span><span class=\"token operator\">=</span>HEAD\n<span class=\"token keyword\">else</span>\n        <span class=\"token comment\"># Initial commit: diff against an empty tree object</span>\n        <span class=\"token assign-left variable\">against</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> hash-object -t tree /dev/null<span class=\"token variable\">)</span></span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># If you want to allow non-ASCII filenames set this variable to true.</span>\n<span class=\"token assign-left variable\">allownonascii</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> config --bool hooks.allownonascii<span class=\"token variable\">)</span></span>\n\n<span class=\"token comment\"># Redirect output to stderr.</span>\n<span class=\"token builtin class-name\">exec</span> <span class=\"token operator\"><span class=\"token file-descriptor important\">1</span>></span><span class=\"token file-descriptor important\">&amp;2</span>\n\n<span class=\"token comment\"># Cross platform projects tend to avoid non-ASCII filenames; prevent</span>\n<span class=\"token comment\"># them from being added to the repository. We exploit the fact that the</span>\n<span class=\"token comment\"># printable range starts at the space character and ends with tilde.</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$allownonascii</span>\"</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"true\"</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span>\n        <span class=\"token comment\"># Note that the use of brackets around a tr range is ok here, (it's</span>\n        <span class=\"token comment\"># even required, for portability to Solaris 10's /usr/bin/tr), since</span>\n        <span class=\"token comment\"># the square bracket bytes happen to fall in the designated range.</span>\n        <span class=\"token builtin class-name\">test</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">git</span> <span class=\"token function\">diff</span> --cached --name-only --diff-filter<span class=\"token operator\">=</span>A -z $against <span class=\"token operator\">|</span>\n          <span class=\"token assign-left variable\"><span class=\"token environment constant\">LC_ALL</span></span><span class=\"token operator\">=</span>C <span class=\"token function\">tr</span> -d <span class=\"token string\">'[ -~]\\0'</span> <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> -c<span class=\"token variable\">)</span></span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">then</span>\n        <span class=\"token function\">cat</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token punctuation\">\\</span>EOF\nError: Attempt to <span class=\"token function\">add</span> a non-ASCII <span class=\"token function\">file</span> name.\n\nThis can cause problems <span class=\"token keyword\">if</span> you want to work with people on other platforms.\n\nTo be portable it is advisable to <span class=\"token function\">rename</span> the file.\n\nIf you know what you are doing you can disable this check using:\n\n  <span class=\"token function\">git</span> config hooks.allownonascii <span class=\"token boolean\">true</span>\nEOF\n        <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># If there are whitespace errors, print the offending file names and fail.</span>\n<span class=\"token builtin class-name\">exec</span> <span class=\"token function\">git</span> diff-index --check --cached <span class=\"token variable\">$against</span> --</code></pre></div>\n<p>기본적으로 모든 예제는 Shell 또는 Perl 스크립트로 작성돼 있지만 실행할 수만 있으면 되고 node, ruby, python같은 익숙한 언어로 만들어도 됩니다.</p>\n<p>실행할 수 있는 스크립트 파일을 확장자 없이 저장소의 <code class=\"language-text\">.git/hooks</code> 디렉토리에 넣으면 훅 스크립트 활성화 됩니다.</p>\n<p>다음에서 대표적인 hook을 몇개 살펴보겠습니다.</p>\n<p><strong>pre-commit</strong></p>\n<ul>\n<li>커밋할 때 가장 먼저 호출되는 훅으로 커밋 메시지를 작성하기 전에 호출 됩니다.</li>\n<li>커밋할 때 꼭 확인해야 할 게 있으면 이 훅으로 확인합니다.</li>\n<li>이 훅의 Exit 코드가 0이 아니면 커밋은 취소됩니다.</li>\n<li>git commit —no-verify 사용시 이 훅은 무시됩니다.</li>\n<li>lint 같은 프로그램으로 코드 스타일을 검사하거나, 라인 끝의 공백 문자를 검사하거나, 새로 추가한 코드에 주석을 달았는지 검사하는 등의 역할을 하기위한 훅 입니다.</li>\n</ul>\n<p><strong>commit-msg</strong></p>\n<ul>\n<li>커밋 메시지가 들어 있는 임시 파일의 경로를 아규먼트로 받습니다.</li>\n<li>이 훅의 Exit 코드가 0이 아니면 커밋은 취소됩니다.</li>\n<li>훅에서 최종적으로 커밋이 완료되기 전에 프로젝트 상태나 커밋 메시지를 검증하는데 사용합니다.</li>\n<li>커밋이 완료되면 이후 post-commit 훅이 실행됩니다.</li>\n</ul>\n<p><strong>pre-push</strong></p>\n<ul>\n<li>git push 명령을 실행하면 동작하는데 리모트 정보를 업데이트 하고 난 후 리모트로 데이터를 전송하기 전에 동작 합니다.</li>\n<li>이 훅의 Exit 코드가 0이 아니면 push은 취소됩니다.</li>\n<li>보통 Push 하기 전에 커밋이 유효한지 확인하는 용도로 사용합니다.</li>\n</ul>\n<p>그외 hook에 대해서는 git 공식 문서를 참고하세요</p>\n<p>참고: <a href=\"https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks\">git hooks</a></p>\n<h3 id=\"husky\" style=\"position:relative;\"><a href=\"#husky\" aria-label=\"husky permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>husky</h3>\n<p>git hook 을 직접 구축 할 필요없이, 이미 존재하는 script나 command을 연동하여 git hook의 역할을 하도록 해주는 git hook 유틸 모듈입니다.</p>\n<p>여러 개발자가 공통의 git hook을 사용하려면, 동일하게 각 개발자 local 환경에서 .git/hooks 에 동일한 hook script을 구성하거나, global hooks디렉토리에 hook script을 구성하여야 하는 어려움이 있는데, husky을 사용시 husky가 각 개발자의 .git/hooks 에 script연동을 proxy해주기 때문에, 손쉽에 개발팀 공통의 git hook을 설정 할 수 있습니다.</p>\n<p>참고: <a href=\"https://github.com/typicode/husky#readme\">husky</a></p>\n<p><strong>husky 설정</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// package.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"husky\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"hooks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">\"pre-commit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm test\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"pre-push\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm test\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"...\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"...\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>git hook이 지원하는 hook 명령어를 key로 하여, 해당 hook이 동작할때 구동되어야 하는 명령어를 지정하는 형태로 설정하면 됩니다.</p>\n<p>.huskyrc 파일을 사용하여서 husky 설정하는것도 가능합니다.</p>\n<p><strong>husky가 설정된 상태에서 hook 확인</strong></p>\n<ul>\n<li>.git/hooks 폴더를 확인해보면, husky.sh와 <a href=\"http://husky.local.sh\">husky.local.sh</a> 파일이 있음을 알 수 있습니다.</li>\n</ul>\n<p>pre-commit</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n<span class=\"token comment\"># husky</span>\n<span class=\"token comment\"># Created by Husky v4.2.1 (https://github.com/typicode/husky#readme)</span>\n\n<span class=\"token builtin class-name\">.</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">dirname</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span>\"</span><span class=\"token variable\">)</span></span>/husky.sh\"</span></code></pre></div>\n<p>husky.sh</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function-name function\">debug</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$HUSKY_DEBUG</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$HUSKY_DEBUG</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"husky:debug <span class=\"token variable\">$1</span>\"</span>\n  <span class=\"token keyword\">fi</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">command_exists</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin class-name\">command</span> -v <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">></span>/dev/null <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">run_command</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> command_exists <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token string\">\"<span class=\"token variable\">$@</span>\"</span> husky-run <span class=\"token variable\">$hookName</span> <span class=\"token string\">\"<span class=\"token variable\">$gitParams</span>\"</span>\n\n    <span class=\"token assign-left variable\">exitCode</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$?</span>\"</span>\n    debug <span class=\"token string\">\"<span class=\"token variable\">$*</span> husky-run exited with <span class=\"token variable\">$exitCode</span> exit code\"</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$exitCode</span> -eq <span class=\"token number\">127</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n      <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Can't find Husky, skipping <span class=\"token variable\">$hookName</span> hook\"</span>\n      <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"You can reinstall it using 'npm install husky --save-dev' or delete this hook\"</span>\n    <span class=\"token keyword\">else</span>\n      <span class=\"token builtin class-name\">exit</span> <span class=\"token variable\">$exitCode</span>\n    <span class=\"token keyword\">fi</span>\n\n  <span class=\"token keyword\">else</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Can't find <span class=\"token variable\">$1</span> in PATH: <span class=\"token environment constant\">$PATH</span>\"</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Skipping <span class=\"token variable\">$hookName</span> hook\"</span>\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">0</span>\n  <span class=\"token keyword\">fi</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">hookIsDefined</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">grep</span> -qs <span class=\"token variable\">$hookName</span> <span class=\"token punctuation\">\\</span>\n    package.json <span class=\"token punctuation\">\\</span>\n    .huskyrc <span class=\"token punctuation\">\\</span>\n    .huskyrc.json <span class=\"token punctuation\">\\</span>\n    .huskyrc.yaml <span class=\"token punctuation\">\\</span>\n    .huskyrc.yml <span class=\"token punctuation\">\\</span>\n    .huskyrc.js <span class=\"token punctuation\">\\</span>\n    husky.config.js\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token assign-left variable\">huskyVersion</span><span class=\"token operator\">=</span><span class=\"token string\">\"4.2.1\"</span>\n<span class=\"token assign-left variable\">gitParams</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$*</span>\"</span>\n<span class=\"token assign-left variable\">hookName</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">basename</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span>\"</span><span class=\"token variable\">)</span></span>\"</span>\n\ndebug <span class=\"token string\">\"husky v<span class=\"token variable\">$huskyVersion</span> - <span class=\"token variable\">$hookName</span>\"</span>\n\n<span class=\"token comment\"># Skip if HUSKY_SKIP_HOOKS is set</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$HUSKY_SKIP_HOOKS</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$HUSKY_SKIP_HOOKS</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  debug <span class=\"token string\">\"HUSKY_SKIP_HOOKS is set to <span class=\"token variable\">$HUSKY_SKIP_HOOKS</span>, skipping hook\"</span>\n  <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># Source user var and change directory</span>\n<span class=\"token builtin class-name\">.</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">dirname</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span>\"</span><span class=\"token variable\">)</span></span>/husky.local.sh\"</span>\ndebug <span class=\"token string\">\"Current working directory is <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">pwd</span><span class=\"token variable\">)</span></span>\"</span>\n\n<span class=\"token comment\"># Skip fast if hookName is not defined</span>\n<span class=\"token keyword\">if</span> <span class=\"token operator\">!</span> hookIsDefined<span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  debug <span class=\"token string\">\"<span class=\"token variable\">$hookName</span> config not found, skipping hook\"</span>\n  <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># Source user ~/.huskyrc</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -f ~/.huskyrc <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  debug <span class=\"token string\">\"source ~/.huskyrc\"</span>\n  <span class=\"token builtin class-name\">.</span> ~/.huskyrc\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># Set HUSKY_GIT_STDIN from stdin</span>\n<span class=\"token keyword\">case</span> <span class=\"token variable\">$hookName</span> <span class=\"token keyword\">in</span>\n  <span class=\"token string\">\"pre-push\"</span><span class=\"token operator\">|</span><span class=\"token string\">\"pre-receive\"</span><span class=\"token operator\">|</span><span class=\"token string\">\"post-receive\"</span><span class=\"token operator\">|</span><span class=\"token string\">\"post-rewrite\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">HUSKY_GIT_STDIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">cat</span><span class=\"token variable\">)</span></span>\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">esac</span>\n\n<span class=\"token comment\"># Windows 10, Git Bash and Yarn 1 installer</span>\n<span class=\"token keyword\">if</span> command_exists winpty <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">test</span> -t <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token builtin class-name\">exec</span> <span class=\"token operator\">&lt;</span> /dev/tty\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token comment\"># Run husky-run with the package manager used to install Husky</span>\n<span class=\"token keyword\">case</span> <span class=\"token variable\">$packageManager</span> <span class=\"token keyword\">in</span>\n  <span class=\"token string\">\"npm\"</span><span class=\"token punctuation\">)</span> run_command npx --no-install<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token string\">\"pnpm\"</span><span class=\"token punctuation\">)</span> run_command pnpx --no-install<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token string\">\"yarn\"</span><span class=\"token punctuation\">)</span> run_command <span class=\"token function\">yarn</span> run --silent<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token string\">\"*\"</span><span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Unknown package manager: <span class=\"token variable\">$packageManager</span>\"</span><span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">esac</span></code></pre></div>\n<h3 id=\"github-webhook\" style=\"position:relative;\"><a href=\"#github-webhook\" aria-label=\"github webhook permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GitHub Webhook</h3>\n<p>git hook와 개념적으로 비슷하지만 Event발생 주체와 실제 사용 및 event발생 시점이 차이가 있습니다.</p>\n<p>git hook이 보통 local에서의 git command동작에 의해서 발생하는 형태이거나, git이 구축된 서버에서 발생해주는 형태라면, github webhook은 github을 사용할때, github의 동작(e.g. fork, pull request, milestone 등등)에 의해서 발생합니다.</p>\n<p>참고: <a href=\"https://developer.github.com/webhooks/\">github webhook</a></p>\n<p>해당 기능을 응용하여, pull request 발생시, telegram등의 대화방에 알리기 등의 동작 구현이 가능합니다.</p>\n<p>보통 github 자체의 setting page에 webhook발생시 호출할 url연동하게 되어 있습니다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#git-hook\">Git Hook</a></li>\n<li><a href=\"#husky\">husky</a></li>\n<li><a href=\"#github-webhook\">GitHub Webhook</a></li>\n</ul>\n</div>","frontmatter":{"date":"March 12, 2020","title":"Git Hooks, GitHub Webhooks","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-03-12-Git-Hooks-GitHub-Webhooks/"}},"site":{"siteMetadata":{"siteUrl":"https://gseok.github.io","comments":{"utterances":{"repo":"gseok/gseok.github.com"}}}}},"pageContext":{"slug":"/tech-talk-2020/2020-03-06-Javascript-Logger/","nextSlug":"/tech-talk-2020/2020-03-01-React-Typescript-svg-import/","prevSlug":"/tech-talk-2020/2020-03-12-Git-Hooks-GitHub-Webhooks/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}