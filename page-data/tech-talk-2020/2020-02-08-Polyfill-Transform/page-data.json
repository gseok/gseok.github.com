{"componentChunkName":"component---src-templates-blog-template-js","path":"/tech-talk-2020/2020-02-08-Polyfill-Transform/","result":{"data":{"cur":{"id":"be6c2f7c-a141-5fff-91b4-ed7f0e93eac2","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>polyfill 와 transform을 이용하여 브라우저 하위환을 맞추는 방법에 대해서 간략하게 설명합니다.</p>\n<h3 id=\"브라우저-하위호환\" style=\"position:relative;\"><a href=\"#%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%ED%95%98%EC%9C%84%ED%98%B8%ED%99%98\" aria-label=\"브라우저 하위호환 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>브라우저 하위호환?</h3>\n<p>javascript 언어가 발전하고, 해당 언어가 구동되는 browser역시 발전하면서, 최신 javascript언어의 문법이 old 브라우저에서는 구동 안되는 문제가 발생하게 되었습니다. 이를 해결하여, 최신 javascript언어 &#x26; 문법을 사용해도, old 브라우저에서 구동되게 하는것이 브라우저 하위호환 입니다.</p>\n<p>old 브라우저에서 지원하지 않는 javascript사용시 아래와 같이 구문에러가 발생하게 됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhUlEQVQI15XETQ7CIBBAYe5/BncGITahs2lv4M4buDSmhNIfEZiBRjSpSd3qy5fHdnvenM6DGdq2UUrVUAOAWgOAqjoKcZBSfGxJKTnnzNBT++BiKKW8/oxdbt1V694aa3uMkWIkIkoJ10fKG0w55a+8LKwb/WgnN804O3Ke7g8MiJR/8QbpIdd28Bn1aQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"01\"\n        title=\"01\"\n        src=\"/static/f186c5acc1705d2ed9c81f5bbe822e26/37523/01.png\"\n        srcset=\"/static/f186c5acc1705d2ed9c81f5bbe822e26/e9ff0/01.png 180w,\n/static/f186c5acc1705d2ed9c81f5bbe822e26/f21e7/01.png 360w,\n/static/f186c5acc1705d2ed9c81f5bbe822e26/37523/01.png 720w,\n/static/f186c5acc1705d2ed9c81f5bbe822e26/302a4/01.png 1080w,\n/static/f186c5acc1705d2ed9c81f5bbe822e26/07a9c/01.png 1440w,\n/static/f186c5acc1705d2ed9c81f5bbe822e26/11f80/01.png 2498w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"하위호환을-하는-방법\" style=\"position:relative;\"><a href=\"#%ED%95%98%EC%9C%84%ED%98%B8%ED%99%98%EC%9D%84-%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"하위호환을 하는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>하위호환을 하는 방법</h3>\n<p>결론적으로 보면, old 브라우저에서 구동 가능한 형태로, 현재 구현되어있는 javascript을 변경(transform)해 주거나, 미지원 내장 함수에 대해서 javascript level에서 해당 함수를 직접 구현하여 넣어주는 형태(polyfill)로 가능합니다. 이밖에  실제 코드가 구동되는 run-time에 실시간으로 변경처리도 가능하지만 real(deploy)환경에서는 성능이슈등이 있음으로 추천되지 않습니다(물론 경우에 따라서 유연하게 사용가능합니다).</p>\n<h3 id=\"polyfill\" style=\"position:relative;\"><a href=\"#polyfill\" aria-label=\"polyfill permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Polyfill</h3>\n<p>old 브라우저에서 미지원되고 있는 내장 함수나 기능을 넣어주는 방식 입니다.</p>\n<p>예를들어, Object.assign 은 es6(ECMA 2015) 문법으로, 아래와 같이 <strong>IE10이하에서는 지원되지 않습니다</strong>.</p>\n<p>참고: <a href=\"https://caniuse.com/#search=object.assign\">https://caniuse.com/#search=object.assign</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/0lEQVQI1wH0AAv/ANfXsdnBnOWtnd+2qeKxouOvoOSvn96rnOLIuOPWxt3SwuTZyNrUx9rTxN/Sv9PLuuDRx+PTydfPvt/VxAB3v3lxs1qloVKkq2Oao1OgpFaZo1KUoE3W1bXmy7PUnHHouKjt18jv49Pu383y4NS5z5Kzzo7y4NXq4M8AVKdkL7BpJrBdNK1iH69ZNLFkPLVpM7VmqpV6r5dzZKxbdY1efKx9fruLf7qLgryOULBuTLFthbiJwceRAO7m0Mvdv5/TqKzWrprSpL/auezk0ebjz+3ayOncy+Dl0t/p0N7jy97hyd7iyt3iyeXjzubjzt3hyOvkysB/qGKHkfToAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"02\"\n        title=\"02\"\n        src=\"/static/a5423d30357970f9bbc077118faed18d/37523/02.png\"\n        srcset=\"/static/a5423d30357970f9bbc077118faed18d/e9ff0/02.png 180w,\n/static/a5423d30357970f9bbc077118faed18d/f21e7/02.png 360w,\n/static/a5423d30357970f9bbc077118faed18d/37523/02.png 720w,\n/static/a5423d30357970f9bbc077118faed18d/302a4/02.png 1080w,\n/static/a5423d30357970f9bbc077118faed18d/07a9c/02.png 1440w,\n/static/a5423d30357970f9bbc077118faed18d/fb371/02.png 2512w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>따라서 <strong>해당 기능(Object.assign)을 IE10 이하에서 지원하고 싶다면</strong>, ‘본인이 직접 Object.assign’을 구현하거나, 구현된 하위호환용 Object.assign을 적용해 주면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 직접 구현했다고 가정했을때..., Object.keys랑 arrow fn은 있다고 가정</span>\n\nObject<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">assign</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> newObj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> newObj<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> newObj<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> b<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> newObj<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 위 로직이 구동된 이후에 Object.assign은 구문에러가 나지 않음.</span></code></pre></div>\n<p>Polyfill의 기본 컨셉은 위와 같이 old browser에서는 browser객체(함수)로 존재하지 않는 기능을 직접 넣어줍니다.</p>\n<p>위의 예제를 보면 알겠지만 문제는, 이 직접 만든 구현체의 내용역시 old browser에서 구동되는 형태로 만들어야 하고, **해당 구현체의 로직이 탄탄해야(메모리 누수가 없고, spec을 모두 지원하고, 등등…)**합니다.</p>\n<p>실제 위 Object.assign의 polyfill을 검색해보면 아래와 같이 여러가지 polyfill구현체를 찾아 볼 수 있습니다.</p>\n<ul>\n<li>Object.assign 여러 polyfill 구현체들\n<ul>\n<li><a href=\"https://github.com/rubennorte/es6-object-assign\">https://github.com/rubennorte/es6-object-assign</a></li>\n<li><a href=\"https://github.com/christiansany/object-assign-polyfill/blob/master/index.js\">https://github.com/christiansany/object-assign-polyfill/blob/master/index.js</a></li>\n<li><a href=\"https://vanillajstoolkit.com/polyfills/objectassign/\">https://vanillajstoolkit.com/polyfills/objectassign/</a></li>\n<li><a href=\"https://github.com/zloirock/core-js/blob/master/packages/core-js/internals/object-assign.js\">https://github.com/zloirock/core-js/blob/master/packages/core-js/internals/object-assign.js</a>  (babel에서 사용)</li>\n<li>등등…</li>\n</ul>\n</li>\n</ul>\n<p>사실 여러 구현체들중 본인 기능에 문제 없이 동작한다면 어떤걸 사용해도 무방합니다. 하지만 가장 많이 사용한 어느정도 검증된 방식이 bable의 polyfill을 사용하는 방식입니다.</p>\n<h3 id=\"transform\" style=\"position:relative;\"><a href=\"#transform\" aria-label=\"transform permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Transform</h3>\n<p>old브라우저에서 미지원되고 있는 함수나 문법을 지원되는 함수나 문법으로 코드를 변경해 주는 방식입니다.</p>\n<p>polyfill와는 다르게 원본 코드자체가, old browser에서 구동되는 형태로 바꾸어서 들어가게 됩니다. 예를 들어 arrow function은 es6(ECMA 2015) 문법으로, 아래와 같이 <strong>IE11이하에서는 지원되지 않습니다</strong>.</p>\n<p>참고: <a href=\"https://caniuse.com/#feat=arrow-functions\">https://caniuse.com/#feat=arrow-functions</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVQY0z3Ly0vCcADA8f1TQZf+h27VxfBUUKRBp0T0ICaUlisQOojgIagQIcxH+Ga+8lHqptPp1LnXb+6hzojIGUQE38Pn8oWGeGmIlwYYwnRfRaqu0A2FQWUandKNOYf9xaL/BoOaNG5OQW/CtSARDQM0ypBllqpz1BtL1dkewhFZWegshLbKYSqLqXxL/T1VvjXjsbmIfwjtOcAggYjLnYzSLEpIWMjFJ8WUknhYJO+lfBzgRX5QmZBVqVej8KrQKdFojqpmxVSCwQo0lof6N+fewMVB1GKC9Qa37uRab4R3D2HdnmurmQ1UHj0xjznpc+TqkUIjUkZfginfvnM7XQ4i72Goc2n1+i07SetGyLAeO1p7PthMmE4R93HOVbp1+O9s5pDN/mS3pa7safgsDdvSbmPe6UjC9gwMzWfktzz4ZHGGqjCjynhUVujGiu9rHKHKvS+pvxJJTSQ1QGigu+QJDRArjlgCYgm6P55QGVksP4g8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"03\"\n        title=\"03\"\n        src=\"/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/37523/03.png\"\n        srcset=\"/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/e9ff0/03.png 180w,\n/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/f21e7/03.png 360w,\n/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/37523/03.png 720w,\n/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/302a4/03.png 1080w,\n/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/07a9c/03.png 1440w,\n/static/7ea2cdf68f92cf05d3cb5ed5d671d0ab/2e92a/03.png 2508w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이경우 함수 레벨이 아닌 문법 자체가 미지원되고 있기 때문에 원본 코드가 바뀌어야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 아래와 같은 코드가 있다면</span>\n<span class=\"token keyword\">const</span> gseok <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">arrowFnTest</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 변경되어서 IE11도 이해할수 있는 문법으로 코드 자체가 바뀌어야함</span>\n<span class=\"token keyword\">var</span> gseok <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">arrowFnTest</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token function\">arrowFnTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>transform의 경우, 개발자가 애시당초 old 브라우저에서 지원되는 문법으로 개발하지 않는한, <strong>수동으로 코드를 변경하기는 거의 불가능</strong>하기 때문에, <strong>보통 빌드 시점에 javascript code compiler을 통해서</strong>, 최신코드 → old 브라우저가 이해가능한 코드, 로 변환해서 적용하게 됩니다.</p>\n<p>이때 사용하게 되는 <strong>javascript code compiler가 업계 de facto인 babel</strong>이 됩니다.</p>\n<h3 id=\"how\" style=\"position:relative;\"><a href=\"#how\" aria-label=\"how permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How?</h3>\n<p>브라우저 하위 호환 개념과 두가지 방식에 대해서 알아보았습니다. 해당 방식을 실제 어떤식으로 적용해야하는지에 대해서 설명합니다.</p>\n<p>Polyfill을 직접 구현해서 넣어주거나, Transform이 불필요하게 애시당초 old 브라우저가 이해하도록 구현할 수도 있지만, 보통 최신 javascript 문법으로 프로젝트를 구현하고, 빌드 시점에 compiler을 통해서 이를 변경하는 형태를 취하게 됩니다.</p>\n<p>여기서는 거의 업계 표준(de facto)인  <strong>babel을 이용해서 polyfill 및 transform</strong>을 하는 방식을 간략하게 설명합니다.</p>\n<h3 id=\"babel-기본-개념\" style=\"position:relative;\"><a href=\"#babel-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\" aria-label=\"babel 기본 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>babel 기본 개념</strong></h3>\n<p>babel은 javascript compiler로 원본 js(or ts)을 받아서 설정된 option(빌드 config) 에 따라서 컴파일된 결과물을 생성합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// babel</span>\noriginal<span class=\"token punctuation\">.</span>js → babel → compiled<span class=\"token punctuation\">.</span>js\n\n<span class=\"token comment\">// java</span>\n<span class=\"token punctuation\">[</span>original<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>original<span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">)</span> → javac  → original<span class=\"token punctuation\">.</span>jar</code></pre></div>\n<p>보통 다른 언어의 컴파일러처럼 babel역시 <strong>cli로 컴파일을 수행 할 수 있습</strong>니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">$ npx babel a<span class=\"token punctuation\">.</span>js <span class=\"token operator\">--</span>out<span class=\"token operator\">-</span>file a<span class=\"token operator\">-</span>compiled<span class=\"token punctuation\">.</span>js <span class=\"token operator\">--</span>config<span class=\"token operator\">-</span>file babel<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>json</code></pre></div>\n<p>참고: cli <a href=\"https://babeljs.io/docs/en/babel-cli\">https://babeljs.io/docs/en/babel-cli</a></p>\n<p>참고: configfile <a href=\"https://babeljs.io/docs/en/config-files\">https://babeljs.io/docs/en/config-files</a></p>\n<h3 id=\"babel-번들러와-같이-쓰기\" style=\"position:relative;\"><a href=\"#babel-%EB%B2%88%EB%93%A4%EB%9F%AC%EC%99%80-%EA%B0%99%EC%9D%B4-%EC%93%B0%EA%B8%B0\" aria-label=\"babel 번들러와 같이 쓰기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>babel 번들러와 같이 쓰기</h3>\n<p>babel이 defacto이기 떄문에 거의 모든 번들러에서는 babel compile을 지원합니다. 여기서는 webpack 번들러를 사용했을때 babel을 적용하는 방법에 대해서 설명합니다.</p>\n<p><strong>webpack.config.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token literal-property property\">module</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">rules</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.tsx?$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'babel-loader'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">presets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                  <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">'@babel/preset-env'</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                      <span class=\"token literal-property property\">targets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                        <span class=\"token literal-property property\">browsers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'last 2 versions'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ie >= 8'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token literal-property property\">debug</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token literal-property property\">useBuiltIns</span><span class=\"token operator\">:</span> <span class=\"token string\">'usage'</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token literal-property property\">corejs</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">proposals</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token string\">'@babel/preset-react'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'ts-loader'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">configFile</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'./tsconfig.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n     <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>webpack에 babel-loader을 적용하면, cli을  통해서  compile을 하는것과 동일하게, 코드를 compile할 수 있습니다.</li>\n<li>해당 loader의 option설정은 cli을 통해서 compile할때 적용하는 babel의 config설정과 동일합니다.</li>\n</ul>\n<p><strong>@babel/preset-env?</strong></p>\n<p>polyfill이나, transform을 할때, 각각의 종류와 type이 여러개가 존재하게 됩니다. 해당 polyfill이나, transform을 하나의 set로 묶어서 제공하는게 babel의 preset-env입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// e.g) 아래와 같은 부분이 다 set으로 묶여서 같이 들어 있음!</span>\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>from<span class=\"token operator\">-</span>code<span class=\"token operator\">-</span>point\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>raw\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>code<span class=\"token operator\">-</span>point<span class=\"token operator\">-</span>at\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>ends<span class=\"token operator\">-</span><span class=\"token keyword\">with</span>\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>includes\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>starts<span class=\"token operator\">-</span><span class=\"token keyword\">with</span>\ncore<span class=\"token operator\">-</span>js<span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>match\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>match<span class=\"token operator\">-</span>all\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>repeat\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>pad<span class=\"token operator\">-</span>start\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>pad<span class=\"token operator\">-</span>end\ncore<span class=\"token operator\">-</span>js<span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>replace\ncore<span class=\"token operator\">-</span>js<span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>search\ncore<span class=\"token operator\">-</span>js<span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>split\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>trim\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>trim<span class=\"token operator\">-</span>start\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>trim<span class=\"token operator\">-</span>end\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>trim<span class=\"token operator\">-</span>left\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>trim<span class=\"token operator\">-</span>right\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>anchor\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>big\ncore<span class=\"token operator\">-</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>pure<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>es<span class=\"token operator\">|</span>stable<span class=\"token operator\">|</span>features<span class=\"token operator\">/</span>string<span class=\"token operator\">/</span>blink\n<span class=\"token operator\">...</span></code></pre></div>\n<p>babel의 예전 버전에서는, 개발자가 필요한 polyfill이나 transform을 직접 하나씩 설정하는 형태를 취했는데, babel 버전이 올라가고, corejs을 사용하면서, corejs을 활용한 형태로 변경되었습니다.</p>\n<p>참고: <a href=\"https://babeljs.io/docs/en/babel-preset-env\">https://babeljs.io/docs/en/babel-preset-env</a></p>\n<p><strong>실제 polyfill 및 transform 설정</strong></p>\n<p>useBuiltIns</p>\n<ul>\n<li>\n<p>기본값은 false입니다. ‘entry’나 ‘usage’을 사용할 수 있고, 실제 polyfill파일인 core-js을 같이 설정해주어야 합니다.</p>\n</li>\n<li>\n<p>entry</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// entry 포함방식과 동일합니다. 즉 아래 case는 모두 동일합니다.</span>\n\n<span class=\"token comment\">// 1. webpack.config.js에 entry 활용</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">entry</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'core-js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'/src/index.js'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 2. 실제 소스 코드의 entry 코드에서 import</span>\n<span class=\"token comment\">// index.js라고 가정했을때, 해당 파일 최상단에</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'core-js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 3. webpack의 bable-loader의 babel-preset-evn의 useBuiltIns 설정</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'babel-loader'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">presets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">'@babel/preset-env'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">targets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">browsers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'last 2 versions'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ie >= 8'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">debug</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">useBuiltIns</span><span class=\"token operator\">:</span> <span class=\"token string\">'entry'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">corejs</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">proposals</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'@babel/preset-react'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n</li>\n<li>\n<p>usage</p>\n<ul>\n<li>기존 entry방식은 현재 내 코드에서 필요한 polyfill이나 transform이외 불필요한 모든 polyfill와 transform이 같이 추가되는 문제가 있음.</li>\n<li>usage을 사용하면, entry포인트로부터 모든 파일을 탐색하면서 해당 파일에 필요한 polyfill와 transform을 추리고, 해당 부분을 중복되지 않게 추가해줍니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVQY0z3PXa6EIAwFYLbiDYYMaBVpEbAg/ux/TZNA7nxPp0/nVNz3/b5vrfVpUkrneXrvmfl5nre57/u6rpxzrbWUchwHM5dSRIwxpRRjJKIQgvfeGCOlHMdRSvnXDMPQ89D0LKUUpQkhMHPOWWttjFFKfT4fAFj+TU3Pxph5nqdpEn1MzpmbnDMRLcvinPPeI6JzzlqLiLYhonVd+yl+n6SUaq1EBABKKa31rxkAelXPpgEA0V9n5lorM1trexURxRh9g4ghhL4lpYSI27bt+/4F/MhJCb2yj8EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"04\"\n        title=\"04\"\n        src=\"/static/6a860db5ff63332e131216d82c3e58a0/37523/04.png\"\n        srcset=\"/static/6a860db5ff63332e131216d82c3e58a0/e9ff0/04.png 180w,\n/static/6a860db5ff63332e131216d82c3e58a0/f21e7/04.png 360w,\n/static/6a860db5ff63332e131216d82c3e58a0/37523/04.png 720w,\n/static/6a860db5ff63332e131216d82c3e58a0/cc8d6/04.png 791w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>usage와 직접 polyfill 추가 복합 사용도 가능합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// entry 파일에 import</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'core-js/es/map'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'core-js/es/set'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'core-js/es/object/assign'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// webpack에서 usage</span>\n<span class=\"token punctuation\">[</span>\n  <span class=\"token string\">'@babel/preset-env'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">targets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">browsers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'last 2 versions'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ie >= 8'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">debug</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">useBuiltIns</span><span class=\"token operator\">:</span> <span class=\"token string\">'usage'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">corejs</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">proposals</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre></div>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%ED%95%98%EC%9C%84%ED%98%B8%ED%99%98\">브라우저 하위호환?</a></li>\n<li><a href=\"#%ED%95%98%EC%9C%84%ED%98%B8%ED%99%98%EC%9D%84-%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\">하위호환을 하는 방법</a></li>\n<li><a href=\"#polyfill\">Polyfill</a></li>\n<li><a href=\"#transform\">Transform</a></li>\n<li><a href=\"#how\">How?</a></li>\n<li><a href=\"#babel-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\"><strong>babel 기본 개념</strong></a></li>\n<li><a href=\"#babel-%EB%B2%88%EB%93%A4%EB%9F%AC%EC%99%80-%EA%B0%99%EC%9D%B4-%EC%93%B0%EA%B8%B0\">babel 번들러와 같이 쓰기</a></li>\n</ul>\n</div>","excerpt":"소개 polyfill 와 transform을 이용하여 브라우저 하위환을 맞추는 방법에 대해서 간략하게 설명합니다. 브라우저 하위호환? javascript 언어가 발전하고, 해당 언어가 구동되는 browser역시 발전하면서, 최신 javascript언어의 문법이 old 브라우저에서는 구동 안되는 문제가 발생하게 되었습니다. 이를 해결하여, 최신 javascript언어 & 문법을 사용해도, old 브라우저에서 구동되게 하는것이 브라우저 하위호환 입니다. old 브라우저에서 지원하지 않는 javascript사용시 아래와 같이 구문에러가 발생하게 됩니다.  하위호환을 하는 방법 결론적으로 보면, old 브라우저에서 구동 가능한 형태로, 현재 구현되어있는 javascript을 변경(transform)해 주거나, 미지원 내장 함수에 대해서 javascript level에서 해당 함수를 직접 구현하여 넣어주는 형태(polyfill)로 가능합니다. 이밖에  실제 코드가 구동되는 run-time에…","frontmatter":{"date":"February 08, 2020","title":"Polyfill, Transform, 브라우저 하위호환 지원하기","categories":"tech-talk bundler","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-02-08-Polyfill-Transform/"}},"next":{"id":"366897ce-21b8-574c-a6bf-00144a11fcfd","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>node project을 진행중에 폴더 구조 변경 이후 아래와 같이 “breakpoint ignored” 가 발생하면서, 코드 디버깅을 IDE(vscode, intellij, 등)에서 하지 못하는 문제가 발생하였다. 하여 해당 문제의 발생 원인 및 해결 방법에 대해서 간략하게 설명한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 574px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQY02VQW26DMBDMQTD22rvrtcE86gYIFNM0Ue9/pCrNRyp1NJq/eWhORKy1BgDvOMeREH0a2veFvI8YWpJeyBijlKr/4UTEda3ROWQB36Yu5Nx5IQniY2ObgCkioyMCMPqFXzMihRhLKfvxuZbr/f51vx2367GXY9uPpZRp/5gv67Ju5/OU36d5WS6XNYRQVdWj2RiDyN5Dd+67ee/HvORxiELWJk+BsPEUGSNTIxyY2DkLoJ6ztdbWOhHo57d8fA/TOg3dNrTbmMZGhFxkFHRCTtCxswgAxtR/zZ4hJQFHWmsEbQHcI15XSr1YPVTV9fO9HziMOG4OnaB4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"01\"\n        title=\"01\"\n        src=\"/static/10f28b9b3e811ac4a0ffac68a767bc4a/86389/01.png\"\n        srcset=\"/static/10f28b9b3e811ac4a0ffac68a767bc4a/e9ff0/01.png 180w,\n/static/10f28b9b3e811ac4a0ffac68a767bc4a/f21e7/01.png 360w,\n/static/10f28b9b3e811ac4a0ffac68a767bc4a/86389/01.png 574w\"\n        sizes=\"(max-width: 574px) 100vw, 574px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"원인\" style=\"position:relative;\"><a href=\"#%EC%9B%90%EC%9D%B8\" aria-label=\"원인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>원인</h3>\n<p>해당 문제가 발생하는 이유는 ts이건 js이건 빌드 이후 생성한 debug용 “*.map” 파일에 기록되어 있는,  <strong>원본(original) 코드 위치 및 loader위치가, 실제 해당 프로젝트의 원본 코드(original code)의 위치가 맞지 않아서 발생</strong>하는 문제이다.</p>\n<p>해당 문제가 발생했을때, 상황을 좀더 빠르게 확인하려면, dubug용 빌드시 명확하게 path가 보이는 옵션으로 빌드하여 “*.map” 파일을 열어서 확인해보는게 좋다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack을 사용하는 경우 devtool 설정을 \"source-map\" 으로 한다.</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">devtool</span><span class=\"token operator\">:</span> <span class=\"token string\">\"source-map\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>문제가 발생하는 경우 예제</p>\n<ul>\n<li>원본 소스 위치: /packages/pr-server/src/routes/ping.route.ts</li>\n<li>디버그 map파일에 기록된 소스 위치: webpack:///./src/routes/ping.route.ts</li>\n<li>빌드 결과 위치\n<ul>\n<li>/dist/pr-server/server.js</li>\n<li>/dist/pr-server/server.js.map</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 569px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAm0lEQVQI1yWIaxKCIBgAvYiOPLPG8QF8gBYooqZW979OY+2PnZ1NOn1VYACgqiqMMSb0VlBGCUKYnFBCCP4lo4xgkucIIfSfCS9uZVm2bSulBABtrJF89HYM0ftBKrBd7/zQ9adBm7pu6rrh/MIYS9I0zbJMKeWcs9Yao4WQ94c7Xp/9eA8hjiGGOC/rNi/PMM1TXNZtH8MkhPgCU8IjNZBY3uoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"02\"\n        title=\"02\"\n        src=\"/static/df81f4277f98e739e23ba3f1ba5b5fa2/854dc/02.png\"\n        srcset=\"/static/df81f4277f98e739e23ba3f1ba5b5fa2/e9ff0/02.png 180w,\n/static/df81f4277f98e739e23ba3f1ba5b5fa2/f21e7/02.png 360w,\n/static/df81f4277f98e739e23ba3f1ba5b5fa2/854dc/02.png 569w\"\n        sizes=\"(max-width: 569px) 100vw, 569px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위 예제와 같은 경우 IDE(vscode, intellij, 등)에서는 map파일에 기록된 소스 위치로 원본 소스를 찾게 되는데, 실제 위치에 해당 파일이 없기 때문에 debug point가 정상 동작하지 않게 된다.</p>\n<h3 id=\"해결-방법\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"해결 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방법</h3>\n<p>원인이 명확하기 때문에 원인을 해결하면 문제를 해결 할 수 있다. 원인을 해결 하는 방법은 아래와 같이 2가지가 존재 할 수 있다.</p>\n<ol>\n<li><strong>IDE에서 map파일에 기록된 path을, 실제 original source file 위치로 다시 mapping</strong></li>\n<li><strong>build시점에 debug용 source map을 생성할때, 명확한 source path로 map파일이 생성되도록 설정</strong></li>\n</ol>\n<p>사용하고 있는 IDE와, bundler에 따라서 조금씩 방법이 다르겠지만, 핵심은 결국 위 2가지 방법으로 해결 할 수 있다. 여기서는 IDE(vscode) 인 경우와, bundler(webpack)인 경우 해결 방법에 대해서 설명한다.</p>\n<p><strong>IDE(VSCode)설정을 이용해서, debug 파일(*.map)의 path을 설정하기</strong></p>\n<p>VSCode의 경우 debug launch을 할때, “launch.json” 에 debug run configuration을 설정할 수 있다. 이때  launch.json의 “sourceMapPathOverrides” 설정을 이용해서, debug point 미스 매칭을 해결 할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// vscode의 launch.json 설정 예제</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.2.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string-property property\">\"configurations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"request\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"attach\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Attach by Process ID\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"protocol\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"inspector\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">9331</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"restart\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\n      <span class=\"token comment\">// 아래 3개의 설정을 추가해 주면 된다. 그중 핵심은 \"sourceMapPathOverrides\" 설정이다.</span>\n      <span class=\"token string-property property\">\"sourceMaps\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"trace\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"sourceMapPathOverrides\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">\"webpack:///./src/*\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"${workspaceRoot}/packages/pr-server/src/*\"</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 예제의 경우, 디버그 “*.map” 파일에 <strong>미스 매칭된 relative path을 실제 origin source code path로 설정</strong>해 주고 있다.</p>\n<p>이후 vscode에서 debug launch을 시도해보면 정상적으로 debug point가 기동됨을 확인 할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAElEQVQoz3WR246bMBRF+Y0GGwi+ge8GA8YOGaZkopGqXh7ah/7/j1Qk03baTreWZMny0j46zpZlMcYOwzinGKYw7QneD1IqY6wQYvQmpRRCMMaUqo/pNM+zEJzrLptC0MbEmGJMhNC/QAgTSrngQkrvvVbKGK21llIKIbIwDlKI8/khxrg//VPGmBRFUVWVE85xoztvwyK0scJqxrNpvXI7OOusdW/KVVXVdX3ElLXM2qZpMaWYtgzJJguPV+FGVNf/zowJZZRwusvnTX36vn3+evryQa5rfX4kaSPZ48dvejzFELQ2hFBK2WsIoVVVobqWBpk5qG7orXacNqTWDc7mtEj1or1RfhsbI6Q07c+r8nNvVDDi1GnBaJZSVFLhfam/5V/NGJOyLAnBUjFYwEP+DoD8kIPDIQcAZOu6KqXrGiGEMSb3NoTwnds9Yoxx2ja44ZQ3mAnOpGyPVZXFGM3+d6brOs45xoSxxlprjO26nrf8eDzuPqINZi1pGaZCNLt8vMneT+v6ftuuzg1KWeeGy+X56en5crmmdIYQlmUJILgDIQA5yHMAIcz6vpdSzXPatidru3mOwzDFmFJaluUhxhMAoCiKsih/cj/Koigy7z3nwloXY1JKez9Ya7XW1tpxnPre3+U38yJ7P6zr6lw3TaHv/S3DNE1CSAjh/+QfgD6NeS34jF4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"03\"\n        title=\"03\"\n        src=\"/static/2e03a630aaeb5e8ad48d1b58c9c9d55c/1bba8/03.png\"\n        srcset=\"/static/2e03a630aaeb5e8ad48d1b58c9c9d55c/e9ff0/03.png 180w,\n/static/2e03a630aaeb5e8ad48d1b58c9c9d55c/f21e7/03.png 360w,\n/static/2e03a630aaeb5e8ad48d1b58c9c9d55c/1bba8/03.png 642w\"\n        sizes=\"(max-width: 642px) 100vw, 642px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>Bundler(Webpack)설정을 변경하여, debug 파일(*.map)생성시 path을 명확하게 설정하기</strong></p>\n<p>webpack의 경우, debug 설정을 “devtool” 을 사용하게 되어 있는데, 이때 output설정에 “devtool”의 부가 설정이 가능하다.</p>\n<p>참고: <a href=\"https://webpack.js.org/configuration/output/#outputdevtoolmodulefilenametemplate\">https://webpack.js.org/configuration/output/#outputdevtoolmodulefilenametemplate</a></p>\n<p>가장 간단한 방법은 아래 예제와 같이 <strong>webpack의 output설정중 devtoolModuleFilenameTemplate 설정을 absolute path로</strong> 주는 형태이다.</p>\n<p>예제</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// webpack.config.js</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">devtool</span><span class=\"token operator\">:</span> <span class=\"token string\">\"source-map\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">output</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>rootPath<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">dist/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>packageJSON<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">filename</span><span class=\"token operator\">:</span> <span class=\"token string\">'[name].js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">chunkFilename</span><span class=\"token operator\">:</span> <span class=\"token string\">'[name].js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 아래 devtoolModuleFilenameTemplate 설정이 핵심이다.</span>\n    <span class=\"token literal-property property\">devtoolModuleFilenameTemplate</span><span class=\"token operator\">:</span> <span class=\"token string\">'[absolute-resource-path]'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 예제와 같은 형태로 build시도시 아래와 같이 absoulte path설정이 된 debug “*.map” 파일을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 663px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAt0lEQVQI1yWMy2rDMBBF/R/2pnqMXBVNpEojS5Ecx4FAoPS1Cll00///iFLpcBguXO4MKXqiGELgXEip5hkAQIL6V0IXWhZCdjkXAIqIBoNojMF2DR7Icv9qzIs2Ws0gnHO91fr5qcEYk/2fmodxHBFx27baiDHWWi+fP+vX7/7xOB7zqbE29n0vpVhrQwjW2mGaJkRMKS3LknMmolrr+fZ9fruv13fnXErJe09EpZSUc59prRljf1NELcFkOx9cAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"04\"\n        title=\"04\"\n        src=\"/static/33010dfe1e34eca985ec63b09528695a/0786c/04.png\"\n        srcset=\"/static/33010dfe1e34eca985ec63b09528695a/e9ff0/04.png 180w,\n/static/33010dfe1e34eca985ec63b09528695a/f21e7/04.png 360w,\n/static/33010dfe1e34eca985ec63b09528695a/0786c/04.png 663w\"\n        sizes=\"(max-width: 663px) 100vw, 663px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해당 설정에서 IDE의 기본설정으로 아래와 같이 break point가 정상 동작됨을 확인 할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 323px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVQozy3Q2Y7bIBQG4DxFOzEGvIDBGG+A8YLjZLJHaTuZqqNK7dz2/V+hYtr/CnH0if+wohF66k5g9zZb3dm+7/txHLXWnDPGWLt/GDtM4+B85mHwh67rpCyrqlzRJAl4g5txt3GbZZmmyTmnlEqShBAizdQqPY0+8zxba/9NGWNC5KuU0DTCk3M8F50xaUoYY1rrvu+11oyS9iPWWkJIWZaccyGEc24cxxUhFEcRyRilVAghpazrWpbS9lYrLfK8qWsh8qos/b2vWxayyBgjlHqMEIIQRlEUBEGRF4MZalkbpbVRyg7T8lw2qlams11bt6MZdKuyJKZJ/B8jjBljEEGZFef+5JpZ8kKWvJl2dn+1+6s0oygyyYql3ZS8MiU/T+ajttcoyzKMIwhBCJ5gGIAQBAEAQbBer0GwhiEIQwCCpxACCAI/CwKPQ+hxzjnGKKJF1swR11Ull42Z585aJWVJ07TWbdVvCWXpYIntUqM9lgxF2L+MEFZddvzm3Hn8+ujf3k+Xu3o81P1WORdtn7P9RW02dLoU7iLdtfJ4qyGJEc9zhOJlBm+/xOvv+fv78uPP4+Xn+OWe3m/4eFofDp8P+0+3W3w9h5cjuJzCFaUZ+KjNGEMIFwWpFC2MVtMujiORoE1THLpGyQJFMQhRCOE6hIFfHXqM/WdjKaXHIq0UrZ2bLi/T7bU/3IbjjWf0YNvFNGMjW8GPvdqauivFX3MxgXptS4I1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"05\"\n        title=\"05\"\n        src=\"/static/62a4452ff6f1f1916326bba87c4b4c8b/89aeb/05.png\"\n        srcset=\"/static/62a4452ff6f1f1916326bba87c4b4c8b/e9ff0/05.png 180w,\n/static/62a4452ff6f1f1916326bba87c4b4c8b/89aeb/05.png 323w\"\n        sizes=\"(max-width: 323px) 100vw, 323px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h3>\n<ul>\n<li>원인: debug 정보상 원본 source 에 대한 path 미스 매칭</li>\n<li>해결: path미스매칭을 맞추어 주면 됨\n<ul>\n<li>IDE의 debug run 설정에서 맞추거나</li>\n<li>Bundler에서 debug 모드 빌드시 map 파일의 path설정을 맞추어 줌</li>\n</ul>\n</li>\n<li>추가: 각 IDE와 bundler마다 설정방법이 다를수 있다. 해당 부분은 잘 찾아서 맞추어 주어야 한다. 여기서는  vscode와 webpack 사용시 해결방법에 대하여 설명하였다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#%EC%9B%90%EC%9D%B8\">원인</a></li>\n<li><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">해결 방법</a></li>\n<li><a href=\"#%EC%9A%94%EC%95%BD\">요약</a></li>\n</ul>\n</div>","frontmatter":{"date":"February 06, 2020","title":"Debug breakpoint ignored 문제 수정","categories":"tech-talk troubleshooting","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-02-06-Debug-breakpoint-ignored/"}},"prev":{"id":"6d0545e9-5ef6-5891-8792-7566fe33bd29","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>기본적인 SSR(Server Side Rendering)의 개념 이해 및 React의 SSR에 대해서 살펴보고, React에서 좀더 심화된 형태의 SSR을 지원하는 방법에 대해서 알아봅니다. 이를 통해서 직접 React SSR을 구성하거나, 이미 구성된 React SSR의 구조 및 코드 파악을 할 수 있게 합니다.</p>\n<h3 id=\"ssr-의-기본-개념\" style=\"position:relative;\"><a href=\"#ssr-%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\" aria-label=\"ssr 의 기본 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSR 의 기본 개념</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQoz42RTW7bMBCFdZfcrftcIvsuu+ohAnTbbIsiQIFGsAF7k6gOKUtMSJGcIcWfKSTWspPaQL7VYDRPj2+mIiJrbYyRiPIMzSzFwunXQpVzllKuVqvdbmetfZnRWocQAKBM/y87io0xnHNrbdd1Qoj1er3dbtu25ZzXdb3ft1rrvu+FEIjonPPeH8VKKeccETnntNYlgtZaSvk6IYUQnPPNZsMYe2YccRpOOVenmcdxVEqllIgIEYdhKDUAIOI04D0MkmL45/wuRpkmohBCERCRMQYASn397ffX+8fWuEcJ1dnFlmZKKYQQY0wpLTOfbh++3D81ElrtKrqAUopzzhjjnC+277ddduO9jzEWt7OvOObKlOdGzodt1/VD0zTDMPTiBQC995d+dObOfdchYr/fO6082BHRIcYYx3EsmQv5wJs7l9M1r+bm++p5gB5GGMPkPfvHiRRCnNcX32T23oe59XMnrz7f/fgjfzFlfKCDx+JWshyd6QOcPvVDYu89IsLMpc1dFEspu65r25YxZqw9K/4L8X+jIJD9IfUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"01\"\n        title=\"01\"\n        src=\"/static/a40f0b51003eb85b8fe62fdcda84936c/37523/01.png\"\n        srcset=\"/static/a40f0b51003eb85b8fe62fdcda84936c/e9ff0/01.png 180w,\n/static/a40f0b51003eb85b8fe62fdcda84936c/f21e7/01.png 360w,\n/static/a40f0b51003eb85b8fe62fdcda84936c/37523/01.png 720w,\n/static/a40f0b51003eb85b8fe62fdcda84936c/302a4/01.png 1080w,\n/static/a40f0b51003eb85b8fe62fdcda84936c/07a9c/01.png 1440w,\n/static/a40f0b51003eb85b8fe62fdcda84936c/de9fe/01.png 2146w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>기본적으로  SSR은 서버 연산을 통해서 Page(HTML)을 만들고, 해당 Page을 응답(response)하여서 그리는 형태입니다. 사실 static한 html을 응답하여서 화면이 그려지는 page는 SSR을 하였다고 봐도 크게 다르지 않습니다.</li>\n<li>쉽게 이해하자면, React나 Vue등을 사용하여 Render하는 경우를 떠올리면 됩니다. 이 경우 아래와 같이 Render를 호출하여 그리게 되는데, 위 그림과 같이 사용자가 실제 화면(Content)을 보기까지 SSR에 비해서 시간이 좀 더 걸리게 됩니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">ReactDOM.render(<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>App</span><span class=\"token punctuation\">></span></span>, document.getElementById('root'));</code></pre></div>\n<p>보통 SSR의 장단점은 아래와 같습니다.</p>\n<p><strong>SSR 장점</strong></p>\n<ul>\n<li>SEO(Search Engine Optimization, 검색 엔진 최적화)</li>\n<li>빠르게 사용자에게 기본적인 화면을 보여 줄 수 있다.</li>\n</ul>\n<p><strong>SSR 단점</strong></p>\n<ul>\n<li>화면 이동시 화면 깜빡임(UX)\n<ul>\n<li>각 라우팅 별로 실제 서버와의 통신을 통해서 Page가 서빙 되기 때문에 발생합니다.</li>\n</ul>\n</li>\n<li>프로젝트 구성이 복잡해진다.\n<ul>\n<li>먼저 서버 코드에 있어서도 JSX를 사용할 수 있도록 빌드나 변환하는 과정이 필요</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"react가-제공하는-ssr\" style=\"position:relative;\"><a href=\"#react%EA%B0%80-%EC%A0%9C%EA%B3%B5%ED%95%98%EB%8A%94-ssr\" aria-label=\"react가 제공하는 ssr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React가 제공하는 SSR</h3>\n<p>React 공식 문서를 살펴보면, SSR기능을 제공하기 위해서 React는 SSR전용 Render함수들을 제공합니다.</p>\n<p>참고: <a href=\"https://reactjs.org/docs/react-dom-server.html\">https://reactjs.org/docs/react-dom-server.html</a></p>\n<p>간략하게 살펴보면 다음과 같습니다.</p>\n<ul>\n<li>\n<p>ReactDOMServer.renderToString(element)</p>\n<ul>\n<li>HTML string을 리턴 합니다. 사용자에게 빠르게 초기 화면 응답을 줄 수 있습니다.</li>\n<li>ReactDOM.hydrate() 함수를 동일 element에 대해서 client에서 호출한 경우, 이미 그려진 dom을 그대로 사용하면서, event handler만 추가해 줍니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 개념 이해를 위한 코드 입니다.</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Home</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    Home View !!!!@@@\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">to</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>RoutesPath<span class=\"token punctuation\">.</span>Search<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Go Search</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 위와 같은 Home React Component을 호출하면?</span>\n<span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>Home<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// html은 아래와 같이 설정됩니다.</span>\n<span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span>\n<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>\n    Home View !!!!@@@\n    &lt;li>\n      &lt;Link to={RoutesPath.Search}>Go Search&lt;/Link>\n    &lt;/li>\n&lt;/div></span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n</li>\n<li>\n<p>ReactDOMServer.renderToStaticMarkup(element)</p>\n<ul>\n<li>renderToString 와 동일하게 동작하지만, React가 내부적으로 사용하는 extra DOM attributes을 생성하지 않습니다. (e.g. data-reactroot)</li>\n<li>React을 static page처럼 사용할때 유용하지만, interactive한 page을 만들때는 사용하지 말아야 합니다.</li>\n</ul>\n</li>\n<li>\n<p>ReactDOMServer.renderToNodeStream(element)</p>\n<ul>\n<li>renderToString 와 동일하지만, 차이점이 있다면, HTML을 stream형태로 만들어 줍니다.</li>\n<li>공식 문서상 해당 stream은 renderToString이 생성하는 결과와 완벽하게 일치합니다.\n<ul>\n<li>The HTML output by this stream is exactly equal to what ReactDOMServer.renderToString would return.</li>\n</ul>\n</li>\n<li>리턴하는 stream은  utf-8 포멧으로 encoding되어 있습니다. 만약 다른 형태의 encoding을 사용하려면 별도의 encode, decode 라이브러리를 사용해야 합니다.</li>\n</ul>\n</li>\n<li>\n<p>ReactDOMServer.renderToStaticNodeStream(element)</p>\n<ul>\n<li>renderToStaticMarkup의 stream버전입니다.</li>\n</ul>\n</li>\n</ul>\n<p>위 함수들은 모두 Server에서 구동해야 합니다. 서버에서 구동해서 HTML을 받아서 response하는 형태 입니다.</p>\n<p>React에서는 기본적으로 위와 같이 SSR을 지원해주는 함수들을 제공 하고 있습니다. React는 Javascript Lib이기 때문에 보통 이러한 함수를 Server에서 구동 시에는 Node.js 서버를 통해서 구동하게 됩니다.</p>\n<p>SSR이 string 형태와 stream형태로 나누어 진다는 사실을 알 수 있습니다. 작은 크기의 html인 경우는 큰 차이가 없거나 string형태가 더 빠른 경우가 있지만, 어느정도 size가 큰 경우, stream 형태는 말 그대로 html stream을 response하기 때문에 성능 상 좀 더 빠른 이점이 있습니다.</p>\n<h3 id=\"react-ssr에서-code-split--code-lazy-loading하기\" style=\"position:relative;\"><a href=\"#react-ssr%EC%97%90%EC%84%9C-code-split--code-lazy-loading%ED%95%98%EA%B8%B0\" aria-label=\"react ssr에서 code split  code lazy loading하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React SSR에서 Code Split &#x26; Code Lazy Loading하기</h3>\n<p>React가 기본적으로 SSR을 지원하지만, Code Split이나 Code Lazy Loading등을 SSR에서 잘 지원하지 못해서, 해당 기능을 제공하는 별도의 Lib을 사용하는 것이 좋습니다. <strong>@loadable/component</strong> 는 React SSR + Code Split + Lazy Loading을 지원하는 대표적인 Lib중 하나입니다.</p>\n<p><strong>@loadable/component 소개</strong></p>\n<ul>\n<li>참고: <a href=\"https://loadable-components.com/docs/getting-started/\">https://loadable-components.com/docs/getting-started/</a></li>\n<li>loadable/component는 사실 SSR에 앞서, Code Split와 Lazy Loading을 지원하기 위해 나왔습니다. 따라서 굳이 SSR을 하지 않더라도, 사용성 높은 Lib입니다.</li>\n<li>추가적으로 React가 제공하는 기본 lazy보다 SSR및 Lazy Loading시 더 좋은 기능을 제공하고 있습니다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArklEQVQI1y2PSW4FIQwFH2ZosJn5MeRHver73zGDUstalFQAICK9dyICcPlr9JlzTsyllMTcex9jzDGc97W1FGNKqZQiIrDWrrVU1ZABUHa9n7uP+eL8Km1Lee+te39srVd83l+l1SyiqnNOnHNUlZljisEEfsQtB2C0cAUze/DuNwogi6tiAZh/Aay15h/77Co17uibJ5jwmWx14U6WHRkikF8hnEgwZMla+7P5DVA4Cj9CWsAQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"02\"\n        title=\"02\"\n        src=\"/static/d623665382a866db710c790a59a8ed9f/37523/02.png\"\n        srcset=\"/static/d623665382a866db710c790a59a8ed9f/e9ff0/02.png 180w,\n/static/d623665382a866db710c790a59a8ed9f/f21e7/02.png 360w,\n/static/d623665382a866db710c790a59a8ed9f/37523/02.png 720w,\n/static/d623665382a866db710c790a59a8ed9f/302a4/02.png 1080w,\n/static/d623665382a866db710c790a59a8ed9f/07a9c/02.png 1440w,\n/static/d623665382a866db710c790a59a8ed9f/a8a6f/02.png 1516w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>또한 webpack 와 babel에 호환성이 높아 해당 형태의 프로젝트 구성을 쉽게 할 수 있습니다.</li>\n</ul>\n<p><strong>@loadable/component 로 React SSR하기</strong></p>\n<ul>\n<li>React SSR을 구현하는 코드로 설명합니다.</li>\n</ul>\n<p>Client Code</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> loadableReady <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@loadable/component'</span>\n<span class=\"token function\">loadableReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">hydrate</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> root<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>loadable component는 기본적으로 script을 async하게 load하고 동시에 필요한 script을 parallel하게 로딩 합니다. 따라서 해당 script의 사용가능(ready)을 체크하고 사용하도록 하고 있습니다.</li>\n</ul>\n<p>Webpack Config (client code)</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> LoadablePlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@loadable/webpack-plugin'</span><span class=\"token punctuation\">)</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">LoadablePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>LoadablePlugin을 필수로 추가해 주어야 합니다. 해당 plugin은 Server에서 사용하게 되는, loadable-stats.json 파일을 생성합니다.</li>\n<li>loadable-stats.json 파일은 클라이언트 build시 Code Split 되어지는 Component의 Chunk 관련 ‘이름’, ‘위치’, ‘크기’ 등의 정보를 가지게 됩니다.</li>\n</ul>\n<p>Babel Config</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string-property property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"@loadable/babel-plugin\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>babel 변경시 정보를 추가하거나, 기존 정보가 누락되지 않도록 해당 플러그인을 추가 해줍니다.</li>\n</ul>\n<p>Server (Node) - Normal(String)</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ChunkExtractor <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@loadable/server'</span>\n\n<span class=\"token comment\">// This is the stats file generated by webpack loadable plugin</span>\n<span class=\"token keyword\">const</span> statsFile <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../dist/loadable-stats.json'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// We create an extractor from the statsFile</span>\n<span class=\"token keyword\">const</span> extractor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChunkExtractor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> statsFile <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Wrap your application using \"collectChunks\"</span>\n<span class=\"token keyword\">const</span> jsx <span class=\"token operator\">=</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">collectChunks</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">YourApp</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Render your application</span>\n<span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>jsx<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// You can now collect your script tags</span>\n<span class=\"token keyword\">const</span> scriptTags <span class=\"token operator\">=</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getScriptTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// or extractor.getScriptElements();</span>\n<span class=\"token comment\">// You can also collect your \"preload/prefetch\" links</span>\n<span class=\"token keyword\">const</span> linkTags <span class=\"token operator\">=</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getLinkTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// or extractor.getLinkElements();</span>\n<span class=\"token comment\">// And you can even collect your style tags (if you use \"mini-css-extract-plugin\")</span>\n<span class=\"token keyword\">const</span> styleTags <span class=\"token operator\">=</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getStyleTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// or extractor.getStyleElements();</span>\n\n<span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;html>\n  &lt;head></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>linkTags<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/head>\n  &lt;body>\n    &lt;div id=\"root\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>html<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/div>\n  &lt;/body>\n&lt;/html></span><span class=\"token template-punctuation string\">`</span></span>\n\nres<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>loadable-stats.json 파일을 사용해서 서버에서 필요한 component을 extract합니다.</li>\n<li>extract한 파일을 이용하여, ReactDOMServer의 SSR함수를 통해서 html을 생성합니다.</li>\n<li>추가로, prefetch, style, SSR이후 Client Render(interactive page)을 위한 파일을 얻을 수 있습니다.</li>\n<li>마지막으로 FULL HTML을 생성하여 response합니다.</li>\n</ul>\n<p>Server (Node) - Stream</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> renderToNodeStream <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/server'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ChunkExtractor <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@loadable/server'</span>\n<span class=\"token comment\">// if you're using express.js, you'd have access to the response object \"res\"</span>\n<span class=\"token comment\">// typically you'd want to write some preliminary HTML, since React doesn't handle this</span>\nres<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;html>&lt;head>&lt;title>Test&lt;/title>&lt;/head>&lt;body>'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> statsFile <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../dist/loadable-stats.json'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> chunkExtractor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChunkExtractor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> statsFile <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> jsx <span class=\"token operator\">=</span> chunkExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">collectChunks</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">YourApp</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToNodeStream</span><span class=\"token punctuation\">(</span>jsx<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// you'd then pipe the stream into the response object until it's done</span>\nstream<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">end</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// and finalize the response with closing HTML</span>\nstream<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chunkExtractor<span class=\"token punctuation\">.</span><span class=\"token function\">getScriptTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/body>&lt;/html></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>stream형태의 경우 string형태와 조금 다르게 구동됩니다.</li>\n<li>stream의 경우, React의 SSR 함수를 통해서 얻은 stream객체를 통해서 response을 수행합니다.</li>\n<li>string형태와 동일하게 stream 완료  시점(stream.on(‘end’))에 script tag을 추가하여, SSR이후 Client Render(interactive page)을 구현 할 수 있습니다.</li>\n</ul>\n<p>Streaming rendering 의 경우  prefetch <link> 은 지원하지 않습니다.</p>\n<h3 id=\"react-module-style-and-ssr\" style=\"position:relative;\"><a href=\"#react-module-style-and-ssr\" aria-label=\"react module style and ssr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React Module Style And SSR</h3>\n<p><strong>Module Style 이란?</strong></p>\n<p>참고: <a href=\"https://create-react-app.dev/docs/adding-a-stylesheet\">https://create-react-app.dev/docs/adding-a-stylesheet</a></p>\n<p>일반적으로 style(css)은 js코드와 별개로 html상에서 loading됩니다. module style은 이와 달리, js파일에서 style을 load 하고 해당 style을  bind(사용)하는 형태의 코드를 말합니다.</p>\n<p>Button.css</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.Button</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 20px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Button.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./Button.css'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Tell webpack that Button.js uses these styles</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Button</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// You can use them as regular CSS styles</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Button<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>module style이 react에서 공식적으로 말하는 표준이나, 권장사항은 아닙니다. 하지만 많은 개발자들이 해당 형태의 구현의 편의성과 유용성 때문에 module style의 구현을 많이 사용하는 편입니다.</p>\n<p>참고: <a href=\"https://medium.com/seek-blog/block-element-modifying-your-javascript-components-d7f99fcab52b\">https://medium.com/seek-blog/block-element-modifying-your-javascript-components-d7f99fcab52b</a></p>\n<p><strong>Module Style의 구동</strong></p>\n<p>module style은 사실 실제 module은 아니고 사실은 css text입니다. 따라서, css text가 module처럼 동작하게 하는 부분이 필요합니다. 해당 부분은 보통 webpack와 같은 bundler(compiler)에서 인식하여, module 형태로 만들어 줍니다.</p>\n<p>webpack.config</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">test</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.module\\.(scss|sass)$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">use</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>target <span class=\"token operator\">===</span> <span class=\"token string\">'web'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token comment\">// to inject the result into the DOM as a style block</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'style-loader'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n\t\t\t<span class=\"token comment\">// extract style(css) file</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> MiniCssExtractPlugin<span class=\"token punctuation\">.</span>loader<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">loader</span><span class=\"token operator\">:</span> <span class=\"token string\">'css-loader'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">importLoaders</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">modules</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>webpack에서, js코드 내부에 module style import구문이 존재하는경우, 해당 구문을 어떻게 처리해야 할지 module rules에 정의 할 수 있습니다.</p>\n<p>module style을 사용했을때, ‘style-loader’을 사용시, style 태그가 해당 js사용시  document.head.appendChild 형태로 동적으로 추가되게 됩니다.</p>\n<p><strong>Module Style SSR에서의 문제점 및 해결법</strong></p>\n<p>module style을 사용할때, SSR에서는 server side 는 node환경이고, 이때는 document 객체(host 객체)가 존재하지 않기때문에 syntax에러가 발생하게 됩니다.</p>\n<p>따라서, module style을 사용하고, SSR을 사용하는 경우, 이러한 문제를 해결하기 위해서는 server render용 module style 처리와 client render용 module style처리를 분리하거나, 또는 항상 css을 extract하는 처리가 필요합니다.</p>\n<ul>\n<li>style 처리를 분리하는 경우, target node 형태의 webpack bundle 파일에서는 style import가 제외되고, targer web 형태의 webpack bundle 파일에서는 style-loader에 의해서 동적으로 style을 추가 하게 됩니다.</li>\n<li>항상 css exteact하는 경우, js에 의해서 동적으로 style이 추가되지 않기 때문에  SSR시 style tag을 넣어주고, 해당 style 요청에 의해서 style이 load되도록 해주는 처리가 필요합니다. React의 SSR을 @loadable/component 형태로 구성하는 경우 style tags얻을 수 있기 때문에 SSR시 손쉽게 style을 넣어 줄 수 있습니다.</li>\n</ul>\n<p>module style 와  styled component는 약간 내용이 다릅니다. styled component는 module style 개념을 도입하여 style을 component화 하고, 해당 component을 통해서, style을 적용하는 방법입니다. 따라서 styled component는 별개의 모듈(dependency)을 node_modules에 설치해야 하고, 일종의 HoC(high order component)나 context(provider)처럼, style을 적용하려는 component을 감싸는 형태의 구현이 필요합니다.</p>\n<p>참고: styled component: <a href=\"https://styled-components.com/docs/basics#motivation\">https://styled-components.com/docs/basics#motivation</a></p>\n<h3 id=\"react-router-and-ssr\" style=\"position:relative;\"><a href=\"#react-router-and-ssr\" aria-label=\"react router and ssr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React Router And SSR</h3>\n<p>참고: <a href=\"https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/server-rendering.md\">https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/server-rendering.md</a></p>\n<p>일반적으로 React Router을 사용하는 경우와 달리 SSR을 사용하는 경우, StaticRouter을 사용해야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// client</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BrowserRouter</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">BrowserRouter</span></span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token comment\">// server (not the complete story)</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StaticRouter</span></span>\n  <span class=\"token attr-name\">location</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">}</span></span>\n  <span class=\"token attr-name\">context</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span></span>\n<span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StaticRouter</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>이는 동일 코드에 대해서, server용 client용 entry을 별개로 가져가거나, SSR시 staticRouter을 직접적으로 사용해야함을 의미 합니다. 따라서 webpack config 와 ssr(server code) 설정을 통해서 React Router사용시 SSR을 정상적으로 지원 가능하도록 코드를 구성해야 합니다.</p>\n<h3 id=\"기타\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%ED%83%80\" aria-label=\"기타 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기타</h3>\n<ul>\n<li>Next.js등을 사용하는 경우 client side render와 server side render을 코드에서 구분 가능합니다. 어떻게 가능할까요?\n<ul>\n<li>실제 React에서 Render의 Start Point는 React가 제공하는 Render함수를 호출하면서 시작됩니다. 즉 ReactDOM.render(), ReactDOM.hydrate(), ReactDOMServer.renderToString(), ReactDOMServer.renderToNodeStream() 을 통해서, 구분이 가능합니다.</li>\n<li>실제 Component의 props으로의 구분의 경우, <strong>INITIAL_DATA</strong> ****나 props을 통해 ****data을 props 으로 넘겨서 clinet에서 그려진(호출된) render인지, server에서 그려진(호출된) render인지를 구별 할 수 있습니다.</li>\n</ul>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#ssr-%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90\">SSR 의 기본 개념</a></li>\n<li><a href=\"#react%EA%B0%80-%EC%A0%9C%EA%B3%B5%ED%95%98%EB%8A%94-ssr\">React가 제공하는 SSR</a></li>\n<li><a href=\"#react-ssr%EC%97%90%EC%84%9C-code-split--code-lazy-loading%ED%95%98%EA%B8%B0\">React SSR에서 Code Split &#x26; Code Lazy Loading하기</a></li>\n<li><a href=\"#react-module-style-and-ssr\">React Module Style And SSR</a></li>\n<li><a href=\"#react-router-and-ssr\">React Router And SSR</a></li>\n<li><a href=\"#%EA%B8%B0%ED%83%80\">기타</a></li>\n</ul>\n</div>","frontmatter":{"date":"February 17, 2020","title":"React SSR","categories":"tech-talk react","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-02-17-React-SSR/"}},"site":{"siteMetadata":{"siteUrl":"https://gseok.github.io","comments":{"utterances":{"repo":"gseok/gseok.github.com"}}}}},"pageContext":{"slug":"/tech-talk-2020/2020-02-08-Polyfill-Transform/","nextSlug":"/tech-talk-2020/2020-02-06-Debug-breakpoint-ignored/","prevSlug":"/tech-talk-2020/2020-02-17-React-SSR/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}