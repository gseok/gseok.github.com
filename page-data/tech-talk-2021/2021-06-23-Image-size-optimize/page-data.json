{"componentChunkName":"component---src-templates-blog-template-js","path":"/tech-talk-2021/2021-06-23-Image-size-optimize/","result":{"data":{"cur":{"id":"80320388-b39b-54a0-b87b-f25a973826a7","html":"<h3 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h3>\n<p>web환경에서 resource의 용량은 성능에 매우 큰 영향을 준다. 따라서 여러가지 기법을 이용해서 이를 해결하게 된다. 이런 기법에는 splite image사용, resource cache, device rosolution에 따른 resource 서빙, image crop, image reszie 등등이 있다. 실제 매우 많은 사람이 사용하는 포털 서비스에서도 이러한 기법을 사용한다.</p>\n<p><strong>실제 포털에서의 예(다음카카오)</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVQI1x3B626CMBgAUF5iURaGNO330RtVpFgJF5k4HG4ZZsuWmPCHV5kvvmTneJzH4VPgLxdBEDz8Q0QAkFIJkTDggBxQYCyEMkIZpQ2giLniQnshjaPYENSLx/Dy9j5NE2OMUlqW5bE7VVWtpEQAIcR2m6Vp2rbP/Xlwbp/nuQdcy3VusiIkbJ7n+/2XEEIpraqy64e2O2e7PZdKmU1q3SbLD8eXy/jlysa6wouiFaUkWoW+v0REay1jAIymrtq93uzpO2nGpP7Q9SjrUTfXvP8phtu6/dSH6x9JBS6bDOyAXQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"01\"\n        title=\"01\"\n        src=\"/static/288cd7314526b69b989259fb13e64f9b/37523/01.png\"\n        srcset=\"/static/288cd7314526b69b989259fb13e64f9b/e9ff0/01.png 180w,\n/static/288cd7314526b69b989259fb13e64f9b/f21e7/01.png 360w,\n/static/288cd7314526b69b989259fb13e64f9b/37523/01.png 720w,\n/static/288cd7314526b69b989259fb13e64f9b/302a4/01.png 1080w,\n/static/288cd7314526b69b989259fb13e64f9b/07a9c/01.png 1440w,\n/static/288cd7314526b69b989259fb13e64f9b/3c1e5/01.png 2854w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>실제 서비스되는 이미지의 용량: 12.4kB</p>\n</li>\n<li>\n<p>주소:</p>\n<ul>\n<li><a href=\"https://search1.daumcdn.net/thumb/C200x278.fwebp.q85/?fname=http%3A%2F%2Ft1.daumcdn.net%2Fbrunch%2Fservice%2Fuser%2F3jtQ%2Fimage%2FCXQeP3cgNqaOGX9_Dx7a9mlt41U.png\">https://search1.daumcdn.net/thumb/C200x278.fwebp.q85/?fname=http%3A%2F%2Ft1.daumcdn.net%2Fbrunch%2Fservice%2Fuser%2F3jtQ%2Fimage%2FCXQeP3cgNqaOGX9_Dx7a9mlt41U.png</a></li>\n</ul>\n</li>\n<li>\n<p>주소를 잘 보면 여러 정보를 볼 수 있다</p>\n<ul>\n<li><code class=\"language-text\">200x278</code>크기로 crop</li>\n<li>quality: 85%</li>\n<li>원본 이미지 주소: <a href=\"http://t1.daumcdn.net/brunch/service/user/3jtQ/image/CXQeP3cgNqaOGX9_Dx7a9mlt41U.png\">http://t1.daumcdn.net/brunch/service/user/3jtQ/image/CXQeP3cgNqaOGX9_Dx7a9mlt41U.png</a></li>\n<li>실제 원본 이미지의 경우 아래와 같이 192kB 임을 볼 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVQI12M4fvzopUuXrl27un//vn379h47dtTAwEBJScHS0srJ2c3cwsrcwsrUzMLQ2MTSytrK2tbewcnUzNzQyNjG1p7hyZNHmzZtOHBg/6JFCyZPnrR+/Vp9fT0lJUUzc3NLSxsNDS11DU11DU0NTS0dXT09fUMDQ2MdXT11DQ1jY1OG7u6u8vLSuLjYtrbWurratLRUXV0dNTVVFRVVOXkleQVlGFJRUIQwlOTklRUUVeTklRh6eroXL15UU1NVV1fb19fb0tKsp6enqqqipqauqKSqoKgCR4pKEFIVxlUFAMlbSI13qfNnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"02\"\n        title=\"02\"\n        src=\"/static/e880fa9bac41ebf97cd6c139eb141379/37523/02.png\"\n        srcset=\"/static/e880fa9bac41ebf97cd6c139eb141379/e9ff0/02.png 180w,\n/static/e880fa9bac41ebf97cd6c139eb141379/f21e7/02.png 360w,\n/static/e880fa9bac41ebf97cd6c139eb141379/37523/02.png 720w,\n/static/e880fa9bac41ebf97cd6c139eb141379/302a4/02.png 1080w,\n/static/e880fa9bac41ebf97cd6c139eb141379/07a9c/02.png 1440w,\n/static/e880fa9bac41ebf97cd6c139eb141379/01744/02.png 2830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>정리하면, 원본 192kB → 이미지 최적화 + 이미지 crop → 12.kB로 사용됨을 알 수 있다.</p>\n</li>\n</ul>\n<p>실제 포털에서의 예(네이버)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeUlEQVQI1wXB7Q6CIBQAUF/FBv2sDSvDBO5FMT5ELJxzvkabz985hem9i/ntE2J3HD8ffFmeKCXokp52CCvGTYWVm/n6Guou6bj1817r6Y5joQAloEItBPAnr1hF6ZkSwsEIt7T229rcmM9Dx0sz3CAIl5VfmLRMuj+Y0h8JdxluuwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"03\"\n        title=\"03\"\n        src=\"/static/cd07d3751d4bda2f97cdcfc93587e477/37523/03.png\"\n        srcset=\"/static/cd07d3751d4bda2f97cdcfc93587e477/e9ff0/03.png 180w,\n/static/cd07d3751d4bda2f97cdcfc93587e477/f21e7/03.png 360w,\n/static/cd07d3751d4bda2f97cdcfc93587e477/37523/03.png 720w,\n/static/cd07d3751d4bda2f97cdcfc93587e477/302a4/03.png 1080w,\n/static/cd07d3751d4bda2f97cdcfc93587e477/07a9c/03.png 1440w,\n/static/cd07d3751d4bda2f97cdcfc93587e477/78302/03.png 2798w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>실제 서비스되는 이미지의 용량: 18.8kB</p>\n</li>\n<li>\n<p>주소:</p>\n<ul>\n<li><a href=\"https://search.pstatic.net/common/?autoRotate=true&#x26;quality=95&#x26;type=f174_174&#x26;src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20150831_267%2F1441008970338JWBLo_JPEG%2F11630456_0.jpg\">https://search.pstatic.net/common/?autoRotate=true&#x26;quality=95&#x26;type=f174_174&#x26;src=https%3A%2F%2Fldb-phinf.pstatic.net%2F20150831_267%2F1441008970338JWBLo_JPEG%2F11630456_0.jpg</a></li>\n</ul>\n</li>\n<li>\n<p>주소로 알 수 있는 정보</p>\n<ul>\n<li><code class=\"language-text\">174_174</code> 크기로 crop</li>\n<li>quality: 95%</li>\n<li>원본 이미지 주소: <a href=\"https://ldb-phinf.pstatic.net/20150831_267/1441008970338JWBLo_JPEG/11630456_0.jpg\">https://ldb-phinf.pstatic.net/20150831_267/1441008970338JWBLo_JPEG/11630456_0.jpg</a></li>\n<li>실제 원본 이미지의 경우 아래와 같이 184kB임을 볼 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVQY02O4+ujtyRvPD195sv303d0XnyfnlsnJyqirqVo4+Zh6ROs6hGjaBWvaBWvYBhk4hxu5RZp6RBu5RqnbBOk4hjHs2L5x88YVq9etXr129eEjh9MzMmRlZTU01NW09JW1TZS1jBU1jZCQoZKmoaKGIYitYchQV11SmJ/R2V7XVFfcVJ3r6+WsqKikrq6urKQiL68oL6+ogIwUFBUVEGyGvXsWz5gzOTIu3snDszAr2sneQklJGaRZRU1BUQUTKSoh2AyJ8X6RrhaGJuZREQHZqeG2VmbKyipEagYAncpP324G8d0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"04\"\n        title=\"04\"\n        src=\"/static/bd75fd5d1915b8e6356b309eaedd0c40/37523/04.png\"\n        srcset=\"/static/bd75fd5d1915b8e6356b309eaedd0c40/e9ff0/04.png 180w,\n/static/bd75fd5d1915b8e6356b309eaedd0c40/f21e7/04.png 360w,\n/static/bd75fd5d1915b8e6356b309eaedd0c40/37523/04.png 720w,\n/static/bd75fd5d1915b8e6356b309eaedd0c40/302a4/04.png 1080w,\n/static/bd75fd5d1915b8e6356b309eaedd0c40/07a9c/04.png 1440w,\n/static/bd75fd5d1915b8e6356b309eaedd0c40/01744/04.png 2830w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n<li>\n<p>정리하면, 원본 184kB → 이미지 최적화 + 이미지 crop → 18.8kB로 사용됨을 알 수 있다.</p>\n</li>\n</ul>\n<p>대형 포탈이 아닌 개인이 서비스(블로그 등) 할때, 위의 예와 같은 처리를 하려면, 이미지 캐시 서버 혹은 이미지 처리 서버를 직접 구현하여야 한다. 하지만 개인 서비스에서 이런 추가 서비스를 별개로 구현하기는 쉽지 않다. 따라서 이러한 이미지 처리 서버 서비스를 이용해야한다. 본 글에서는, 이러한 이미지 최적화 처리를 개인이 쉽게 할 수 있는, <a href=\"https://tinypng.com/\">TinyPNG</a> 서비스를 소개한다.</p>\n<h3 id=\"tinypng\" style=\"position:relative;\"><a href=\"#tinypng\" aria-label=\"tinypng permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TinyPNG</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtklEQVQY0wGrAVT+APT6/e309ujy9uLt8dfk6dfk6dXj6OHq7vH19/H1+PL2+e/09/D19/H19+3z9fH2+vX5/ZGkbISVZ6KyigDT1NT9/f3e39/t8PHy+Pnm7fHf6u7n7/Pv8/bm7O7n7vHs8vbp8PTq8PXY4tXY4tbh6uuEmll/k1ewwJYAwsHBqqajvLu69ff59fn77PL06fDz4uzv4Ortsrm+xczQ6PDz4+zv6PH209/asLyl4ebmq7KmXGNegot/AI2Li29rY31/cJicne/19uvx9OPq7tPa3tLa3c3V2c3U2M3V2dff4ujw9dfi2tnh3ODk5amwpmJqYJignQBpZ2Xb2deko59OUEnW4NTq8PTp7/Hp7/Hn7e/n7vDn7fDn7fDq8fPp8PHl7ezw9/nQ2cyMn2aTp2q7yakAXltd6OTk0MvLoaGj4eTn////+fv98fP87/L68/T/5vDjxd6i4O7T/////P38////3+bVgZdVi55jxM+zAC8zHEZGNUpNPikoFJaagtznxsnUq8rVr8vWrsjUq8XTo7THh8HQns/as8nVqtTdurvJlHGKNHuRQrLCiFaVSu21oeh/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"05\"\n        title=\"05\"\n        src=\"/static/e10d9b280eb9e1a5131793445ed39c2d/37523/05.png\"\n        srcset=\"/static/e10d9b280eb9e1a5131793445ed39c2d/e9ff0/05.png 180w,\n/static/e10d9b280eb9e1a5131793445ed39c2d/f21e7/05.png 360w,\n/static/e10d9b280eb9e1a5131793445ed39c2d/37523/05.png 720w,\n/static/e10d9b280eb9e1a5131793445ed39c2d/302a4/05.png 1080w,\n/static/e10d9b280eb9e1a5131793445ed39c2d/07a9c/05.png 1440w,\n/static/e10d9b280eb9e1a5131793445ed39c2d/565cc/05.png 1806w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>앞선 소개에서 이야기한 기능을 제공하는 서비스이다.</li>\n<li>기본적으로 web상에서 drag and drop 으로 쉽게 이미지를 최적화 할 수 있다</li>\n<li>기술적으로는 png, jpg(파일의) 불필요한 meta을 제거하고, 24bit png file을 8bit indexed color형태로 변환한다고 되어 있다. (This technique is called “quantization”. By reducing the number of colors, 24-bit PNG files can be converted to much smaller 8-bit indexed color images.)</li>\n</ul>\n<h3 id=\"cdn기능\" style=\"position:relative;\"><a href=\"#cdn%EA%B8%B0%EB%8A%A5\" aria-label=\"cdn기능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CDN기능</h3>\n<ul>\n<li><a href=\"https://tinify.com/cdn/documentation#configuration\">https://tinify.com/cdn/documentation#configuration</a></li>\n<li>web에서 직접 변환와 다르게 위 포탈의 형태와 비슷하게, image을 cdn형태로 서빙해주는 서비스 이다.\n<ul>\n<li>맨 앞의 소개쪽의 다음, 네이버 등의 포탈이 제공하는 이미지 서버(CDN server)형태와 동일한 형태.</li>\n</ul>\n</li>\n<li>현재(2021.06) beta서비스 중이며, 해당 기능은 무료가 없고 유료만 있다.</li>\n<li>TinyPNG의 CDN document을 살펴보면 아래와 같이 기존 image을 tinifycdn 주소로 변환하여 사용하도록 가이드 한다.\n<ul>\n<li>\n<p>즉 이미지 자체를 TinyPNG에서 서빙해주는 형태이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">**Before**\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/images/logo.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://images.example.com/images/header.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">**After**\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://xxxxxxxx.tinifycdn.com/images/logo.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://xxxxxxxx.tinifycdn.com/images/header.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"api-기능\" style=\"position:relative;\"><a href=\"#api-%EA%B8%B0%EB%8A%A5\" aria-label=\"api 기능 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 기능</h3>\n<ul>\n<li><a href=\"https://tinypng.com/developers/reference\">https://tinypng.com/developers/reference</a></li>\n<li>REST API로 image 변환 처리를 가능하게 제공하고 있다.</li>\n<li>무료로 월 500건까지 사용 가능하다</li>\n<li>기존적으로 ajax을 curl등으로 직접 호출도 가능하고, 여러 언어에서 사용하기 쉽게 lib도 제공하고 있다.\n<ul>\n<li>Ruby, php, Node.js, Python, Java, .Net 의 lib지원</li>\n</ul>\n</li>\n</ul>\n<p><strong>api auth생성</strong></p>\n<ul>\n<li>당연히 api를 막쓰는건 아니고, 사용자 등록을 하여 api key을 발급 받아야 한다.</li>\n<li><a href=\"https://tinypng.com/developers\">https://tinypng.com/developers</a>  페이지에서 e-mail로 인증하면 개발자 계정 로그인이 가능하다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuklEQVQoz3WQSY/TQBCF/YsRR/gvXDkhhODAZQgwUQgaEmYmifd2HC+9uHe33XZ2hGw0cEL6VHr13juUylmD3RqkUYEeozRBlb8rAao2STZbPpayJsbiuv0fznLjT6bzT7fzm6/fJtPv7z/ePLjhYuV9md0RZUTbs6bjT7DG/l2psU4im0i2sWqBsgHTiWo9bmLVJtp6VPtMA14PgmqXqljUIdMrIl2qibEObSyqW2KGiccjSd2iEWosNmM0iKFQGUtGjU0r286BlGeQ5KjKICkwTUuclrggtMBVksMMkrRAuwLlqMrx0OG6afYH0+11t3fSkvggDZPMBzs/HoQbJpsAhEkWjE60zQOwi7a5F6frAFTKmP5Ud8e6Pzpc1phJIjSiAnOFqCgrhpnAXGImIBWEK8IVpIIyoaU+n86Xy/V6uR5PFyfWNhgfFisL9ECs7Yo3kWxGs43GKK27GVbvtuQtwB+25E2M7oh05lj+gOwn4kvIXWEC2XiimRR8AfkSsgVki5KuWZ3W3Ss3e/75/sXt6uV0/Wxy/zosHXM48/4kRnh//IN4csT+ny/6I+8OojtQuzfnX16S/gZnMRmJWqm4zwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"06\"\n        title=\"06\"\n        src=\"/static/c79686405156f8dc009eef0000563c03/37523/06.png\"\n        srcset=\"/static/c79686405156f8dc009eef0000563c03/e9ff0/06.png 180w,\n/static/c79686405156f8dc009eef0000563c03/f21e7/06.png 360w,\n/static/c79686405156f8dc009eef0000563c03/37523/06.png 720w,\n/static/c79686405156f8dc009eef0000563c03/302a4/06.png 1080w,\n/static/c79686405156f8dc009eef0000563c03/f09ab/06.png 1250w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>로그인 이후 <a href=\"https://tinify.com/dashboard/api\">https://tinify.com/dashboard/api</a>  로 접속하면 본인의 Dashboard로 접근 가능하다.</li>\n<li>해당 Dashboard 에서 ‘Add api key’을 통해서 api key을 발급 받을 수 있다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLUlEQVQoz2WTy4oVMRCG+3nd+gIiDIg+hEtXLmVQRFA3LoaBEYRB5uK5zDndfTrpXCtVlZukjwMeLX5CQfL9VUWS7uLy2+XVhXNARJzLr/14dX1z20+rad5KsxZ6LfRK6ME4DeiRgaO27vZ+8/7j5y4gAkB9DB/CfpxWD/0464NxG6G2Qm8mPRpnAPUi6WBQZjK+QyJtDDHXWikmjxxzyaVwyhgjEHtsBX1LCIgDceAYONqAHcco5Ky1aWWJbcAQwjAeDodJzgpS9bnmUqx1znnwECDknHNKMeUGhxBKKQ1G0r6NkHM5TlESFT/llIJTqZSYUiqFOTJzyrkDAKX08SggG9+Mcs61Nr7Ie/ryqtZq5LjvBznPHDmX/AdGYg+h1JpLdkgWTuAsbunT85aklOJjO0vEnDqKUc4KEWstbWbAZXs5UWtulV+2plj6KBwLx5PlQyyYculyKbRErTU0OBy9iTimROiTPZRaPty9eHv99Pz27N3Nszc/ntzIr7XWrv4VRzi3tpfbiqkpF47RBKVBHqVAAAFyPIGJ40Gq9cN+s+83u362TjmvjJ2t0w60C8sKpiVeWfcvPMp5td1tdv1DPwptJqWlscaDWoyMB+NhNlZqo50/gZHZePABOaVcmhcEDIgBSSqttNHWOg+A7SMg8X9we0JIHInjcWYkBiRt7FHOeRNAISnA07ZjFNoOkxzEPAjZT02DUDvlZx8coPaBEM/X49n3u9c/t78B0/5aBQmDnSYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"07\"\n        title=\"07\"\n        src=\"/static/9d21801ea104cf44c71af2a1fb536194/37523/07.png\"\n        srcset=\"/static/9d21801ea104cf44c71af2a1fb536194/e9ff0/07.png 180w,\n/static/9d21801ea104cf44c71af2a1fb536194/f21e7/07.png 360w,\n/static/9d21801ea104cf44c71af2a1fb536194/37523/07.png 720w,\n/static/9d21801ea104cf44c71af2a1fb536194/302a4/07.png 1080w,\n/static/9d21801ea104cf44c71af2a1fb536194/07a9c/07.png 1440w,\n/static/9d21801ea104cf44c71af2a1fb536194/6c9f4/07.png 2326w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><strong>Api 사용</strong></p>\n<ul>\n<li>\n<p>HTTP(Rest Api)도 있기 때문에 ajax로 호출해서 사용하거나, 제공되는 lib의 형태로 사용하면 된다.</p>\n</li>\n<li>\n<p>node.js의 예</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save tinify\n혹은\n<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -D tinyify</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> tinify <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tinify\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ntinify<span class=\"token punctuation\">.</span>key <span class=\"token operator\">=</span> <span class=\"token string\">\"YOUR_API_KEY\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// auth 체크</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">check</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t  tinify<span class=\"token punctuation\">.</span><span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Validation of API key failed.</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n\t\t  <span class=\"token comment\">// validate 이후 compression count을 알 수 있다.</span>\n\t\t  <span class=\"token comment\">// 무료 500 이하로 사용하고 싶을때 해당값을 check해서 사용 가능하다.</span>\n\t\t\t<span class=\"token keyword\">let</span> compressionsThisMonth <span class=\"token operator\">=</span> tinify<span class=\"token punctuation\">.</span>compressionCount<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// optimize (compress)</span>\n<span class=\"token comment\">// srcPath: 소스 이미지 path</span>\n<span class=\"token comment\">// targetPath: 타켓 이미지 path</span>\n<span class=\"token comment\">// local에서 구동시 소스와 타겟 위치가 같으면 소스가 compress되서 덮어써진다.</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">compress</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">srcPath<span class=\"token punctuation\">,</span> targetPath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> source <span class=\"token operator\">=</span> tinify<span class=\"token punctuation\">.</span><span class=\"token function\">fromFile</span><span class=\"token punctuation\">(</span>srcPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// fromFile이 tinyPNG의 Source클래스를 리턴한다.</span>\n  <span class=\"token keyword\">return</span> source<span class=\"token punctuation\">.</span><span class=\"token function\">toFile</span><span class=\"token punctuation\">(</span>targetPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// source.toFile은 Promise을 리턴한다.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<p>그외 <a href=\"https://tinypng.com/analyzer\">https://tinypng.com/analyzer</a> 에서 코드(이미지) 분석이나, photoshop plugin도 제공되고 있다.</p>\n<h3 id=\"활용\" style=\"position:relative;\"><a href=\"#%ED%99%9C%EC%9A%A9\" aria-label=\"활용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>활용</h3>\n<ul>\n<li>\n<p>개인적으로는, jekyll을 통한 blog post을 할때, image source을 optimization(compress)하는 간단한 node 코드를 작성해서 사용중이다.</p>\n</li>\n<li>\n<p>월 500회 제약이 있어서, 한번 줄인 이미지는 다시 줄이지 않도록 하는 처리를 간략하게 파일로 사용하고 있다</p>\n</li>\n<li>\n<p>코드(image-optimize.js)</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token hashbang comment\">#!/usr/bin/env node</span>\n\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> tinify <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tinify'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> prevListPath <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'.optimizelist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> log<span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> console<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">exit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">code <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> fn</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">(</span>fn <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">checkTargetArgs</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> targetArgs <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>targetArgs <span class=\"token operator\">||</span> targetArgs<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> msg1 <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Error: There are no target path !!!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> msg2 <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Error: Plz pass the target path 'node image-optimize.js {:targetPath}'</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg1<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg2<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Check targets: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>targetArgs<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  tinify<span class=\"token punctuation\">.</span>mytarget <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>targetArgs<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>tinify<span class=\"token punctuation\">.</span>mytarget<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">checkAPIKey</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">TINYPNG_API_TOKEN</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Check tinypng api key: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">TINYPNG_API_TOKEN</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token constant\">TINYPNG_API_TOKEN</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> msg1 <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Error: There are no TINYPNG_API_TOKEN !!!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> msg2 <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Error: Plz check 'export TINYPNG_API_TOKEN={:tinypng api token}' in your .bashrc or .zshrc</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg1<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>msg2<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    tinify<span class=\"token punctuation\">.</span>key <span class=\"token operator\">=</span> <span class=\"token constant\">TINYPNG_API_TOKEN</span><span class=\"token punctuation\">;</span>\n    tinify<span class=\"token punctuation\">.</span><span class=\"token function\">validate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>tinify<span class=\"token punctuation\">.</span>compressionCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createTargetFilePathList</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">source<span class=\"token punctuation\">,</span> list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">existsSync</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">.</span><span class=\"token function\">lstatSync</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isDirectory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> files <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdirSync</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> q <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>files<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> curfile</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> curSource <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> curfile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">createTargetFilePathList</span><span class=\"token punctuation\">(</span>curSource<span class=\"token punctuation\">,</span> acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>list<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>q<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>list<span class=\"token punctuation\">,</span> source<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getPrevOptimizeList</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>prevListPath<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">encoding</span><span class=\"token operator\">:</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">flag</span><span class=\"token operator\">:</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>data <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">setPrevOptimizeList</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">list</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'> Optimize history write...'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> list <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFile</span><span class=\"token punctuation\">(</span>prevListPath<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">encoding</span><span class=\"token operator\">:</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">flag</span><span class=\"token operator\">:</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Error: Optimize history write !!!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getTargetPathList</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">targetArgs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> paths <span class=\"token operator\">=</span> targetArgs<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">list<span class=\"token punctuation\">,</span> targetArg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">createTargetFilePathList</span><span class=\"token punctuation\">(</span>targetArg<span class=\"token punctuation\">,</span> list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> prevPaths <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token keyword\">await</span> <span class=\"token function\">getPrevOptimizeList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> filteredList <span class=\"token operator\">=</span> paths<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> prevPaths<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">targetPathList</span><span class=\"token operator\">:</span> filteredList<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">prevList</span><span class=\"token operator\">:</span> prevPaths <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">compressFile</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">source</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// png, jpg 만된다</span>\n  <span class=\"token keyword\">const</span> ext <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ext<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ext <span class=\"token operator\">===</span> <span class=\"token string\">'.png'</span> <span class=\"token operator\">||</span> ext <span class=\"token operator\">===</span> <span class=\"token string\">'.jpg'</span> <span class=\"token operator\">||</span> ext <span class=\"token operator\">===</span> <span class=\"token string\">'.jpeg'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> src <span class=\"token operator\">=</span> tinify<span class=\"token punctuation\">.</span><span class=\"token function\">fromFile</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> src<span class=\"token punctuation\">.</span><span class=\"token function\">toFile</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 그외 확장자는 그대로 pass</span>\n  <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">compress</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> targetPathList<span class=\"token punctuation\">,</span> prevList <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> source <span class=\"token keyword\">of</span> targetPathList<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Optimize progress... [</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>source<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> complete <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">compressFile</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    prevList<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>complete<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">> Optimize complete... [</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>complete<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>prevList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// run</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'!! Image Optimize Run !!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">checkAPIKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>checkTargetArgs<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>getTargetPathList<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>compress<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>setPrevOptimizeList<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'!! Image Optimize Done !!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">error</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">!! Image Optimize Failure  !!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>실제 구동</strong></p>\n<p>node image-optimize.js {:targetPath} 형태로 사용중이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAi0lEQVQI1zWL4Q6DIBCDeZj5Y3OaGOcQ8e6YQQFBxPd/mQXnkqZp2q8MzIZub1GDzYHW9AkH2Kh8QreDjeii8sd4Yu/JFg0vGn47nYnZj2ZrScvF/wjl02gC5ecmlyCXQGsSeh1mjy7yyVaCakGPTjJ0EVx80Vz19OwxD8MVqh4vCSo5lBxy+de9k197bCwj0CYYTgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"08\"\n        title=\"08\"\n        src=\"/static/439a28ab1b24d4df7aa66caea40f971f/37523/08.png\"\n        srcset=\"/static/439a28ab1b24d4df7aa66caea40f971f/e9ff0/08.png 180w,\n/static/439a28ab1b24d4df7aa66caea40f971f/f21e7/08.png 360w,\n/static/439a28ab1b24d4df7aa66caea40f971f/37523/08.png 720w,\n/static/439a28ab1b24d4df7aa66caea40f971f/302a4/08.png 1080w,\n/static/439a28ab1b24d4df7aa66caea40f971f/07a9c/08.png 1440w,\n/static/439a28ab1b24d4df7aa66caea40f971f/f8206/08.png 2806w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<ul>\n<li>이미지 최적화는 서비스 품질와 성능을 높인다.</li>\n<li>실제 포탈등에서는 여러 기법으로 이미지 최적화를 하여 서비스 한다.</li>\n<li>개인이 직접 이미지 최적화 서비스를 구현하기 힘들수 있는데 무료로 사용가능한 tinyPNG가 있다.</li>\n<li>REST API나 대중적인 언어의 lib도 제공되고 있다.</li>\n<li>해당 방법을 응용하면 본인의 서비스의 image 서비스를 최적화하여, 서비스의 품질을 높일 수 있다!!</li>\n<li>꼭 해당 서비스가 아니여도, 실제 서비스 전에 resource최적화(e.g. java의 image 최적화 lib을 쓴다던가… 하는등의 작업)는 꼭 해주는게 좋을듯 하다.!</li>\n</ul>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></li>\n<li><a href=\"#tinypng\">TinyPNG</a></li>\n<li><a href=\"#cdn%EA%B8%B0%EB%8A%A5\">CDN기능</a></li>\n<li><a href=\"#api-%EA%B8%B0%EB%8A%A5\">API 기능</a></li>\n<li><a href=\"#%ED%99%9C%EC%9A%A9\">활용</a></li>\n</ul>\n</div>","excerpt":"소개 web환경에서 resource의 용량은 성능에 매우 큰 영향을 준다. 따라서 여러가지 기법을 이용해서 이를 해결하게 된다. 이런 기법에는 splite image사용, resource cache, device rosolution에 따른 resource 서빙, image crop, image reszie 등등이 있다. 실제 매우 많은 사람이 사용하는 포털 서비스에서도 이러한 기법을 사용한다. 실제 포털에서의 예(다음카카오)  실제 서비스되는 이미지의 용량: 12.4kB 주소: https://search1.daumcdn.net/thumb/C200x278.fwebp.q85/?fname=http%3A%2F%2Ft1.daumcdn.net%2Fbrunch%2Fservice%2Fuser%2F3jtQ%2Fimage%2FCXQeP3cgNqaOGX9_Dx7a9mlt41U.png 주소를 잘 보면 여러 정보를 볼 수 있다 크기로 crop quality: 85% 원본 이미지 주소: http://t1.…","frontmatter":{"date":"June 23, 2021","title":"png, jpg, 이미지 용량 줄이기","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2021/2021-06-23-Image-size-optimize/"}},"next":{"id":"4d5df0dd-e0a6-5765-8e11-6c41e8068ada","html":"<h2 id=\"소개\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"소개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>소개</h2>\n<p>javascript의 module system의 탄생 배경(히스토리)을 알아보고, 이어서 현재 대표적인 javascript module system인 cjs, amd, umd, esm에 대해서 간략하게 알아본다.</p>\n<h2 id=\"배경\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EA%B2%BD\" aria-label=\"배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배경</h2>\n<p>초창기 javascript는 module의 기능 or 개념이 없었고, javascript의 구동환경 역시 browser로 고정되어 있었습니다. 따라서 이당시에서는 하나의 (js)파일로 모든 기능을 제공하거나, <code class=\"language-text\">&lt;script></code>태그의 순차 로딩과, window(global)객체를 활용하여 모듈을 흉내(IIFE의 module pattern)내거나 기능을 분리하여 제공하였습니다.</p>\n<p>javascript생태계가 발전함에 따라서, Javascript을 범용적으로 사용하려는 요구사항들이 발생하게 되었고, 이런 요구사항에 따라서 javascript에서의 module 기능의 필요성이 대두되게 되었습니다. 이러한 필요성에 의해서 탄생한 것이 javascipt module 시스템의, 양대산맥격인 cjs, amd이며 이어서, umd, ems등으로 발전하고 있습니다.</p>\n<h3 id=\"전통적인-방법\" style=\"position:relative;\"><a href=\"#%EC%A0%84%ED%86%B5%EC%A0%81%EC%9D%B8-%EB%B0%A9%EB%B2%95\" aria-label=\"전통적인 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전통적인 방법</h3>\n<p><strong>script order을 사용한 형태</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>./area.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>./main.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token comment\">// area.js</span>\n<span class=\"token keyword\">var</span> pi <span class=\"token operator\">=</span> <span class=\"token number\">3.142</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">radius</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> pi <span class=\"token operator\">*</span> radius <span class=\"token operator\">*</span> radius<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// main.js</span>\n<span class=\"token keyword\">var</span> answer <span class=\"token operator\">=</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>answer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>global scope을 점유하고 있고, 너무 generic한 이름을 사용하고 있다.</li>\n<li>pi나 area가 언제든 변경될 여지가 존재한다.</li>\n</ul>\n<p><strong>IIFE module pattern형태</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// IIFE 1</span>\n<span class=\"token comment\">// area.js</span>\n<span class=\"token keyword\">var</span> utils <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// you hide `pi` within the function scope</span>\n  <span class=\"token keyword\">var</span> pi <span class=\"token operator\">=</span> <span class=\"token number\">3.142</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">radius</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> pi <span class=\"token operator\">*</span> radius <span class=\"token operator\">*</span> radius<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> area <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// main.js</span>\n<span class=\"token keyword\">var</span> answer <span class=\"token operator\">=</span> utils<span class=\"token punctuation\">.</span><span class=\"token function\">area</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// IIFE 2, 혹은 약속된 namespace을 활용</span>\n<span class=\"token comment\">// namespace.js</span>\n<span class=\"token comment\">// main.js, area.js가 약속하는 특정 namespace필요</span>\n<span class=\"token keyword\">var</span> myNamespace <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// area.js</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">myNamespace</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// you hide `pi` within the function scope</span>\n  <span class=\"token keyword\">var</span> pi <span class=\"token operator\">=</span> <span class=\"token number\">3.142</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">area</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">radius</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> pi <span class=\"token operator\">*</span> radius <span class=\"token operator\">*</span> radius<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  myNamespace<span class=\"token punctuation\">.</span>area <span class=\"token operator\">=</span> area<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>myNamespace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// main.js</span>\n<span class=\"token keyword\">var</span> answer <span class=\"token operator\">=</span> myNamespace<span class=\"token punctuation\">.</span><span class=\"token function\">area</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>IIFE의 1번째 방법은 여전히 IIFE의 리턴을 받는 utils에 종속적이다. (다만 area라는 이름의 충돌은 피할 수 있다)</li>\n<li>IIFE의 2번째 예제와 같은 형태가 jQuery의 방식이다. global에  $ 라는 namespace, 즉 특정 이름으로 노출하는 형태이다.</li>\n<li>여전히 다음과 같은 문제가 존재한다\n<ul>\n<li>global namespace(scope) 오염</li>\n<li>lack of dependency resolution (파일 순서가 매우 종속적임)</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"commonjs-cjs\" style=\"position:relative;\"><a href=\"#commonjs-cjs\" aria-label=\"commonjs cjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CommonJS (CJS)</h2>\n<p>CommonJS는 브라우저 이외의 환경에서 범용적으로 javascript을 사용하게 하자는 목표를 가진 표준화 단체 이다. CommonJS는 모질라의 엔지니어 Kevin Dangoor에 의해 2009년 1월 시작되었으며 처음 이름은 ServerJS 였습니다. Kevin은 JavaScript가 브라우저용 언어를 넘어 범용적으로 쓰이려면, Ruby나 Python과 같은 체계가 필요하다고 주장 하였습니다.</p>\n<ul>\n<li>CommonJS는 javascript library가 아니고, ECMA, W3C와 같은 표준(Spec)지정단체 입니다.</li>\n<li>CommonJS는 결국 일종의 Spec 입니다.</li>\n<li>CommonJS가 해결하고자 한 핵심 문제\n<ul>\n<li>서로 호환되는 표준 라이브러리가 없다.</li>\n<li>데이터베이스에 연결할 수 있는 표준 인터페이스가 없다.</li>\n<li>다른 모듈을 삽입하는 표준적인 방법이 없다.</li>\n<li>코드를 패키징해서 배포하고 설치하는 방법이 필요하다.</li>\n<li>의존성 문제까지 해결하는 공통 패키지 모듈 저장소가 필요하다.</li>\n</ul>\n</li>\n<li>CommonJS핵심 문제 해결법은 결국 ‘모듈화’\n<ul>\n<li>스코프(Scope): 모든 모듈은 자신만의 독립적인 실행 영역이 있어야 한다.</li>\n<li>정의(Definition): 모듈 정의는 exports 객체를 이용한다.</li>\n<li>사용(Usage): 모듈 사용은 require 함수를 이용한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"code\" style=\"position:relative;\"><a href=\"#code\" aria-label=\"code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Code</strong></h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// a.js</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// sum 모듈정의, 다른데서 사용 가능</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sum</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c<span class=\"token punctuation\">,</span> d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b <span class=\"token operator\">+</span> c <span class=\"token operator\">+</span> d<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// b.js</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> moduleA <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./a.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 모듈 사용</span>\nmoduleA<span class=\"token punctuation\">.</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3+4+5+6 = 18</span></code></pre></div>\n<ul>\n<li>\n<p>CommonJS의 모듈 명세는 모든 파일이 로컬 디스크에 있어 필요할 때 바로 불러올 수 있는 상황을 전제(즉 ServerSide)을 전제합니다.</p>\n</li>\n<li>\n<p>동기화가 기본이라 브라우저에서 사용시 성능 문제가 있습니다. → 이를위해서 동적 <code class=\"language-text\">&lt;script></code> 태그 삽입등이 추가되었습니다.</p>\n</li>\n<li>\n<p>JavaScript가 브라우저에서 동작할 때는 서버 사이드 JavaScript와 달리 파일 단위의 스코프가 없습니다.</p>\n<ul>\n<li>동적 <code class=\"language-text\">&lt;script></code>로 로딩시, 전통적인 방법과 동일하게, a.js와 b.js를 차례대로 로드하면, a.js의 변수가 b.js의 변수를 모두 덮어쓰게 되는 전역변수 문제도 발생합니다.</li>\n<li>이런 문제를 해결하기 위해서, CommonJS는 서버 모듈을 비동기적으로 클라이언트에 전송할 수 있는 모듈 전송 포맷(module transport format)을 추가로 정의했습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// complex-numbers/plus-two.js</span>\nrequire<span class=\"token punctuation\">.</span><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string-property property\">\"complex-numbers/plus-two\"</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">require<span class=\"token punctuation\">,</span> exports</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//콜백 함수 안에 모듈을 정의한다.</span>\n    <span class=\"token keyword\">var</span> sum <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./complex-number\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sum<span class=\"token punctuation\">;</span>\n    exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">plusTwo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"complex-numbers/math\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//먼저 로드되어야 할 모듈을 기술한다.</span></code></pre></div>\n</li>\n</ul>\n<h3 id=\"구현체\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84%EC%B2%B4\" aria-label=\"구현체 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현체</h3>\n<p>대표적으로 node.js 와  FINF가 있습니다.</p>\n<ul>\n<li>브라우저용\n<ul>\n<li>curl.js(<a href=\"http://github.com/unscriptable/curl\">http://github.com/unscriptable/curl</a>)</li>\n<li>SproutCore(<a href=\"http://sproutcore.com/\">http://sproutcore.com</a>)</li>\n<li>PINF(<a href=\"http://github.com/pinf/loader-js\">http://github.com/pinf/loader-js</a>)</li>\n<li>기타 등등</li>\n</ul>\n</li>\n<li>서버사이드용\n<ul>\n<li>Node.js(<a href=\"http://nodejs.org/\">http://nodejs.org</a>)</li>\n<li>Narwhal(<a href=\"https://github.com/tlrobinson/narwhal\">https://github.com/tlrobinson/narwhal</a>)</li>\n<li>Persevere(<a href=\"http://www.persvr.org/\">http://www.persvr.org</a>)</li>\n<li>Wakanda(<a href=\"http://www.wakandasoft.com/\">http://www.wakandasoft.com</a>)</li>\n</ul>\n</li>\n</ul>\n<p>참고: node.js의 경우, v12부터는 esm와 cjs을 모두 지원합니다, 2021년 6월 기준 16.0.3 에서 둘다 지원 가능(<a href=\"https://nodejs.org/api/modules.html\">https://nodejs.org/api/modules.html</a>, <a href=\"https://nodejs.org/api/esm.html\">https://nodejs.org/api/esm.html</a>)</p>\n<hr>\n<h2 id=\"asynchronous-module-definition-amd\" style=\"position:relative;\"><a href=\"#asynchronous-module-definition-amd\" aria-label=\"asynchronous module definition amd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Asynchronous module definition (AMD)</h2>\n<p>AMD그룹은 CommonJS에서 독립한(갈라져나온) 그룹입니다. AMD는 네트웍을 통해 비동기형태로 파일을 내려받는 환경(브라우저환경)에서의 모듈화에 중접을 두고 있습니다. 이는 CommonJS 추구하는 브라우저 이외의 환경을 목표로 하는 부분과 중점요소가 달랐기 때문에 CommonJS에서 합의점을 도출하지 못하고 갈라져 나오게 되었습니다.</p>\n<p>CJS, AMD을 가지고 무었이 더 좋다고 이야기 하기 힘듭니다. 둘다 서버환경, 브라우저 환경에서 구동 가능합니다. 다만 중점 요소가 명확하기 때문에 Server(node)에서는 CJS가 좀더 적합하고, FE(Browser)환경에서는 AMD가 좀더 적합합니다.</p>\n<h3 id=\"code-1\" style=\"position:relative;\"><a href=\"#code-1\" aria-label=\"code 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h3>\n<p><strong>모듈 정의</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// spec</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> dependencies<span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> factory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">/* js/a.js */</span>\n<span class=\"token comment\">// 모듈 정의의 기본 형태</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span> <span class=\"token comment\">// 의존 모듈들을 나열한다. 모듈이 한 개라도 배열로 넘겨야 한다.</span>\n    <span class=\"token string\">'js/util'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'js/Ajax'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'js/Event'</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">util<span class=\"token punctuation\">,</span> Ajax<span class=\"token punctuation\">,</span> Event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 의존 모듈들은 순서대로 매개변수에 담긴다.</span>\n    <span class=\"token comment\">// 의존 모듈들이 모두 로딩 완료되면 이 함수를 실행한다.</span>\n    <span class=\"token comment\">// 초기화 영역</span>\n    <span class=\"token keyword\">var</span> callCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        callCount <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">getCallCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> i<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 외부에 노출할 함수들만 반환한다.</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">sum</span><span class=\"token operator\">:</span> sum<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">getCallCount</span><span class=\"token operator\">:</span> getCallCount\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// AMD 명세에서 정의하는 전역변수는 define과</span>\n<span class=\"token comment\">// CommonJS에서 사용하는 require 객체, exports 객체가 있다.</span>\n<span class=\"token comment\">// 그리고 전역 모듈을 명시적으로 가리킬 때 사용하는 define.amd 프로퍼티도 사용할 수 있다</span></code></pre></div>\n<p><strong>모듈사용</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">/* js/main.js */</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'js/a'</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span><span class=\"token function\">getCallCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>부가설명</strong></p>\n<ul>\n<li>\n<p>dependency(의존모듈)의 로딩 순서는 보장되지 않는다. (비동기로 받음)</p>\n<ul>\n<li>dependency의 로딩 순서가 중요하다면 아래와 같이 중첩 require을 사용해야 한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'js/a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'js/b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// a -> b 로딩 순서 보장</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>define구문에 dependency는 한번만 로딩된다. (다른 어디선가 동일한 모듈 로딩시 바로 로딩됨)</p>\n</li>\n</ul>\n<h3 id=\"구현체-1\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84%EC%B2%B4-1\" aria-label=\"구현체 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현체</h3>\n<p>대표적으로 Dojo1.7 나 EmberJS등의 framework에서 AMD형태의 loader을 제공합니다. requirejs는 가장 대표적인 amd module loader입니다.</p>\n<ul>\n<li>브라우저용\n<ul>\n<li>RequireJS(<a href=\"http://requirejs.org/\">http://requirejs.org</a>)</li>\n<li>curl.js(<a href=\"http://github.com/unscriptable/curl\">http://github.com/unscriptable/curl</a>)</li>\n<li>bdLoad(<a href=\"http://bdframework.org/bdLoad/\">http://bdframework.org/bdLoad/</a>)</li>\n<li>Yabble(<a href=\"http://github.com/jbrantly/yabble\">http://github.com/jbrantly/yabble</a>)</li>\n<li>PINF(<a href=\"http://github.com/pinf/loader-js\">http://github.com/pinf/loader-js</a>)</li>\n<li>기타 등등</li>\n</ul>\n</li>\n<li>서버사이드용\n<ul>\n<li>RequireJS(<a href=\"http://requirejs.org/\">http://requirejs.org</a>)</li>\n<li>PINF(<a href=\"http://github.com/pinf/loader-js\">http://github.com/pinf/loader-js</a>)</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"universal-module-definition-umd\" style=\"position:relative;\"><a href=\"#universal-module-definition-umd\" aria-label=\"universal module definition umd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Universal Module Definition (UMD)</h2>\n<p>UMD는 CommonJS, AMD와 같이 javascript의 module에 대한 spec이 나누어져 있어서 나온 불편함을 한방에 해결하기 위해 나온 개념 입니다. CommonJS와 AMD와는 달리 spec은 아니고, CommonJS, AMD, 그리고 전통적인 방법(window 객체에 bind)을 모두 지원하는 형태(일종의 구현 패턴, 디자인패턴)으로 되어 있습니다.</p>\n<h3 id=\"code-2\" style=\"position:relative;\"><a href=\"#code-2\" aria-label=\"code 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">global<span class=\"token punctuation\">,</span> factory</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> define <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span> <span class=\"token operator\">&amp;&amp;</span> define<span class=\"token punctuation\">.</span>amd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// ADM</span>\n        <span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> factory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> module <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">&amp;&amp;</span> module<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// CommonJS</span>\n        <span class=\"token comment\">// Node/CommonJS</span>\n        module<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span> <span class=\"token parameter\">root<span class=\"token punctuation\">,</span> jQuery</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> jQuery <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    jQuery <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                    jQuery <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jquery'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token function\">factory</span><span class=\"token punctuation\">(</span>jQuery<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> jQuery<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// window(Browser globals)</span>\n        global<span class=\"token punctuation\">.</span>$ <span class=\"token operator\">=</span> <span class=\"token function\">factory</span><span class=\"token punctuation\">(</span>jQuery<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">$</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    $<span class=\"token punctuation\">.</span>fn<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">jqueryPlugin</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>UMD형태를 제공하는 전형적인 패턴입니다.\n<ul>\n<li>참고: <a href=\"https://github.com/umdjs/umd/blob/master/templates\">https://github.com/umdjs/umd/blob/master/templates</a></li>\n</ul>\n</li>\n<li>UMD에서는, AMD는 define을 사용하고, CommonJS는 module.exports를 사용하는 차이점을 응용하여 모듈을 정의해줍니다. 둘다 아닌경우 전통적인 방식으로 global에 bind해줍니다.</li>\n</ul>\n<p><strong>부가설명</strong></p>\n<ul>\n<li>umd는 현재 사용하는 javascript module 형태와 무관하게 어디서든 사용 가능한 구조로 되어 있습니다.</li>\n<li>보통 webpack와 같은 bundler사용시에는 직접 구현할 필요없이 해당 형태로 만들어 줍니다.\n<ul>\n<li>참고: <a href=\"https://webpack.js.org/configuration/output/#outputglobalobject\">https://webpack.js.org/configuration/output/#outputglobalobject</a></li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"ecmascript-module-esm\" style=\"position:relative;\"><a href=\"#ecmascript-module-esm\" aria-label=\"ecmascript module esm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ECMAScript Module (ESM)</h2>\n<p>ESM은 ECMAScript에서 지원하는 자바스크립트 공식 모듈 시스템입니다. es6 부터 추가되었으며, 현재 IE을 제외한, 대다수의 브라우저에서 지원 가능합니다. es6문법 이전의 브라우저에서는 당연 미지원하기 때문에 구 브라우저 지원이 필요한 경우 bundler을 통해서 umd나 cjs, amd등으로 변환하여 지원하여야 합니다.</p>\n<ul>\n<li>browser support: <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules#browser_support\">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules#browser_support</a></li>\n</ul>\n<h3 id=\"동작\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%9E%91\" aria-label=\"동작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>동작</strong></h3>\n<ul>\n<li>참고: <a href=\"https://ui.toast.com/weekly-pick/ko_20180402\">https://ui.toast.com/weekly-pick/ko_20180402</a></li>\n<li>Browser기준 → 구성, 인스턴스화, 평가 → 모듈 인스턴스가 나옴\n<ol>\n<li>구성 - 모든 파일을 찾아 다운로드하고 모듈 레코드로 구문분석한다.</li>\n<li>인스턴스 화 - export 된 값을 모두 배치하기 위해 메모리에 있는 공간들을 찾는다(아직 실제 값은 채우지 않음). 그다음 export와 import들이 이런 메모리 공간들을 가리키도록 한다. 이를 연결(linking) 이라고 한다.</li>\n<li>평가 - 코드를 실행하여 상자의 값을 변수의 실제 값으로 채운다.</li>\n</ol>\n</li>\n</ul>\n<p><strong>구성</strong></p>\n<ol>\n<li>\n<p>모듈이 들어있는 파일을 어디서 다운로드 할 것인지 확인한다(module resolution이라고도 함).</p>\n<ul>\n<li>파일의 진입점\n<ul>\n<li>브라우저의 경우 script태그의 type=“module” 로 구분</li>\n<li>Node의 경우 script태그가 없기 때문에, .mjs 확장자 사용 (아직 논의중!!!)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>파일을 가져온다(URL을 통해 다운로드 하거나 파일 시스템에서 불러옴).</p>\n<ul>\n<li>실제 파일을 불러오는 것은 로더(loader)가 하며, 브라우저에서는 ES 모듈 명세가 아닌 HTML 명세를 따른다.\n<ul>\n<li>\n<p><a href=\"https://tc39.github.io/ecma262/#sec-modules\">ES 모듈 명세</a>는 모듈 레코드에 파일을 구문분석하는 방법과 인스턴스 화 하는 방법, 그리고 그 모듈을 평가하는 방법을 알려준다. 하지만 파일을 처음에 어떻게 얻는지는 말하고 있지 않다.</p>\n<p>파일을 불러오는 것은 로더(loader)이다. 로더는 다른 명세로 구성되어있다. 브라우저의 경우 <a href=\"https://html.spec.whatwg.org/#fetch-a-module-script-tree\">HTML 명세</a>를 따른다. 그러나 사용 중인 플랫폼에 따라 다른 로더를 가질 수 있다.</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>파일을 모듈 레코드로 구문분석한다.</p>\n<ul>\n<li>파일 진입점에서 파일을 받고, 모듈 레코드(Module Record)라고 하는 데이터 구조로 변환해야한다. 이 과정에서 해당 파일들의 모든 구문을 분석할 필요가 있다.</li>\n</ul>\n</li>\n</ol>\n<p><strong>인스턴스화</strong></p>\n<ul>\n<li>인스턴스는 코드와 상태를 결합한다. 상태는 메모리에 있으므로 인스턴스 화 단계는 모든 것을 메모리에 연결(linking)하는 것이다.</li>\n<li>모듈 그래프를 인스턴스 화하기 위해 엔진은 깊이 우선 순회를 수행</li>\n<li>export의 값을 배치하기 위한 메모리 공간을 찾고 이를 가리키게 한다.\n<ul>\n<li>한 모듈에 대한 export와 import는 같은 메모리의 주소를 가리키게 한다.</li>\n</ul>\n</li>\n<li>실제 값은 채우지 않는다. 실제 값은 평가 단계에서 채워진다.</li>\n</ul>\n<p><strong>평가</strong></p>\n<ul>\n<li>JS 엔진은 함수 외부 코드인 최상위 레벨 코드를 실행하여 값을 채운다.</li>\n<li>모듈은 한 번만 평가하도록 한다.</li>\n<li>인스턴스 화와 마찬가지로 깊이 우선 탐색 순회을 한다.</li>\n<li>모듈 맵은 표준 URL로 모듈을 캐시 하므로 각 모듈에 대해 하나의 모듈 레코드만 있다.</li>\n</ul>\n<h3 id=\"code-3\" style=\"position:relative;\"><a href=\"#code-3\" aria-label=\"code 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>code</h3>\n<p><strong>export(named)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> b <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">fn2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Class2</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span> b<span class=\"token punctuation\">,</span> fn2<span class=\"token punctuation\">,</span> Class2 <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>export구문을 여러개 사용가능합니다.</li>\n<li>변수, 함수, 클래스, 객체 모두 export가능합니다.</li>\n</ul>\n<p><strong>export default</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 변수값은 default로 선언, 내보내기가 동시에 되지 않는다</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token comment\">// 안되요~!!</span>\n\n<span class=\"token comment\">// fn.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Class.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//a.js</span>\n<span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> a\n\n<span class=\"token comment\">// fn.js</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> fn\n\n<span class=\"token comment\">// Class.js</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Class</code></pre></div>\n<ul>\n<li>변수를 제외하고, 선언과 동시에 export가 가능합니다.</li>\n<li>선언과, export을 구분해서는 모두 가능합니다.</li>\n<li>export default는 모듈당 한번만 가능합니다. (보통 파일에서 한번만 가능)</li>\n<li>export default와 그냥 일반 export을 섞어서 사용 가능합니다.</li>\n</ul>\n<p><strong>import(named export을 import)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> a <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'a.js'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> fn <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'fn.js'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Class <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'class.js'</span></code></pre></div>\n<p><strong>import(export default을 import)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> a <span class=\"token keyword\">from</span> <span class=\"token string\">'a.js'</span>\n<span class=\"token keyword\">import</span> fn <span class=\"token keyword\">from</span> <span class=\"token string\">'fn.js'</span>\n<span class=\"token keyword\">import</span> Class <span class=\"token keyword\">from</span> <span class=\"token string\">'class.js'</span>\n<span class=\"token keyword\">import</span> Change <span class=\"token keyword\">from</span> <span class=\"token string\">'class.js'</span> <span class=\"token comment\">//default의 경우 import된 모듈 이름 변경 가능합니다.</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> a <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> Class <span class=\"token keyword\">from</span> <span class=\"token string\">'some.js'</span> <span class=\"token comment\">// default export와 export을 둘다 import 가능합니다.</span></code></pre></div>\n<ul>\n<li>그외 여러 esm형태의 import, export는 아래 링크  참고\n<ul>\n<li><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Modules\">https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Modules</a></li>\n<li><a href=\"https://github.com/mdn/js-examples/tree/master/modules\">https://github.com/mdn/js-examples/tree/master/modules</a></li>\n</ul>\n</li>\n</ul>\n<p><strong>Entry</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>main.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>type=“module” 을 명시하면, main.js가 esm형태의 모듈을 따름을 브라우저에 알릴 수 있다.</li>\n</ul>\n<p><strong>부가설명</strong></p>\n<ul>\n<li>\n<p>node에서도 공식적으로 esm을 지원합니다.(현재 ems와 cjs을 모두 지원합니다)</p>\n</li>\n<li>\n<p>es module(esm)의 동작 방식 아래 참고에 설명 꼭 읽으면 좋습니다.</p>\n<ul>\n<li>참고: <a href=\"https://ui.toast.com/weekly-pick/ko_20180402\">https://ui.toast.com/weekly-pick/ko_20180402</a></li>\n</ul>\n</li>\n<li>\n<p>script tag동작</p>\n<p><img src=\"/c56b975b1b5a95b244ec700bb1ceeb57/async-defer.svg\" alt=\"\"></p>\n</li>\n</ul>\n<hr>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h2>\n<p>CJS</p>\n<ul>\n<li><a href=\"http://www.commonjs.org/\">http://www.commonjs.org/</a></li>\n<li><a href=\"https://ko.wikipedia.org/wiki/CommonJS\">https://ko.wikipedia.org/wiki/CommonJS</a></li>\n<li><a href=\"https://www.blueskyonmars.com/2009/01/29/what-server-side-javascript-needs/\">https://www.blueskyonmars.com/2009/01/29/what-server-side-javascript-needs/</a></li>\n<li><a href=\"https://groups.google.com/g/commonjs?pli=1\">https://groups.google.com/g/commonjs?pli=1</a></li>\n<li><a href=\"https://d2.naver.com/helloworld/12864\">https://d2.naver.com/helloworld/12864</a></li>\n<li><a href=\"http://wiki.commonjs.org/wiki/Modules/Transport\">http://wiki.commonjs.org/wiki/Modules/Transport</a></li>\n</ul>\n<p>AMD</p>\n<ul>\n<li><a href=\"https://www.oreilly.com/library/view/learning-javascript-design/9781449334840/ch11s02.html\">https://www.oreilly.com/library/view/learning-javascript-design/9781449334840/ch11s02.html</a></li>\n<li><a href=\"https://d2.naver.com/helloworld/591319\">https://d2.naver.com/helloworld/591319</a></li>\n<li><a href=\"https://requirejs.org/docs/whyamd.html\">https://requirejs.org/docs/whyamd.html</a></li>\n<li><a href=\"https://github.com/amdjs/amdjs-api/wiki/AMD\">https://github.com/amdjs/amdjs-api/wiki/AMD</a></li>\n<li><a href=\"https://github.com/amdjs/amdjs-api/blob/master/AMD.md\">https://github.com/amdjs/amdjs-api/blob/master/AMD.md</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Asynchronous_module_definition\">https://en.wikipedia.org/wiki/Asynchronous_module_definition</a></li>\n<li><a href=\"https://www.slideshare.net/xMartin12/asynchronous-module-definition-amd\">https://www.slideshare.net/xMartin12/asynchronous-module-definition-amd</a></li>\n</ul>\n<p>UMD</p>\n<ul>\n<li><a href=\"https://github.com/umdjs/umd\">https://github.com/umdjs/umd</a></li>\n<li><a href=\"https://sub0709.tistory.com/49\">https://sub0709.tistory.com/49</a></li>\n<li><a href=\"https://www.zerocho.com/category/JavaScript/post/5b67e7847bbbd3001b43fd73\">https://www.zerocho.com/category/JavaScript/post/5b67e7847bbbd3001b43fd73</a></li>\n</ul>\n<p>ESM</p>\n<ul>\n<li><a href=\"https://yoeubi28.medium.com/commonjs-esm-%EB%AA%A8%EB%93%88-%EC%88%9C%ED%99%98-%EC%B0%B8%EC%A1%B0-%EC%B0%A8%EC%9D%B4-e5cd1047deaf\">https://yoeubi28.medium.com/commonjs-esm-모듈-순환-참조-차이-e5cd1047deaf</a></li>\n<li><a href=\"https://v8.dev/features/modules#mjs\">https://v8.dev/features/modules#mjs</a></li>\n<li><a href=\"https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/\">https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/</a></li>\n<li><a href=\"https://ui.toast.com/weekly-pick/ko_20180402\">https://ui.toast.com/weekly-pick/ko_20180402</a></li>\n<li><a href=\"https://velog.io/@jjunyjjuny/ES-Modules-%EC%A0%95%EB%A6%AC%ED%95%98%EA%B8%B0\">https://velog.io/@jjunyjjuny/ES-Modules-정리하기</a></li>\n<li><a href=\"https://yceffort.kr/2020/08/commonjs-esmodules\">https://yceffort.kr/2020/08/commonjs-esmodules</a></li>\n<li><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Modules\">https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Modules</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import\">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export\">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export</a></li>\n<li><a href=\"https://tc39.es/ecma262/#sec-modules\">https://tc39.es/ecma262/#sec-modules</a></li>\n</ul>\n<p>ETC</p>\n<ul>\n<li><a href=\"https://medium.com/sungthecoder/javascript-module-module-loader-module-bundler-es6-module-confused-yet-6343510e7bde\">https://medium.com/sungthecoder/javascript-module-module-loader-module-bundler-es6-module-confused-yet-6343510e7bde</a></li>\n<li><a href=\"https://lihautan.com/javascript-modules/\">https://lihautan.com/javascript-modules/</a></li>\n<li><a href=\"https://beomy.github.io/tech/javascript/cjs-amd-umd-esm/#:~:text=ESM%EC%9D%80%20ECMAScript%EC%97%90%EC%84%9C%20%EC%A7%80%EC%9B%90,%EB%93%A4%EB%9F%AC%EB%A5%BC%20%ED%95%A8%EA%BB%98%20%EC%82%AC%EC%9A%A9%ED%95%B4%EC%95%BC%20%ED%95%A9%EB%8B%88%EB%8B%A4\">https://beomy.github.io/tech/javascript/cjs-amd-umd-esm/#:~:text=ESM은 ECMAScript에서 지원,들러를 함께 사용해야 합니다</a></li>\n<li><a href=\"https://thebook.io/080203/ch22/04/\">https://thebook.io/080203/ch22/04/</a></li>\n<li><a href=\"https://defineall.tistory.com/916\">https://defineall.tistory.com/916</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%86%8C%EA%B0%9C\">소개</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%B0%B0%EA%B2%BD\">배경</a></p>\n<ul>\n<li><a href=\"#%EC%A0%84%ED%86%B5%EC%A0%81%EC%9D%B8-%EB%B0%A9%EB%B2%95\">전통적인 방법</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#commonjs-cjs\">CommonJS (CJS)</a></p>\n<ul>\n<li><a href=\"#code\"><strong>Code</strong></a></li>\n<li><a href=\"#%EA%B5%AC%ED%98%84%EC%B2%B4\">구현체</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#asynchronous-module-definition-amd\">Asynchronous module definition (AMD)</a></p>\n<ul>\n<li><a href=\"#code-1\">Code</a></li>\n<li><a href=\"#%EA%B5%AC%ED%98%84%EC%B2%B4-1\">구현체</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#universal-module-definition-umd\">Universal Module Definition (UMD)</a></p>\n<ul>\n<li><a href=\"#code-2\">Code</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#ecmascript-module-esm\">ECMAScript Module (ESM)</a></p>\n<ul>\n<li><a href=\"#%EB%8F%99%EC%9E%91\"><strong>동작</strong></a></li>\n<li><a href=\"#code-3\">code</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 21, 2021","title":"Javascript Module System (CJS, AMD, UMD, ESM)","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2021/2021-06-21-Javascript-Module-System/"}},"prev":{"id":"b9d24642-294a-5a34-970f-417aea12d85a","html":"<aside>\n💡 <bold>\"If it looks like a duck, swims like a duck, and quacks like a duck, then it probably *is* a duck.\"\n\"무엇이든, 오리처럼 생겼고, 오리 처럼 걷고, 오리처럼 꽥꽥 거린다면 그건 오리다\"</bold>\n</aside>\n<br/>\n<h3 id=\"덕-타이핑duck-typing--이란\" style=\"position:relative;\"><a href=\"#%EB%8D%95-%ED%83%80%EC%9D%B4%ED%95%91duck-typing--%EC%9D%B4%EB%9E%80\" aria-label=\"덕 타이핑duck typing  이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>덕 타이핑(Duck Typing)  이란?</h3>\n<ul>\n<li>\n<p>사실상 위의 정의가 Duck Typing의 알파이지 오메가 이다.  (핵심 내용을 담고 있다)</p>\n</li>\n<li>\n<p>Duck Typing의 개념은 <a href=\"https://en.wikipedia.org/wiki/Duck_test\">Duck Test</a>에서 유래하였다.</p>\n</li>\n<li>\n<p><strong>Duck Typing</strong>은, **컴퓨터 프로그래밍 개념(패턴, 방법)**이다.</p>\n<ul>\n<li>컴퓨터 프로그래밍 언어에서 Type을 추론, (혹은 유추, 정의) 할때 사용된다.</li>\n<li>예제</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Typescript - Duck Typing</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Duck</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">talk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">swim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> duck <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">talk</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"꽥꽥\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">swim</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"오리 수영\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> human <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">talk</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"안녕하세요\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">swim</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"사람 수영\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">duckSwimAndTalk</span><span class=\"token punctuation\">(</span>duckType<span class=\"token operator\">:</span> Duck<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">swim ></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duckType<span class=\"token punctuation\">.</span><span class=\"token function\">swim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, talk > </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duckType<span class=\"token punctuation\">.</span><span class=\"token function\">talk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">duckSwimAndTalk</span><span class=\"token punctuation\">(</span>duck<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">duckSwimAndTalk</span><span class=\"token punctuation\">(</span>human<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// human이지만 Duck(interface) type 형태로 인식</span></code></pre></div>\n<ul>\n<li>위 코드를 보면 ”<strong>어떤 타입에 걸맞은 변수와 메소드를 지니면 객체를 해당 타입에 속하는 것으로 간주”</strong> 하고 있다.</li>\n<li>이처럼 <strong>구조</strong>가 같으면 같은 타입으로 간주하는 방식을 <em>Structural Typing</em>, Java/C# 등과 같이 <strong>이름</strong>을 기준으로 타입을 나누는 방식을 <em>Nominal Typing</em>이라 한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h3>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Duck_test\">https://en.wikipedia.org/wiki/Duck_test</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Duck_typing\">https://en.wikipedia.org/wiki/Duck_typing</a></li>\n<li><a href=\"https://ko.wikipedia.org/wiki/%EB%8D%95_%ED%83%80%EC%9D%B4%ED%95%91\">https://ko.wikipedia.org/wiki/덕_타이핑</a></li>\n<li><em>추천</em> - <a href=\"https://theburningmonk.com/2015/05/why-i-like-golang-interfaces/\">https://theburningmonk.com/2015/05/why-i-like-golang-interfaces/</a>\n<ul>\n<li>Duck Type - 편리함과 안정성의 균형…</li>\n</ul>\n</li>\n<li><em>추천</em> - <a href=\"https://soopdop.github.io/2020/12/09/duck-typing/\">https://soopdop.github.io/2020/12/09/duck-typing/</a>\n<ul>\n<li><em>Structural Typing</em>, <em>Nominal Typing</em> 관련 내용이 잘 설명</li>\n</ul>\n</li>\n<li><em>추천</em> - <a href=\"https://velog.io/@thms200/Typescript-Duck-Typing-%EB%8D%95%ED%83%80%EC%9D%B4%ED%95%91\">https://velog.io/@thms200/Typescript-Duck-Typing-덕타이핑</a>\n<ul>\n<li>오버로딩, 오버라이딩 관점의 내용이 있음, 딱 들어 맞지는 않지만 좋은 내용</li>\n</ul>\n</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%8D%95-%ED%83%80%EC%9D%B4%ED%95%91duck-typing--%EC%9D%B4%EB%9E%80\">덕 타이핑(Duck Typing)  이란?</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</div>","frontmatter":{"date":"January 20, 2022","title":"Duck Typing 덕 타이핑 이란?","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2022/2022-01-20-Duck-Typing/"}},"site":{"siteMetadata":{"siteUrl":"https://gseok.github.io","comments":{"utterances":{"repo":"gseok/gseok.github.com"}}}}},"pageContext":{"slug":"/tech-talk-2021/2021-06-23-Image-size-optimize/","nextSlug":"/tech-talk-2021/2021-06-21-Javascript-Module-System/","prevSlug":"/tech-talk-2022/2022-01-20-Duck-Typing/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}