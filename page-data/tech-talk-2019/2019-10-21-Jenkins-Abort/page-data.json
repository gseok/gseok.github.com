{"componentChunkName":"component---src-templates-blog-template-js","path":"/tech-talk-2019/2019-10-21-Jenkins-Abort/","result":{"data":{"cur":{"id":"47b6e5e2-4ec0-5981-9013-b310a46af38c","html":"<h2 id=\"ì†Œê°œ\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"ì†Œê°œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì†Œê°œ</h2>\n<p>ì•½ê°„ ì‹œëŒ€ì— ë’¤ë–¨ì–´ì§€ëŠ” UI/UX &#x26; ì‚¬ìš©ë²•ìœ¼ë¡œ, ì‚¬ìš©ìë“¤ì´ ë§ì´ ì´íƒˆí•˜ì˜€ì§€ë§Œ, ì•„ì§ë„ Top20 ë“±ìœ¼ë¡œ CI/CD Toolê²€ìƒ‰ì‹œ í•­ìƒ í¬í•¨ë˜ëŠ” ì •í†µì˜ ê°•ìê°€ Jenkins ì´ë‹¤. ì—¬ê¸°ì„œëŠ”, Jenkinsì˜ Abort(Cancel) actionì— ëŒ€í•œ í›„ì²˜ë¦¬(post control or after control)ë¥¼ ë³„ë„ì˜ pluginì„¤ì¹˜ ì—†ì´ simpleí•˜ê²Œ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•˜ì—¬ ì„¤ëª…í•œë‹¤.</p>\n<h2 id=\"why-needed\" style=\"position:relative;\"><a href=\"#why-needed\" aria-label=\"why needed permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>why needed?</h2>\n<ul>\n<li>í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ, ì„œë²„ë¡œ APIë¥¼ ì˜ëŠ” CLIì„ ì‚¬ìš©ì¤‘ì¸ë°, Jenkinsì—ì„œ Cancelí•˜ì—¬ë„, ì‹¤ì œ Build or Deployë™ì‘ì€ Cancelë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆìŒ.</li>\n<li>í•´ê²°ë°©ë²•ìœ¼ë¡œ, Jenkinsì—ì„œ Cancelí•˜ë©´, í•´ë‹¹ ë™ì‘ì„ ê°ì§€í•˜ì—¬ ì„œë²„ì— Cancel APIì„ í˜¸ì¶œí•˜ì—¬ ì‹¤ì œ Build or Deployë™ì‘ì„ Cancelì²˜ë¦¬ í•˜ê³ ì í•¨.</li>\n</ul>\n<h2 id=\"pre-required-knowledge\" style=\"position:relative;\"><a href=\"#pre-required-knowledge\" aria-label=\"pre required knowledge permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pre required knowledge</h2>\n<p><strong>Jenkins ê´€ë ¨</strong></p>\n<ul>\n<li>Jenkins Basic\n<ul>\n<li>open source:Â <a href=\"https://github.com/jenkinsci/jenkins\">https://github.com/jenkinsci/jenkins</a></li>\n<li>Java Program (war),Â <code class=\"language-text\">java -jar jenkins.war --httpProt=8080</code></li>\n<li>Java 8 ì´ìƒ í™˜ê²½ì—ì„œ ì–´ë””ì„œë‚˜ ì‹¤í–‰ ê°€ëŠ¥(Multiple OS Support)</li>\n<li><a href=\"https://blog.knoldus.com/setting-up-master-slave-machines-using-jenkins/\">ë¶„ì‚° ë¹Œë“œ ì§€ì›</a></li>\n<li><a href=\"https://plugins.jenkins.io/\">ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ ì§€ì›</a></li>\n<li><a href=\"https://jenkins.io/doc/developer/tutorial/extend/\">ì»¤ìŠ¤í…€ í”ŒëŸ¬ê·¸ì¸ ì§€ì›</a></li>\n</ul>\n</li>\n<li>Jenkins Build Step (Execute Shell)\n<ul>\n<li>ì‚¬ì‹¤ Javaì—ì„œÂ <code class=\"language-text\">Runtime.exec</code>Â orÂ <code class=\"language-text\">ProcessBuilder</code>ì™€ ë‹¤ë¥¼ë°” ì—†ìŒ</li>\n<li>ì¦‰ í•˜ë‚˜ì˜ Execute Shellì€ í•˜ë‚˜ì˜Â <code class=\"language-text\">Child Process</code>ê°€ ë˜ì–´ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰ë¨</li>\n</ul>\n</li>\n</ul>\n<p><strong>Kubernetes ê´€ë ¨</strong></p>\n<ul>\n<li>Kubectl CLI\n<ul>\n<li>ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ì»¨íŠ¸ë¡¤ í• ìˆ˜ ìˆëŠ” CLI Tool</li>\n<li><code class=\"language-text\">kubectl</code>Â ëª…ë ¹ì–´ë¡œ Kubernetes Clusterì™€ ìƒí˜¸ ì‘ìš© í•  ìˆ˜ ìˆë‹¤.</li>\n<li><code class=\"language-text\">kubectl</code>ì€ ì‹¤ì§ˆì ìœ¼ë¡œëŠ”Â <a href=\"https://kubernetes.io/ko/docs/tutorials/kubernetes-basics/deploy-app/deploy-intro/\">Kubernetesì˜ API</a>ë¥¼ ì‚¬ìš©í•œë‹¤.\n<ul>\n<li><a href=\"https://kubernetes.io/ko/docs/concepts/overview/kubernetes-api/\">API ì„¤ëª…</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"problem\" style=\"position:relative;\"><a href=\"#problem\" aria-label=\"problem permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>problem</h2>\n<ul>\n<li>jenkinsì˜ build stepì—ì„œ kubernetesì˜ helmë“±ì„ ìˆ˜í–‰í–ˆì„ë•Œ, ì‚¬ìš©ìê°€ jenkins jobì„Â <code class=\"language-text\">cancel(abort)</code>Â í•œê²½ìš°, jenins jobì€ stopë˜ì§€ë§Œ,Â <code class=\"language-text\">helm runì€ cancelë˜ì§€ ì•ŠëŠ”</code>Â ë¬¸ì œê°€ ìˆìŒ</li>\n<li>ì›ì¸ì€ ìœ„ ê¸°ë³¸ ê°œë…ì—ì„œ ë§í–ˆë“¯, ì‹¤ì§ˆì ìœ¼ë¡œ kubectl commandê°€ api callì´ê¸°ë•Œë¬¸ì—, ëª…ë ¹ì–´ê°€ kubernetes clusterì— ë“¤ì–´ê°€ê³  ë‚˜ì„œ ì·¨ì†Œ ëª…ë ¹ì–´ê°€ ë“¤ì–´ì˜¤ê¸° ì „ê¹Œì§€ëŠ” ê³„ì† ìˆ˜í–‰ì´ ë˜ê³  ìˆê¸° ë•Œë¬¸ì„</li>\n</ul>\n<h2 id=\"solution\" style=\"position:relative;\"><a href=\"#solution\" aria-label=\"solution permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>solution</h2>\n<ul>\n<li>jenkinsì˜ cancelë™ì‘ì‹œ í•´ë‹¹ ë™ì‘ì„ ê°ì§€í•˜ê³ , any actionì„ í•  ìˆ˜ ìˆê²Œ í•˜ë©´ ë¨</li>\n</ul>\n<p><strong>Jenkins Abort Action</strong></p>\n<ul>\n<li>jenkinsì—ì„œ cancelì„ ëˆ„ë¥´ë©´,Â <code class=\"language-text\">TERM</code>Â ì‹œê·¸ë„ì„ í˜„ì¬ Jobì˜ process groupì— ë°œìƒì‹œí‚¨ë‹¤.</li>\n<li>ì´í›„ í•´ë‹¹ jobì—ì„œ ìˆ˜í–‰(spawns)í•œ subprocessëŠ” ëª¨ë‘Â <code class=\"language-text\">TERM</code>ì´ ë˜ê³ , â€œFinished: ABORTEDâ€ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ë©´ì„œ, jenkinsì˜ job ìˆ˜í–‰ì´ stopëœë‹¤.</li>\n</ul>\n<p><strong>TERM Signal Handle</strong></p>\n<ul>\n<li>singalì€ unixê³„ì—´ì˜ ìš´ì˜ì²´ì œì—ì„œ, IPCìš©ë„ í˜¹ì€, process controlì„ ìœ„í•´ ë§Œë“¤ì–´ì§„ asyncí•œ event(signal)ì´ë‹¤.</li>\n<li>unixê³„ì—´ì˜ ìš´ì˜ì²´ì œì—ì„œëŠ” ì´ëŸ¬í•œ signalì„ í•¸ë“¤ë§ í• ìˆ˜ ìˆëŠ”Â <code class=\"language-text\">C</code>í•¨ìˆ˜(System Call API) ë° CLI command(user command)ëª…ë ¹ì–´ì„ ì œê³µí•œë‹¤.</li>\n<li>signal í•¸ë“¤ë§ ëª…ë ¹ì–´ì¤‘Â <code class=\"language-text\">[trap](http://man7.org/linux/man-pages/man1/trap.1p.html)</code>ì€ ì‹œê·¸ë„ ë°œìƒì„ ê°ì§€í•˜ì—¬, commandì„ ì‹¤í–‰í•˜ëŠ”ê²Œ ê°€ëŠ¥í•œ ëª…ë ¹ì–´ ì´ë‹¤.</li>\n</ul>\n<p><strong>Jenkinsì—ì„œ Abortê°ì§€í•´ì„œ ì‚¬ìš©ìì •ì˜ ë™ì‘í•˜ê²Œ í•˜ê¸°</strong></p>\n<ul>\n<li>ìœ„ ë‚´ìš©ë“¤ì„ ì¡°í•©í•˜ì—¬ ì•„ë˜ì™€ ê°™ì€ ê°„ëµí•œ scriptì„ í†µí•´ì„œ, jenkinsì˜ abortì„ ê°ì§€í•˜ê³ , ê°ì§€ì´í›„ ì‚¬ìš©ìì •ì˜ ë™ì‘ì„ êµ¬í˜„ í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ì•„ë˜ì½”ë“œëŠ” jenkinsì˜ excutable scriptì˜ í•œ ì˜ˆì´ë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token comment\"># abort control #######################################################</span>\n<span class=\"token function-name function\">getAbort</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"--- Caution!! Abort detected ---\"</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> Launch The Post Script for Jenkins Aborted after 3sec\"</span>\n\n <span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">..</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span>\n <span class=\"token keyword\">do</span>\n   <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\".\"</span>\n   <span class=\"token function\">sleep</span> <span class=\"token number\">1</span>\n <span class=\"token keyword\">done</span>\n\n <span class=\"token assign-left variable\">PENDING_NAME</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span>kubectl get build <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> some-dev- <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Pending <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{print $1}'</span><span class=\"token variable\">`</span></span>\n <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">$PENDING_NAME</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"PENDING_NAME is Empty\"</span>\n <span class=\"token keyword\">else</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'Build: '</span><span class=\"token string\">\"<span class=\"token variable\">$PENDING_NAME</span>\"</span>' is Canceled<span class=\"token string\">'\n    kubectl pipeline cancel $PENDING_NAME\n fi\n}\ntrap '</span>getAbort<span class=\"token punctuation\">;</span> exit' SIGHUP SIGINT SIGTERM\n<span class=\"token comment\">######################################################################</span>\n\n\n<span class=\"token comment\"># check current cluster</span>\nkubectl get pods\n\n<span class=\"token comment\"># This Step is real Build &amp; Deploy</span>\n<span class=\"token comment\"># run pipeline</span>\n<span class=\"token comment\"># í•µì‹¬ì€ jenkinsë¡œ ì•„ë˜ì™€ ê°™ì´ kubernatesì˜ pipelineë¹Œë“œë¥¼ ëŒë¦¬ë‹¤ê°€.</span>\n<span class=\"token comment\"># kubernatesê°€ ì•„ë‹Œ jenkinsì—ì„œ stop(cancel)ì„ ì‹œì¼¯ì„ë•Œ</span>\n<span class=\"token comment\"># kubernatesë„ stopì‹œí‚¤ê¸°ì„, jenkinsì˜ stopë²„íŠ¼ì€ ìœ„ì˜ getAbortê°€ ê°ì§€í•˜ê³ </span>\n<span class=\"token comment\"># kubectl pipeliine cancelë¡œ stopì‹œí‚¨ë‹¤.</span>\n<span class=\"token comment\"># ë”°ë¼ì„œ jenkinsë„ stopë˜ê³ , ì‹¤ì œ kubernates pipeë„ stopëœë‹¤.</span>\nkubectl pipeline run --skip-approval --wait some-dev-project\n\n<span class=\"token comment\"># These Steps are checking the Build &amp; Deploy</span>\n<span class=\"token comment\"># check pipeline result</span>\nkubectl get instance\nkubectl get <span class=\"token function\">service</span>\nkubectl get pods\n\n<span class=\"token comment\"># ping test</span>\n<span class=\"token function\">curl</span> --insecure -v https://some-project/ping\n<span class=\"token comment\"># íŠ¹ì´í•˜ê²Œë„, jenkinsì˜ Execute shell stepì—ì„œ trap ëª…ë ¹ì–´ í•˜ìœ„ì—, ë˜ë‹¤ë¥¸ ëª…ë ¹ì–´ í•˜ë‚˜ê°€ ìˆì–´ì•¼ ì •ìƒ ë™ì‘í•˜ëŠ” ê²½ìš°ê°€ ìˆìŒ. ê°„ë‹¨íˆ printí•˜ëŠ”ê±¸ ë„£ì–´ì£¼ë©´ë¨.</span>\n</code></pre></div>\n<ul>\n<li>ìœ„ì™€ê°™ì€ ìƒí™©ì—ì„œ, Jenkins UIìƒì—ì„œ Cancelìˆ˜í–‰ì‹œ ì •ìƒì ìœ¼ë¡œ, abortì„ ê°ì§€í•˜ì—¬Â <code class=\"language-text\">getAbort</code>í•¨ìˆ˜ê°€ ìˆ˜í–‰ë˜ëŠ”ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<h2 id=\"refrence\" style=\"position:relative;\"><a href=\"#refrence\" aria-label=\"refrence permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>refrence</h2>\n<ul>\n<li>Jenkins:Â <a href=\"https://jenkins.io/doc/\">https://jenkins.io/doc/</a></li>\n<li>Kubernetes:Â <a href=\"https://kubernetes.io/ko/docs\">https://kubernetes.io/ko/docs</a></li>\n<li>Jenkins Abort\n<ul>\n<li>stackoverflow:Â <a href=\"https://stackoverflow.com/questions/32065516/detect-jenkins-build-abort-event\">https://stackoverflow.com/questions/32065516/detect-jenkins-build-abort-event</a></li>\n<li>when you cancel a jenkins job:Â <a href=\"https://gist.github.com/datagrok/dfe9604cb907523f4a2f\">https://gist.github.com/datagrok/dfe9604cb907523f4a2f</a></li>\n</ul>\n</li>\n<li>signal:Â <a href=\"https://en.wikipedia.org/wiki/Signal_(IPC)\">https://en.wikipedia.org/wiki/Signal_(IPC)</a></li>\n<li>signal api:Â <a href=\"http://man7.org/linux/man-pages/man2/signal.2.html\">http://man7.org/linux/man-pages/man2/signal.2.html</a></li>\n<li>signal man 2 and 7:Â <a href=\"https://stackoverflow.com/questions/25828288/what-is-the-difference-between-signal7-and-signal2\">https://stackoverflow.com/questions/25828288/what-is-the-difference-between-signal7-and-signal2</a></li>\n<li>linux trap:Â <a href=\"https://www.joinc.co.kr/w/Site/Tip/Signal_trap\">https://www.joinc.co.kr/w/Site/Tip/Signal_trap</a></li>\n<li>linux trap man:Â <a href=\"http://man7.org/linux/man-pages/man1/trap.1p.html\">http://man7.org/linux/man-pages/man1/trap.1p.html</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">ì†Œê°œ</a></li>\n<li><a href=\"#why-needed\">why needed?</a></li>\n<li><a href=\"#pre-required-knowledge\">pre required knowledge</a></li>\n<li><a href=\"#problem\">problem</a></li>\n<li><a href=\"#solution\">solution</a></li>\n<li><a href=\"#refrence\">refrence</a></li>\n</ul>\n</div>","excerpt":"ì†Œê°œ ì•½ê°„ ì‹œëŒ€ì— ë’¤ë–¨ì–´ì§€ëŠ” UI/UX & ì‚¬ìš©ë²•ìœ¼ë¡œ, ì‚¬ìš©ìë“¤ì´ ë§ì´ ì´íƒˆí•˜ì˜€ì§€ë§Œ, ì•„ì§ë„ Top20 ë“±ìœ¼ë¡œ CI/CD Toolê²€ìƒ‰ì‹œ í•­ìƒ í¬í•¨ë˜ëŠ” ì •í†µì˜ ê°•ìê°€ Jenkins ì´ë‹¤. ì—¬ê¸°ì„œëŠ”, Jenkinsì˜ Abort(Cancel) actionì— ëŒ€í•œ í›„ì²˜ë¦¬(post control or after control)ë¥¼ ë³„ë„ì˜ pluginì„¤ì¹˜ ì—†ì´ simpleí•˜ê²Œ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•˜ì—¬ ì„¤ëª…í•œë‹¤. why needed? í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ, ì„œë²„ë¡œ APIë¥¼ ì˜ëŠ” CLIì„ ì‚¬ìš©ì¤‘ì¸ë°, Jenkinsì—ì„œ Cancelí•˜ì—¬ë„, ì‹¤ì œ Build or Deployë™ì‘ì€ Cancelë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆìŒ. í•´ê²°ë°©ë²•ìœ¼ë¡œ, Jenkinsì—ì„œ Cancelí•˜ë©´, í•´ë‹¹ ë™ì‘ì„ ê°ì§€í•˜ì—¬ ì„œë²„ì— Cancel APIì„ í˜¸ì¶œí•˜ì—¬ ì‹¤ì œ Build or Deployë™ì‘ì„ Cancelì²˜ë¦¬ í•˜ê³ ì í•¨. pre required knowledge Jenkins ê´€ë ¨ Jenkins Basic open source:Â https:/â€¦","frontmatter":{"date":"October 21, 2019","title":"Jenkins Abort","categories":"tech-talk ci","author":"gseok","emoji":"ğŸ§¢"},"fields":{"slug":"/tech-talk-2019/2019-10-21-Jenkins-Abort/"}},"next":null,"prev":{"id":"224ce30f-59e2-5f46-b58e-e4dbb12189f2","html":"<h3 id=\"ì†Œê°œ\" style=\"position:relative;\"><a href=\"#%EC%86%8C%EA%B0%9C\" aria-label=\"ì†Œê°œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì†Œê°œ</h3>\n<ul>\n<li>svg, canvas, ì¼ë°˜ DOMì´ ì„ì—¬ ìˆëŠ” Web Pageì„ ë¸Œë¼ìš°ì €ì—ì„œ screenshotì„ ìƒì„±í•˜ê¸° ìœ„í•œ web tech tipì— ëŒ€í•´ì„œ ì´ì•¼ê¸° í•©ë‹ˆë‹¤.</li>\n</ul>\n<h3 id=\"webì—ì„œ-ìŠ¤í¬ë¦°ìƒ·-ìƒì„±í•˜ëŠ”-lib\" style=\"position:relative;\"><a href=\"#web%EC%97%90%EC%84%9C-%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7-%EC%83%9D%EC%84%B1%ED%95%98%EB%8A%94-lib\" aria-label=\"webì—ì„œ ìŠ¤í¬ë¦°ìƒ· ìƒì„±í•˜ëŠ” lib permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Webì—ì„œ ìŠ¤í¬ë¦°ìƒ· ìƒì„±í•˜ëŠ” Lib</h3>\n<ul>\n<li>html2canvas\n<ul>\n<li>doc: <a href=\"https://html2canvas.hertzen.com/\">https://html2canvas.hertzen.com/</a></li>\n<li>git: <a href=\"https://github.com/niklasvh/html2canvas/\">https://github.com/niklasvh/html2canvas/</a></li>\n</ul>\n</li>\n</ul>\n<p>webì—ì„œ screenshotì„ ìƒì„±í•˜ëŠ” ëŒ€í‘œì ì¸ libê°€ ì¡´ì¬í•©ë‹ˆë‹¤. í•´ë‹¹ libëŠ” screenshotì„ ìƒì„±í•˜ê¸° ìœ„í•œ íƒ€ê²Ÿ domì„ canvasì— drawí•˜ì—¬ì„œ screenshotì„ ìƒì„±í•©ë‹ˆë‹¤.</p>\n<p>ë³´í†µ ì¼ë°˜ì ì¸ web pageì˜ ê²½ìš° í° ë¬¸ì œ ì—†ì´ êµ¬ë™ë˜ì§€ë§Œ, ë³µì¡í•œ êµ¬ì¡°ì˜ pageì¸ ê²½ìš°, íŠ¹íˆ IEì—ì„œ ì•„ë˜ì™€ ê°™ì€ ë¬¸ì œê°€ ë°œìƒ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><strong>html2canvasì˜ ë¬¸ì œ</strong></p>\n<ul>\n<li>svg: svg â†’ canvasë¡œ drawí• ë•Œ, SecurityErrorê°€ ë°œìƒí•˜ì—¬, svgê°€ ê·¸ë ¤ì§€ì§€ ì•ŠìŒ\n<ul>\n<li>ref: <a href=\"https://html.spec.whatwg.org/multipage/canvas.html#security-with-canvas-elements\">https://html.spec.whatwg.org/multipage/canvas.html#security-with-canvas-elements</a></li>\n<li>ref: <a href=\"https://github.com/eligrey/canvas-toBlob.js/issues/21\">https://github.com/eligrey/canvas-toBlob.js/issues/21</a></li>\n<li>ref: <a href=\"https://github.com/niklasvh/html2canvas/issues/201\">https://github.com/niklasvh/html2canvas/issues/201</a></li>\n<li><a href=\"https://github.com/niklasvh/html2canvas/issues/1543\">https://github.com/niklasvh/html2canvas/issues/1543</a></li>\n</ul>\n</li>\n<li>image: image â†’ canvasì‹œ canvasì˜ tainted errorê°€ ë°œìƒ\n<ul>\n<li>ref: <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image\">https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image</a></li>\n</ul>\n</li>\n</ul>\n<p>html2canvas libì„ IEì—ì„œ ì‚¬ìš©ì‹œ íŠ¹íˆë‚˜ ìœ„ ë¬¸ì œê°€ ë§ì´ ë°œìƒí•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” svgíƒœê·¸ë¥¼ ëª¨ë‘ parsingí•˜ê³  ë¶„ì„í•´ì„œ svg â†’ canvasë¡œ ì§ì ‘ drawí•˜ëŠ” í˜•íƒœê°€ ì•„ë‹ˆë¼. imageì„ ì‚¬ìš©í•˜ëŠ” trickì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<ul>\n<li>\n<p>httml2canvasì—ì„œ svgì˜ ì²˜ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>\n<ul>\n<li>svg â†’ stringìœ¼ë¡œ ë³€í™˜(serializeToString)</li>\n<li>svg text(string) ì„ new image í•˜ê³ </li>\n<li>image srcì— â€˜data:image/svg+xmlâ€™í˜•íƒœë¡œ ì„¤ì •</li>\n<li>ì´í›„ í•´ë‹¹ imageì„ canvasì— drawImageí•¨</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SVGElementContainer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ElementContainer</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">svg</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">intrinsicWidth</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">intrinsicHeight</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">img</span><span class=\"token operator\">:</span> SVGSVGElement</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> s <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLSerializer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>svg <span class=\"token operator\">=</span>\n\t\t\t<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">data:image/svg+xml,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span><span class=\"token function\">serializeToString</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>intrinsicWidth <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">.</span>baseVal<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>intrinsicHeight <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">.</span>baseVal<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n\n    CacheStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addImage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>svg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>ìœ„ ê³¼ì •ì´í›„ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤. ìœ„ image â†’ canvasì‹œ tainted errorê°€ ë°œìƒ</p>\n</li>\n</ul>\n<p>ê²°êµ­ html2canvas libì—ì„œì˜ svgì²˜ë¦¬ ë¬¸ì œë¡œ, svgê°€ ì˜ ê·¸ë ¤ì§€ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ê³ , ê·¼ë³¸ì ìœ¼ë¡œëŠ” webìƒì—ì„œ canvasê°€ tained ë˜ì—ˆì„ë•Œ, ì´ë¥¼ ì™¸ë¶€ì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ í˜•íƒœë¡œì˜ ë³€í™˜ ì‹œë„ì‹œ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<p>Imageì„ canvasì— ê·¸ë ¸ì„ë•Œ tained ë¬¸ì œ</p>\n<ul>\n<li>crossOrigin = â€œAnonymousâ€; ì„¤ì •ì´ Img ê°€ onLoadë˜ê¸° ì´ì „ì— ì„¤ì • ë˜ì–´ ìˆì–´ì•¼ í•´ë‹¹ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>\n<li>ì´ë¯¸ dom ìƒì— imgê°€ ìˆëŠ”ë° í•´ë‹¹ imgì— ìœ„ attributeê°€ ì—†ëŠ” ê²½ìš°, imgì„ xhrë¡œ loadí•˜ê³ , loadí•œ dataì„ ì½ì–´ì„œ crossOrigin = â€œAnonymousâ€ ê°€ ë¯¸ë¦¬ ì„¤ì •ëœ imgì„ ë§Œë“¤ì–´ í•´ë‹¹ imgì— ë‹¤ì‹œ ì´ë¯¸ì§€ë¥¼ ê·¸ë¦¬ëŠ” í˜•íƒœë¡œ íšŒí”¼ë¥¼ í•©ë‹ˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// proxy ì½”ë“œ ìŠ¤ë‹™</span>\n<span class=\"token keyword\">private</span> <span class=\"token function\">proxy</span><span class=\"token punctuation\">(</span>src<span class=\"token operator\">:</span> string<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> proxy <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_options<span class=\"token punctuation\">.</span>proxy<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>proxy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'No proxy defined'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> key <span class=\"token operator\">=</span> src<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> responseType <span class=\"token operator\">=</span> <span class=\"token constant\">FEATURES</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SUPPORT_RESPONSE_TYPE</span> <span class=\"token operator\">?</span> <span class=\"token string\">'blob'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'text'</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> xhr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      xhr<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>responseType <span class=\"token operator\">===</span> <span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                  reader<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'load'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>result <span class=\"token keyword\">as</span> string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                  reader<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                  reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsDataURL</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Failed to proxy resource </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>key<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> with status code </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xhr<span class=\"token punctuation\">.</span>status<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\t\t\txhr<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>proxy<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?url=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;responseType=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>responseType<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// proxy ê°€ í•„ìš”í•œ ê²½ìš° ==> CORSì„ ì¬ì„¤ì • í•˜ëŠ” ê²½ìš°</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>useProxy<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tsrc <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">proxy</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nLogger<span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Added image </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> img <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Image</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    img<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    img<span class=\"token punctuation\">.</span>onerror <span class=\"token operator\">=</span> reject<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//ios safari 10.3 taints canvas with data urls unless crossOrigin is set to anonymous</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isInlineBase64Image</span><span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> useCORS<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        img<span class=\"token punctuation\">.</span>crossOrigin <span class=\"token operator\">=</span> <span class=\"token string\">'anonymous'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    img<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> src<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>complete <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Inline XML images may fail to parse, throwing an Error later on</span>\n        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_options<span class=\"token punctuation\">.</span>imageTimeout <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Timed out (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_options<span class=\"token punctuation\">.</span>imageTimeout<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">ms) loading image</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_options<span class=\"token punctuation\">.</span>imageTimeout\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>canvas tained?</strong></p>\n<ul>\n<li>canvasì— imgë‚˜ svgì„ drawí• ë•Œ, í•´ë‹¹ svg or img(ì›ë³¸)ì— CORS ì„¤ì •(attribute)ì„ ë³´ê³  í•´ë‹¹ ì„¤ì •ì´ ì—†ëŠ” ì›ë³¸ì„ drawí•œ canvasëŠ” tainedëœ(ë”ëŸ½í˜€ì¡Œì–´â€¦) canvasë¡œ browserì—ì„œ íŒë‹¨ë©ë‹ˆë‹¤.</li>\n<li>tainedëœ canvasì•„ë˜ ë™ì‘ ì‹œë„ì‹œ Security Errorê°€ ë°œìƒí•©ë‹ˆë‹¤.\n<ul>\n<li>CallingÂ <code class=\"language-text\">[getImageData()](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData)</code>Â on the canvasâ€™s context</li>\n<li>CallingÂ <code class=\"language-text\">[toBlob()](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob)</code>Â on theÂ <code class=\"language-text\">[&lt;canvas>](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas)</code>Â element itself</li>\n<li>CallingÂ <code class=\"language-text\">[toDataURL()](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL)</code>Â on the canvas</li>\n</ul>\n</li>\n<li>ê·¸ ì´ì™¸ì˜ ë™ì‘ì€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n<ul>\n<li>ë”°ë¼ì„œ, ì›ë³¸ ì†ŒìŠ¤ì—ì„œ í—ˆë½í•˜ì§€ ì•Šì€ ê²½ìš°, low dataë³€í™˜ì´ë‚˜ ì™¸ë¶€ ë°˜ì¶œì— ì œì•½ì´ ë°œìƒí•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"security--tained-error-íšŒí”¼í•˜ê¸°\" style=\"position:relative;\"><a href=\"#security--tained-error-%ED%9A%8C%ED%94%BC%ED%95%98%EA%B8%B0\" aria-label=\"security  tained error íšŒí”¼í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>security &#x26; tained error íšŒí”¼í•˜ê¸°</h3>\n<p><strong>canvg</strong></p>\n<p>canvgëŠ” svgì„ canvasë¡œ ë³€ê²½í•´ì£¼ëŠ” ëŒ€í‘œì ì¸ lib ì…ë‹ˆë‹¤. html2canvasì™€ ë‹¤ë¥´ê²Œ canvgëŠ” svgì˜ ë‚´ìš©ì„ ì§ì ‘ parsingí•˜ê³  í•´ì„í•˜ì—¬, í•´ë‹¹ ê·¸ë¦¼ì„ canvasì— ê·¸ë ¤ì¤ë‹ˆë‹¤.</p>\n<ul>\n<li>git: <a href=\"https://github.com/canvg/canvg\">https://github.com/canvg/canvg</a></li>\n</ul>\n<p>canvgê°€ ìƒì„±í•˜ëŠ” canvasì— ê·¸ë ¤ì§„ svgëŠ” ì‹¤ì§ˆì ìœ¼ë¡œëŠ” canvasì— ë©”ë‰´ì–¼í•˜ê²Œ ê·¸ë¦° pureí•œ canvasì´ê¸° ë•Œë¬¸ì— securityë‚˜ tained errorê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>\n<p><strong>html2canvas + canvg ì¡°í•©í•˜ì—¬ íšŒí”¼í•˜ê¸°</strong></p>\n<p>html2canvasì—ì„œëŠ”, ëª©ì í•˜ëŠ” domì„ cloneí•˜ì—¬ ì´ìš©í•˜ê³ , í•´ë‹¹ cloned domì€ canvasë¡œ ê·¸ë ¤ì§€ê¸° ì „ì— ìˆ˜ë™ìœ¼ë¡œ ì´ë¯¸ì§€, ìŠ¤íƒ€ì¼ ë“±ì„ ì¡°ì • í•  ìˆ˜ ìˆëŠ” callback apiì„ ì œê³µí•©ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ, html2canvasì— svgë¶€ë¶„ë§Œ canvgë¡œ ê·¸ë ¤ì„œ ëŒ€ì²´í•˜ë©´, ì‹¤ì§ˆì ìœ¼ë¡œ html2canvasì„ ì´ìš©í•´ì„œ ì´ë¯¸ì§€ë¥¼ ìƒì„± í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"glsl\"><pre class=\"language-glsl\"><code class=\"language-glsl\"><span class=\"token comment\">// pseudo code</span>\n<span class=\"token function\">html2canvas</span><span class=\"token punctuation\">(</span>targetElement<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n\tonclone<span class=\"token operator\">:</span> clonedDoc <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n\t  <span class=\"token comment\">// svg to canvas</span>\n\t\t<span class=\"token keyword\">const</span> svg <span class=\"token operator\">=</span> clonedDoc<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token char\">'svg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>svg<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> Canvg<span class=\"token punctuation\">.</span><span class=\"token function\">fromString</span><span class=\"token punctuation\">(</span>svg<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">const</span> parent <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span>parentElement<span class=\"token punctuation\">;</span>\n\t\t\tsvg<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"dom-to-canvas\" style=\"position:relative;\"><a href=\"#dom-to-canvas\" aria-label=\"dom to canvas permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DOM to Canvas</h3>\n<p>dom objectì„ canvasì— ê·¸ë¦¬ëŠ” ê°€ì¥ ì¼ë°˜ ì ì¸ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.</p>\n<p>ì°¸ê³ : <a href=\"http://man.hubwiz.com/docset/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Drawing_DOM_objects_into_a_canvas.html\">http://man.hubwiz.com/docset/JavaScript.docset/Contents/Resources/Documents/developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Drawing_DOM_objects_into_a_canvas.html</a></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token constant\">DOMURL</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span> <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitURL <span class=\"token operator\">||</span> window<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncanvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span>\ncanvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span>\n\t\t <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"200\">\n        &lt;foreignObject width=\"100%\" height=\"100%\">\n          &lt;div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"font-size:40px\">\n            &lt;em>I&lt;/em> like\n            &lt;span style=\"color:white; text-shadow:0 0 2px blue;\">\n            cheese&lt;/span>\n          &lt;/div>\n        &lt;/foreignObject>\n      &lt;/svg></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> svg <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Blob</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'image/svg+xml;charset=utf-8'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token constant\">DOMURL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>svg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> img <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Image</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nimg<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token constant\">DOMURL</span><span class=\"token punctuation\">.</span><span class=\"token function\">revokeObjectURL</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nimg<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>svgì˜ foreignObjectì„ ì´ìš©í•˜ì—¬ ë‚´ë¶€ì— domì„ ê·¸ë¦¬ê³ , svg â†’ image â†’ canvasì— ê·¸ë¦¬ëŠ” í˜•íƒœì…ë‹ˆë‹¤.</li>\n<li>ë‹¨ IEì—ì„œëŠ” ì§€ì›í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. ref: <a href=\"https://caniuse.com/#search=foreignobject\">https://caniuse.com/#search=foreignobject</a></li>\n<li>html2canvasì˜ ê²½ìš°, foreignObjectì„ ì§€ì›í•˜ëŠ” ê²½ìš° ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ canvasì— ê·¸ë¦¬ê³ , ë§Œì•½ foreignObjectì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš°, dom treeì„ ëª¨ë‘ parsingí•˜ë©´ì„œ ê°ê°ì˜ element typeì— ë”°ë¼ì„œ, size(bound), style, textë“±ì„ ê³„ì‚°í•˜ì—¬ ì§ì ‘ canvasì— ê·¸ë¦¼ì„ ê·¸ë¦½ë‹ˆë‹¤. ref: <a href=\"https://github.com/niklasvh/html2canvas/blob/master/src/render/canvas/canvas-renderer.ts\">https://github.com/niklasvh/html2canvas/blob/master/src/render/canvas/canvas-renderer.ts</a></li>\n</ul>\n<h3 id=\"ì •ë¦¬\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"ì •ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì •ë¦¬</h3>\n<ul>\n<li>DOM â†’ Image(Canvas)ëŠ” foreignObjectì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ìƒê°ë³´ë‹¤ ì–´ë µì§€ ì•Šê²Œ ë³€í™˜ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>\n<li>DOMì— SVGë‚˜ Imageê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° Security ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n<ul>\n<li>Image: attributeì— crossOrigin = â€œAnonymousâ€; ì„¤ì •ìœ¼ë¡œ íšŒí”¼ ê°€ëŠ¥ í•©ë‹ˆë‹¤.</li>\n<li>svg: canvgë“±ìœ¼ë¡œ svg â†’ canvasë¡œ ì§ì ‘ ê·¸ë¦¬ëŠ” í˜•íƒœë¡œ íšŒí”¼ ê°€ëŠ¥ í•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li>ëŒ€ë‹¤ìˆ˜ì˜ ê°„ëµí•œ DOM Treeì˜ ê²½ìš° ë¬¸ì œì—†ì´ ê¸°ë³¸ì ì¸ libì‚¬ìš©ìœ¼ë¡œ ì´ë¯¸ì§€ ìƒì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>\n<li>ë§Œì•½ SVGë‚˜ Imageì— ì˜í•´ ë¬¸ì œê°€ ë°œìƒí•  ê²½ìš° ìœ„ì™€ ê°™ì€ íšŒí”¼ ë°©ë²•ì„ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ ìƒì„±ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n</ul>\n<h3 id=\"ì¶”ê°€ì‚¬í•­\" style=\"position:relative;\"><a href=\"#%EC%B6%94%EA%B0%80%EC%82%AC%ED%95%AD\" aria-label=\"ì¶”ê°€ì‚¬í•­ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì¶”ê°€ì‚¬í•­</h3>\n<ul>\n<li>html2canvasì˜ ê²½ìš°, ë‚´ë¶€ì ìœ¼ë¡œ targetì´ ë˜ëŠ” dom treeë§Œ cloneí•˜ëŠ”ê²Œ ì•„ë‹ˆë¼. full window(document)ì„ ëª¨ë‘ cloneí•˜ì—¬ ë™ì‘í•©ë‹ˆë‹¤. ë”°ë¼ì„œ documentì˜ í¬ê¸°ì— ë”°ë¼ì„œ, documentì˜ dom treeê°€ ë§¤ìš° ë³µì¡í•˜ê³  ë§ì€ ê²½ìš°, 500ms ì´ìƒ ëŠë¦¬ê²Œ ë™ì‘ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n<li>ì´ë¯¸ì§€ ìƒì„±ì„ í•´ì•¼í•˜ëŠ” ë¶€ë¶„ì— DOMë³´ë‹¤ëŠ” SVGë‚˜ Imageë¡œë§Œ ë˜ì–´ ìˆë‹¤ë©´, ì§ì ‘ SVG, Imageë¥¼ Canvasì— ê·¸ë ¤ì„œ ì´ë¯¸ì§€ë¡œ ìƒì„±í•˜ëŠ”ê²Œ ì„±ëŠ¥ìƒ ì´ì ì´ í½ë‹ˆë‹¤.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%86%8C%EA%B0%9C\">ì†Œê°œ</a></li>\n<li><a href=\"#web%EC%97%90%EC%84%9C-%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7-%EC%83%9D%EC%84%B1%ED%95%98%EB%8A%94-lib\">Webì—ì„œ ìŠ¤í¬ë¦°ìƒ· ìƒì„±í•˜ëŠ” Lib</a></li>\n<li><a href=\"#security--tained-error-%ED%9A%8C%ED%94%BC%ED%95%98%EA%B8%B0\">security &#x26; tained error íšŒí”¼í•˜ê¸°</a></li>\n<li><a href=\"#dom-to-canvas\">DOM to Canvas</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">ì •ë¦¬</a></li>\n<li><a href=\"#%EC%B6%94%EA%B0%80%EC%82%AC%ED%95%AD\">ì¶”ê°€ì‚¬í•­</a></li>\n</ul>\n</div>","frontmatter":{"date":"January 10, 2020","title":"DOM ìŠ¤ìƒ·ì°ê¸°(Svg & Canvas & DOM)","categories":"tech-talk","author":"gseok","emoji":null},"fields":{"slug":"/tech-talk-2020/2020-01-10-DOM-screenshot/"}},"site":{"siteMetadata":{"siteUrl":"https://gseok.github.io","comments":{"utterances":{"repo":"gseok/gseok.github.com"}}}}},"pageContext":{"slug":"/tech-talk-2019/2019-10-21-Jenkins-Abort/","nextSlug":"","prevSlug":"/tech-talk-2020/2020-01-10-DOM-screenshot/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}